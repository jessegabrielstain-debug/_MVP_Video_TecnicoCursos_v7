(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6102],{26263:function(e,t,s){Promise.resolve().then(s.bind(s,20200))},62060:function(e,t,s){"use strict";s.d(t,{Cd:function(){return c},X:function(){return d},bZ:function(){return o}});var a=s(57437),l=s(2265),r=s(90535),i=s(22835);let n=(0,r.j)("relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=l.forwardRef((e,t)=>{let{className:s,variant:l,...r}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:l}),s),...r})});o.displayName="Alert";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...l})});c.displayName="AlertTitle";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...l})});d.displayName="AlertDescription"},41875:function(e,t,s){"use strict";s.d(t,{C:function(){return n}});var a=s(57437);s(2265);var l=s(90535),r=s(22835);let i=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:s,...l}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:s}),t),...l})}},92595:function(e,t,s){"use strict";s.d(t,{d:function(){return n},z:function(){return o}});var a=s(57437),l=s(2265),r=s(90535),i=s(22835);let n=(0,r.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=l.forwardRef((e,t)=>{let{className:s,variant:l,size:r,asChild:o=!1,...c}=e;return(0,a.jsx)(o?"span":"button",{className:(0,i.cn)(n({variant:l,size:r,className:s})),ref:t,...c})});o.displayName="Button"},34029:function(e,t,s){"use strict";s.d(t,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return m},ll:function(){return o}});var a=s(57437),l=s(2265),r=s(22835);let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...l})});i.displayName="Card";let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...l})});n.displayName="CardHeader";let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("font-semibold leading-none tracking-tight",s),...l})});o.displayName="CardTitle";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...l})});c.displayName="CardDescription";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...l})});d.displayName="CardContent";let m=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...l})});m.displayName="CardFooter"},81973:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var a=s(57437),l=s(2265),r=s(22835);let i=l.forwardRef((e,t)=>{let{className:s,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},41236:function(e,t,s){"use strict";s.d(t,{E:function(){return i}});var a=s(57437),l=s(2265),r=s(22835);let i=l.forwardRef((e,t)=>{let{className:s,value:l,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...i,children:(0,a.jsx)("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});i.displayName="Progress"},6403:function(e,t,s){"use strict";s.d(t,{B:function(){return o},x:function(){return n}});var a=s(57437),l=s(2265),r=s(43643),i=s(22835);let n=l.forwardRef((e,t)=>{let{className:s,children:l,...n}=e;return(0,a.jsxs)(r.fC,{ref:t,className:(0,i.cn)("relative overflow-hidden",s),...n,children:[(0,a.jsx)(r.l_,{className:"h-full w-full rounded-[inherit]",children:l}),(0,a.jsx)(o,{}),(0,a.jsx)(r.Ns,{})]})});n.displayName=r.fC.displayName;let o=l.forwardRef((e,t)=>{let{className:s,orientation:l="vertical",...n}=e;return(0,a.jsx)(r.gb,{ref:t,orientation:l,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 border-t border-t-transparent p-[1px]",s),...n,children:(0,a.jsx)(r.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=r.gb.displayName},60967:function(e,t,s){"use strict";s.d(t,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return u},i4:function(){return m},ki:function(){return d}});var a=s(57437),l=s(2265),r=s(56873),i=s(40875),n=s(30401),o=s(22835);let c=r.fC;r.ZA;let d=r.B4,m=l.forwardRef((e,t)=>{let{className:s,children:l,...n}=e;return(0,a.jsxs)(r.xz,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...n,children:[l,(0,a.jsx)(r.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.xz.displayName;let x=l.forwardRef((e,t)=>{let{className:s,children:l,position:i="popper",...n}=e;return(0,a.jsx)(r.h_,{children:(0,a.jsx)(r.VY,{ref:t,className:(0,o.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...n,children:(0,a.jsx)(r.l_,{className:(0,o.cn)("popper"===i&&"p-1",s),children:l})})})});x.displayName=r.VY.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...l})}).displayName=r.__.displayName;let u=l.forwardRef((e,t)=>{let{className:s,children:l,...i}=e;return(0,a.jsxs)(r.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.wU,{children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(r.eT,{children:l})]})});u.displayName=r.ck.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...l})}).displayName=r.Z0.displayName},72927:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(57437),l=s(2265),r=s(55156),i=s(22835);let n=l.forwardRef((e,t)=>{let{className:s,orientation:l="horizontal",decorative:n=!0,...o}=e;return(0,a.jsx)(r.f,{ref:t,decorative:n,orientation:l,className:(0,i.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",s),...o})});n.displayName=r.f.displayName},51098:function(e,t,s){"use strict";s.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return n},nU:function(){return d}});var a=s(57437),l=s(2265),r=s(20271),i=s(22835);let n=r.fC,o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...l})});o.displayName=r.aV.displayName;let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...l})});c.displayName=r.xz.displayName;let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...l})});d.displayName=r.VY.displayName},49665:function(e,t,s){"use strict";s.d(t,{g:function(){return i}});var a=s(57437),l=s(2265),r=s(22835);let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...l})});i.displayName="Textarea"},20200:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ep}});var a=s(57437),l=s(2265),r=s(34029),i=s(92595),n=s(41236),o=s(41875),c=s(62060),d=s(69064),m=s(41671),x=s(76865),u=s(75277),h=s(53113),f=s(29374),p=s(28124),g=s(2207),v=s(17689),b=s(64972),j=s(92735),y=s(48736),N=s(32489),w=s(85598);function k(e){let{onAnalysisComplete:t,onCancel:s}=e,[k,z]=(0,l.useState)(null),[C,S]=(0,l.useState)(!1),[E,Z]=(0,l.useState)(!1),[T,P]=(0,l.useState)(0),[M,I]=(0,l.useState)(0),[A,D]=(0,l.useState)(""),[R,X]=(0,l.useState)(null),B=async e=>{let t=new FormData;t.append("file",e),t.append("type","pptx_v2");let s=await fetch("/api/v1/pptx/upload",{method:"POST",body:t});if(!s.ok){let e=await s.text();throw Error("Erro no upload: ".concat(e))}return(await s.json()).s3Key},Y=async(e,t)=>{let s=[{stage:"Baixando do S3...",progress:10},{stage:"Extraindo estrutura PPTX...",progress:25},{stage:"Analisando slides individuais...",progress:45},{stage:"Extraindo elementos edit\xe1veis...",progress:65},{stage:"Processando assets (imagens/v\xeddeos)...",progress:80},{stage:"Gerando timeline e keyframes...",progress:90},{stage:"Finalizando an\xe1lise...",progress:100}],a=(async()=>{for(let{stage:e,progress:t}of s)D(e),I(t),await new Promise(e=>setTimeout(e,500))})();try{let s=await fetch("/api/v1/pptx/enhanced-process-v2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({s3Key:e,filename:t,options:{generateThumbnails:!0,analyzeCompliance:!0,extractAnimations:!0,parseElements:!0}})});if(!s.ok){let e=await s.json();throw Error(e.error||"HTTP ".concat(s.status))}let l=await s.json();if(!l.success)throw Error(l.error||"Falha na an\xe1lise");return await a,console.log("✅ An\xe1lise v2 conclu\xedda:",{slides:l.data.slides.length,totalElements:l.statistics.totalElements,editableElements:l.statistics.editableElements,elementsByType:l.statistics.elementsByType}),0===l.statistics.editableElements&&(console.warn("⚠️ Nenhum elemento edit\xe1vel extra\xeddo!"),d.Am.error("Nenhum elemento edit\xe1vel foi encontrado no PPTX")),l.data}catch(e){throw await a.catch(()=>{}),e}},_=async e=>{if(X(null),!e.name.toLowerCase().endsWith(".pptx")){X("Apenas arquivos .pptx s\xe3o aceitos");return}if(e.size>104857600){X("Arquivo muito grande (m\xe1x. 100MB)");return}z({file:e});try{S(!0),P(0);let s=setInterval(()=>{P(e=>Math.min(e+10,90))},200),a=await B(e);clearInterval(s),P(100),S(!1),d.Am.success("Upload conclu\xeddo!"),Z(!0),I(0),D("Iniciando an\xe1lise...");let l=await Y(a,e.name);if(z(e=>e?{...e,s3Key:a,analysis:l}:null),Z(!1),d.Am.success("An\xe1lise conclu\xedda!"),!l.slides||0===l.slides.length)throw Error("Nenhum slide foi extra\xeddo do PPTX");let r=l.slides.reduce((e,t)=>e+t.elements.length,0);if(0===r)throw Error("Nenhum elemento foi extra\xeddo do PPTX");let i={name:e.name,size:e.size,type:e.type,lastModified:e.lastModified,s3Key:a};t({...l,fileInfo:i})}catch(e){console.error("Erro no processamento:",e),X(e instanceof Error?e.message:"Erro desconhecido"),S(!1),Z(!1),z(null)}},V=(0,l.useCallback)(e=>{e.length>0&&_(e[0])},[]),{getRootProps:F,getInputProps:O,isDragActive:U}=(0,w.uI)({onDrop:V,accept:{"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"]},multiple:!1,disabled:C||E});return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Upload e An\xe1lise PPTX v2.0"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Parser real que extrai elementos edit\xe1veis individuais (textos, formas, imagens)"})]}),(0,a.jsx)(r.Zb,{className:"mb-6","data-testid":"pptx-uploader",children:(0,a.jsx)(r.aY,{className:"p-6",children:(0,a.jsxs)("div",{...F(),className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer ".concat(U?"border-blue-400 bg-blue-50":C||E?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"),children:[(0,a.jsx)("input",{...O()}),C?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(v.Z,{className:"w-16 h-16 mx-auto text-blue-600 animate-bounce"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"Fazendo upload..."}),(0,a.jsx)(n.E,{value:T,className:"w-full max-w-md mx-auto mt-2"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[T,"%"]})]})]}):E?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(b.Z,{className:"w-16 h-16 mx-auto text-purple-600 animate-pulse"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"Extraindo elementos edit\xe1veis..."}),(0,a.jsx)(n.E,{value:M,className:"w-full max-w-md mx-auto mt-2"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:A})]})]}):U?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(j.Z,{className:"w-16 h-16 mx-auto text-blue-600"}),(0,a.jsx)("p",{className:"text-lg font-medium text-blue-600",children:"Solte o arquivo aqui"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(y.Z,{className:"w-16 h-16 mx-auto text-gray-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"Arraste um arquivo PPTX ou clique para selecionar"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Parser v2.0 - Extrai elementos edit\xe1veis individuais"})]}),(0,a.jsxs)(i.z,{className:"mt-4",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Selecionar Arquivo"]})]})]})})}),R&&(0,a.jsxs)(c.bZ,{className:"mb-6 border-red-200 bg-red-50",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-red-600"}),(0,a.jsx)(c.X,{className:"text-red-800",children:R})]}),(()=>{if(!(null==k?void 0:k.analysis))return null;let{slides:e,assets:s,statistics:l}=k.analysis;return(0,a.jsxs)(r.Zb,{className:"mt-4","data-testid":"analysis-complete",children:[(0,a.jsx)(r.Ol,{children:(0,a.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-green-500"}),"An\xe1lise Conclu\xedda (Parser v2.0)"]})}),(0,a.jsxs)(r.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4","data-testid":"processing-stats",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600","data-stat":"slides",children:e.length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Slides"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600","data-stat":"elements",children:l.totalElements}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Elementos"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600","data-stat":"editable-elements",children:l.editableElements}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Edit\xe1veis"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:s.images.length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Imagens"})]})]}),l.editableElements>0?(0,a.jsxs)(c.bZ,{className:"border-green-200 bg-green-50",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)(c.X,{className:"text-green-800",children:["✅ ",l.editableElements," elementos edit\xe1veis extra\xeddos com sucesso! O editor poder\xe1 manipular textos, formas e outros objetos individualmente."]})]}):(0,a.jsxs)(c.bZ,{className:"border-yellow-200 bg-yellow-50",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 text-yellow-600"}),(0,a.jsx)(c.X,{className:"text-yellow-800",children:"⚠️ Nenhum elemento edit\xe1vel foi encontrado. O PPTX pode conter apenas imagens ou elementos n\xe3o suportados."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Elementos Extra\xeddos:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(l.elementsByType).map(e=>{let[t,s]=e;return(0,a.jsxs)(o.C,{variant:"secondary",className:"text-xs",children:["text"===t&&(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1"}),"image"===t&&(0,a.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"video"===t&&(0,a.jsx)(f.Z,{className:"w-3 h-3 mr-1"}),"shape"===t&&(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),s," ",t]},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Preview dos Slides:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-60 overflow-y-auto",children:e.slice(0,6).map((e,t)=>(0,a.jsxs)("div",{className:"aspect-video bg-gray-100 rounded-lg p-2 border text-center flex flex-col justify-center",children:[(0,a.jsxs)("div",{className:"text-xs font-bold text-gray-700 mb-1",children:["Slide ",e.index]}),(0,a.jsx)("div",{className:"text-xs text-gray-600 truncate",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[e.elements.length," elementos"]}),(0,a.jsxs)("div",{className:"text-xs text-blue-600",children:[e.elements.filter(e=>"image"!==e.type).length," edit\xe1veis"]})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsxs)(i.z,{className:"flex-1",onClick:()=>k.analysis&&t({...k.analysis,fileInfo:{name:k.file.name,size:k.file.size,s3Key:k.s3Key}}),"data-testid":"open-editor-btn",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"Abrir no Editor"]}),(0,a.jsxs)(i.z,{variant:"outline",onClick:()=>{z(null),X(null)},children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Novo Upload"]})]})]})]})})(),(0,a.jsx)("div",{className:"flex justify-center mt-6",children:(0,a.jsxs)(i.z,{variant:"outline",onClick:s,children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Cancelar"]})})]})}var z=s(51098),C=s(6403),S=s(72927),E=s(75965),Z=s(44353),T=s(37533),P=s(61094),M=s(45274),I=s(89227),A=s(33276),D=s(51548),R=s(83229),X=s(41473),B=s(45802),Y=s(43391),_=s(81973),V=s(66337),F=s(87769),O=s(78867),U=s(18930),K=s(69076),G=s(41414),q=s(33145);let W=(0,l.forwardRef)((e,t)=>{var s,r,n;let{slide:c,selectedElements:d,editorState:m,onElementSelect:x,onElementUpdate:f,onElementDelete:p,onElementAdd:g,onEventEmit:v}=e,b=(0,l.useRef)(null),[j,y]=(0,l.useState)({isDragging:!1,elementId:"",startMousePos:{x:0,y:0},startElementPos:{x:0,y:0},dragType:"move"}),[N,w]=(0,l.useState)({startX:0,startY:0,endX:0,endY:0,active:!1}),[k,z]=(0,l.useState)(null),[C,S]=(0,l.useState)(null);(0,l.useImperativeHandle)(t,()=>({addElement:e=>B(e),deleteSelectedElements:()=>Y(),copySelectedElements:()=>W(),pasteElements:()=>Q(),selectAll:()=>H(),clearSelection:()=>x([])}));let E=(null==c?void 0:c.elements.filter(e=>!1!==e.visible))||[],Z=[...E].sort((e,t)=>(e.zIndex||0)-(t.zIndex||0)),T=m.canvas||{showGrid:!1,gridSize:20,width:1920,height:1080,zoom:100,snapToGrid:!0,snapDistance:5,showRulers:!1},M=(0,l.useCallback)(e=>{if(!b.current)return;let t=b.current.getBoundingClientRect(),s=(e.clientX-t.left)/(T.zoom/100),a=(e.clientY-t.top)/(T.zoom/100),l=R(s,a);if(l){let t=d.includes(l.id);e.shiftKey||e.metaKey?t?x(d.filter(e=>e!==l.id)):x([...d,l.id]):t||x([l.id]),(t||!e.shiftKey)&&y({isDragging:!0,elementId:l.id,startMousePos:{x:e.clientX,y:e.clientY},startElementPos:{x:l.x,y:l.y},dragType:"move"})}else e.shiftKey||e.metaKey||x([]),w({startX:s,startY:a,endX:s,endY:a,active:!0});S(null)},[d,x,null===(s=m.canvas)||void 0===s?void 0:s.zoom]),I=(0,l.useCallback)(e=>{if(b.current){if(j.isDragging&&j.elementId){let t=(e.clientX-j.startMousePos.x)/(T.zoom/100),s=(e.clientY-j.startMousePos.y)/(T.zoom/100),a=j.startElementPos.x+t,l=j.startElementPos.y+s,r=a,i=l;T.snapToGrid&&(r=Math.round(a/T.gridSize)*T.gridSize,i=Math.round(l/T.gridSize)*T.gridSize),f(j.elementId,{x:r,y:i}),d.length>1&&d.includes(j.elementId)&&d.forEach(e=>{if(e!==j.elementId){let a=E.find(t=>t.id===e);a&&f(e,{x:a.x+t,y:a.y+s})}})}else if(N.active){let t=b.current.getBoundingClientRect(),s=(e.clientX-t.left)/(T.zoom/100),a=(e.clientY-t.top)/(T.zoom/100);w(e=>({...e,endX:s,endY:a}))}}},[j,N,d,f,null===(r=m.canvas)||void 0===r?void 0:r.zoom,E]),A=(0,l.useCallback)(()=>{N.active&&(x(X(N)),w(e=>({...e,active:!1}))),y(e=>({...e,isDragging:!1})),v&&v({type:"element_update",data:{selectedElements:d},timestamp:Date.now()})},[N,x,d,v]),D=(0,l.useCallback)(e=>{var t;e.preventDefault();let s=null===(t=b.current)||void 0===t?void 0:t.getBoundingClientRect();if(!s)return;let a=R((e.clientX-s.left)/(T.zoom/100),(e.clientY-s.top)/(T.zoom/100));a&&S({x:e.clientX,y:e.clientY,elementId:a.id})},[null===(n=m.canvas)||void 0===n?void 0:n.zoom]);(0,l.useEffect)(()=>{let e=e=>{if(!e.target||"INPUT"!==e.target.tagName)switch(e.key){case"Delete":case"Backspace":d.length>0&&Y();break;case"c":(e.metaKey||e.ctrlKey)&&W();break;case"v":(e.metaKey||e.ctrlKey)&&Q();break;case"a":(e.metaKey||e.ctrlKey)&&(e.preventDefault(),H());break;case"Escape":x([]),z(null),S(null)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[d]);let R=(e,t)=>{for(let s=Z.length-1;s>=0;s--){let a=Z[s];if(e>=a.x&&e<=a.x+a.width&&t>=a.y&&t<=a.y+a.height)return a}return null},X=e=>{let t=Math.min(e.startX,e.endX),s=Math.max(e.startX,e.endX),a=Math.min(e.startY,e.endY),l=Math.max(e.startY,e.endY);return E.filter(e=>{let r=e.x+e.width/2,i=e.y+e.height/2;return r>=t&&r<=s&&i>=a&&i<=l}).map(e=>e.id)},B=e=>{g({type:e,x:100,y:100,width:"text"===e?200:100,height:"text"===e?50:100,zIndex:Math.max(...E.map(e=>e.zIndex||0))+1,visible:!0,locked:!1,content:"text"===e?"Novo texto":null,style:{position:{x:100,y:100,width:100,height:100},fontSize:"text"===e?16:void 0,backgroundColor:"shape"===e?"#3b82f6":void 0},animations:[],properties:{}})},Y=()=>{d.length>0&&p(d)},W=()=>{console.log("Copying elements:",d)},Q=()=>{console.log("Pasting elements")},H=()=>{x(E.map(e=>e.id))};return(0,a.jsxs)("div",{className:"relative w-full h-full overflow-auto bg-gray-100",children:[(0,a.jsxs)("div",{ref:b,className:"relative bg-white shadow-lg mx-auto my-8 cursor-crosshair",style:{width:T.width,height:T.height,transform:"scale(".concat(T.zoom/100,")"),transformOrigin:"top left"},onMouseDown:M,onMouseMove:I,onMouseUp:A,onContextMenu:D,children:[(()=>{if(!T.showGrid)return null;let e=T.gridSize,t=T.width,s=T.height,l=[];for(let r=0;r<=t;r+=e)l.push((0,a.jsx)("line",{x1:r,y1:0,x2:r,y2:s,stroke:"#e5e7eb",strokeWidth:"1",opacity:"0.5"},"v-".concat(r)));for(let r=0;r<=s;r+=e)l.push((0,a.jsx)("line",{x1:0,y1:r,x2:t,y2:r,stroke:"#e5e7eb",strokeWidth:"1",opacity:"0.5"},"h-".concat(r)));return(0,a.jsx)("svg",{className:"absolute inset-0 pointer-events-none",width:t,height:s,children:l})})(),Z.map(e=>{var t,s;let l=d.includes(e.id);return T.zoom,(0,a.jsxs)("div",{className:"absolute cursor-move ".concat(l?"ring-2 ring-blue-500":""," ").concat(e.locked?"cursor-not-allowed":""),style:{left:e.x,top:e.y,width:e.width,height:e.height,zIndex:e.zIndex||0,opacity:e.style.opacity||1,transform:e.style.rotation?"rotate(".concat(e.style.rotation,"deg)"):void 0,pointerEvents:e.locked?"none":"auto"},onDoubleClick:t=>{t.stopPropagation(),"text"===e.type&&z(e.id)},children:["text"===e.type&&(k===e.id?(0,a.jsx)(_.I,{defaultValue:e.content||"",className:"w-full h-full border-none bg-transparent p-0",style:{fontSize:e.style.fontSize,fontFamily:e.style.fontFamily,color:e.style.color,textAlign:e.style.textAlign,fontWeight:e.style.fontWeight,fontStyle:e.style.fontStyle},onBlur:t=>{f(e.id,{content:t.target.value}),z(null)},onKeyDown:t=>{"Enter"===t.key&&(f(e.id,{content:t.currentTarget.value}),z(null))},autoFocus:!0}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center p-2 select-none",style:{fontSize:e.style.fontSize,fontFamily:e.style.fontFamily,color:e.style.color,backgroundColor:e.style.backgroundColor,textAlign:e.style.textAlign,fontWeight:e.style.fontWeight,fontStyle:e.style.fontStyle,wordWrap:"break-word",overflow:"hidden"},children:e.content||"Texto"})),"shape"===e.type?(0,a.jsx)("div",{className:"w-full h-full",style:{backgroundColor:e.style.backgroundColor||"#3b82f6",borderColor:e.style.borderColor,borderWidth:e.style.borderWidth,borderRadius:(null===(t=e.properties)||void 0===t?void 0:t.shape)==="circle"?"50%":"0"}}):null,"image"===e.type&&!!(null===(s=e.properties)||void 0===s?void 0:s.src)&&(0,a.jsx)("div",{className:"w-full h-full relative overflow-hidden",children:(0,a.jsx)(q.default,{src:e.properties.src,alt:e.properties.alt||"Imagem",fill:!0,className:"object-cover",draggable:!1,onError:t=>{var s;console.error("Erro ao carregar imagem:",null===(s=e.properties)||void 0===s?void 0:s.src),t.target.src="/placeholder-image.png"}})}),l&&!e.locked&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute -top-1 -left-1 w-2 h-2 bg-blue-500 cursor-nw-resize"}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 cursor-ne-resize"}),(0,a.jsx)("div",{className:"absolute -bottom-1 -left-1 w-2 h-2 bg-blue-500 cursor-sw-resize"}),(0,a.jsx)("div",{className:"absolute -bottom-1 -right-1 w-2 h-2 bg-blue-500 cursor-se-resize"}),(0,a.jsx)("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-500 cursor-n-resize"}),(0,a.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-500 cursor-s-resize"}),(0,a.jsx)("div",{className:"absolute -left-1 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-blue-500 cursor-w-resize"}),(0,a.jsx)("div",{className:"absolute -right-1 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-blue-500 cursor-e-resize"})]}),(e.locked||!e.visible)&&(0,a.jsxs)("div",{className:"absolute -top-6 left-0 flex space-x-1",children:[e.locked&&(0,a.jsx)(V.Z,{className:"w-4 h-4 text-red-500"}),!e.visible&&(0,a.jsx)(F.Z,{className:"w-4 h-4 text-gray-500"})]})]},e.id)}),(()=>{if(!N.active)return null;let e=Math.min(N.startX,N.endX),t=Math.max(N.startX,N.endX),s=Math.min(N.startY,N.endY),l=Math.max(N.startY,N.endY);return(0,a.jsx)("div",{className:"absolute border-2 border-blue-500 bg-blue-100 bg-opacity-20 pointer-events-none",style:{left:e,top:s,width:t-e,height:l-s}})})()]}),C&&(0,a.jsxs)("div",{className:"fixed bg-white shadow-lg rounded-lg border py-2 z-50",style:{left:C.x,top:C.y},children:[(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",className:"w-full justify-start px-3",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4 mr-2"}),"Copiar"]}),(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",className:"w-full justify-start px-3",children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Excluir"]}),(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",className:"w-full justify-start px-3",children:[(0,a.jsx)(V.Z,{className:"w-4 h-4 mr-2"}),"Bloquear"]})]}),d.length>0&&(0,a.jsxs)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-white shadow-lg rounded-lg border p-2 flex items-center space-x-2 z-40",children:[(0,a.jsxs)(o.C,{variant:"secondary",children:[d.length," selecionado(s)"]}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:W,children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:Y,children:(0,a.jsx)(U.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",children:(0,a.jsx)(K.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",children:(0,a.jsx)(G.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-white shadow-lg rounded-lg border p-2 flex items-center space-x-2 z-40",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>B("text"),children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Texto"]}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>B("shape"),children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 mr-2"}),"Forma"]}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>B("image"),children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Imagem"]})]})]})});W.displayName="CanvasEditorV2";var Q=s(42208),H=s(49589),J=s(88623),L=s(81706),$=s(99397),ee=s(40292);let et=["scene","audio","effects","text","video"],es=e=>et.includes(e),ea=(0,l.forwardRef)((e,t)=>{let{slides:s,timeline:r,editorState:n,onTimeUpdate:o,onSlideSelect:c,onTimelineUpdate:d,onEventEmit:m}=e,x=(0,l.useRef)(null),[u,h]=(0,l.useState)(50),[f]=(0,l.useState)(60),[p,g]=(0,l.useState)([]),[v,b]=(0,l.useState)(!1),[j,y]=(0,l.useState)(0),[N,w]=(0,l.useState)(()=>{let e=r.scenes.map((e,t)=>{let a=s.find(t=>t.id===e.slideId);return{id:"scene-".concat(e.slideId),type:"scene",name:(null==a?void 0:a.title)||"Slide ".concat(t+1),height:f,color:"#3b82f6",visible:!0,locked:!1,items:[{id:"scene-item-".concat(e.slideId),name:(null==a?void 0:a.title)||"Slide ".concat(t+1),slideId:e.slideId,startTime:e.startTime,duration:e.duration,color:"#3b82f6",keyframes:[]}]}}),t=[];return s.forEach(e=>{e.elements.forEach(e=>{let s=e.animations;if(s.length>0){var a;let l=["text","video","audio"].includes(e.type)?e.type:"effects";t.push({id:"element-".concat(e.id),type:l,name:e.content||"".concat(e.type," ").concat(e.id.slice(-8)),height:f,color:er(e.type),visible:!0,locked:!1,items:[{id:"element-item-".concat(e.id),name:e.content||e.type,elementId:e.id,startTime:0,duration:(null===(a=s[0])||void 0===a?void 0:a.duration)||2,color:er(e.type),keyframes:s.map(e=>({id:"kf-".concat(e.id),time:e.delay,property:e.type,value:e,easing:e.easing}))}]})}})}),[...e,...t]});(0,l.useImperativeHandle)(t,()=>({togglePlayback:()=>k(),stop:()=>z(),seek:e=>E(e),addTrack:e=>T(e),deleteSelectedItems:()=>_(),zoomIn:()=>h(e=>Math.min(1.5*e,200)),zoomOut:()=>h(e=>Math.max(e/1.5,10))}));let k=(0,l.useCallback)(()=>{m&&m({type:"timeline_update",data:{action:n.playback.isPlaying?"pause":"play"},timestamp:Date.now()})},[n.playback.isPlaying,m]),z=(0,l.useCallback)(()=>{o(0),y(0),m&&m({type:"timeline_update",data:{action:"stop"},timestamp:Date.now()})},[o,m]),E=(0,l.useCallback)(e=>{let t=Math.max(0,Math.min(e,r.totalDuration));o(t),y(t*u);let a=r.scenes.find(t=>e>=t.startTime&&e<t.startTime+t.duration);if(a){let e=s.findIndex(e=>e.id===a.slideId);e>=0&&c(e)}},[r.totalDuration,r.scenes,u,o,c,s]),Z=(0,l.useCallback)(e=>{if(!x.current)return;let t=x.current.getBoundingClientRect();E((e.clientX-t.left)/u)},[u,E]);(0,l.useCallback)((e,t)=>{w(s=>s.map(s=>({...s,items:s.items.map(s=>s.id===e?{...s,startTime:Math.max(0,t)}:s)})))},[]),(0,l.useCallback)((e,t)=>{w(s=>s.map(s=>({...s,items:s.items.map(s=>s.id===e?{...s,duration:Math.max(.1,t)}:s)})))},[]);let T=(0,l.useCallback)(e=>{let t=es(e)?e:"effects",s={id:"track-".concat(Date.now()),type:t,name:"Nova ".concat(t),height:f,color:er(e),visible:!0,locked:!1,items:[]};w(e=>[...e,s])},[]);(0,l.useCallback)(e=>{w(t=>t.filter(t=>t.id!==e))},[]);let R=(0,l.useCallback)(e=>{w(t=>t.map(t=>t.id===e?{...t,visible:!t.visible}:t))},[]),X=(0,l.useCallback)(e=>{w(t=>t.map(t=>t.id===e?{...t,locked:!t.locked}:t))},[]),_=(0,l.useCallback)(()=>{p.length>0&&(w(e=>e.map(e=>({...e,items:e.items.filter(e=>!p.includes(e.id))}))),g([]))},[p]);(0,l.useEffect)(()=>{y(n.playback.currentTime*u)},[n.playback.currentTime,u]);let K=(e,t)=>{let s=p.includes(e.id),l=e.duration*u,r=e.startTime*u;return(0,a.jsxs)("div",{className:"absolute h-10 rounded-md flex items-center px-2 text-white text-xs font-medium cursor-move select-none ".concat(s?"ring-2 ring-white ring-offset-1":""),style:{left:r,width:l,backgroundColor:e.color||t,top:"50%",transform:"translateY(-50%)",minWidth:40},onClick:t=>{t.stopPropagation(),t.shiftKey?g(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id]):g([e.id])},children:[(0,a.jsx)("span",{className:"truncate",children:e.name}),e.keyframes.map(e=>(0,a.jsx)("div",{className:"absolute top-0 w-1 h-full bg-yellow-400 opacity-80",style:{left:e.time*u}},e.id)),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute left-0 top-0 w-2 h-full bg-white opacity-50 cursor-w-resize"}),(0,a.jsx)("div",{className:"absolute right-0 top-0 w-2 h-full bg-white opacity-50 cursor-e-resize"})]})]},e.id)},G=(e,t)=>(0,a.jsxs)("div",{className:"border-b border-gray-700",children:[(0,a.jsx)("div",{className:"flex items-center h-15 px-3 bg-gray-800 border-r border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{className:"text-sm text-white truncate flex-1",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-gray-400 hover:text-white",onClick:()=>R(e.id),children:e.visible?(0,a.jsx)(Q.Z,{className:"w-3 h-3"}):(0,a.jsx)(F.Z,{className:"w-3 h-3"})}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-gray-400 hover:text-white",onClick:()=>X(e.id),children:e.locked?(0,a.jsx)(V.Z,{className:"w-3 h-3"}):(0,a.jsx)(H.Z,{className:"w-3 h-3"})}),"audio"===e.type&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"w-6 h-6 p-0 text-gray-400 hover:text-white",children:e.muted?(0,a.jsx)(J.Z,{className:"w-3 h-3"}):(0,a.jsx)(L.Z,{className:"w-3 h-3"})})]})]})}),(0,a.jsxs)("div",{className:"relative bg-gray-900",style:{height:e.height},onClick:Z,children:[e.items.map(t=>K(t,e.color)),(0,a.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:Math.ceil(r.totalDuration)+1},(e,t)=>(0,a.jsx)("div",{className:"absolute top-0 h-full border-l border-gray-700 opacity-30",style:{left:t*u}},t))})]})]},e.id);return(0,a.jsxs)("div",{className:"bg-gray-900 text-white flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:z,className:"text-white hover:bg-gray-700",children:(0,a.jsx)(P.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>E(Math.max(0,n.playback.currentTime-5)),className:"text-white hover:bg-gray-700",children:(0,a.jsx)(M.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white",children:n.playback.isPlaying?(0,a.jsx)(I.Z,{className:"w-4 h-4"}):(0,a.jsx)(A.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>E(Math.min(r.totalDuration,n.playback.currentTime+5)),className:"text-white hover:bg-gray-700",children:(0,a.jsx)(D.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"text-sm font-mono",children:[el(n.playback.currentTime)," / ",el(r.totalDuration)]}),(0,a.jsx)(S.Z,{orientation:"vertical",className:"h-6 bg-gray-600"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>h(e=>Math.max(e/1.5,10)),className:"text-white hover:bg-gray-700",children:(0,a.jsx)(B.Z,{className:"w-4 h-4"})}),(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:[Math.round(u),"px/s"]}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>h(e=>Math.min(1.5*e,200)),className:"text-white hover:bg-gray-700",children:(0,a.jsx)(Y.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>T("audio"),className:"text-white hover:bg-gray-700",children:[(0,a.jsx)($.Z,{className:"w-4 h-4 mr-2"}),"\xc1udio"]}),(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>T("effects"),className:"text-white hover:bg-gray-700",children:[(0,a.jsx)($.Z,{className:"w-4 h-4 mr-2"}),"Efeitos"]}),p.length>0&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:_,className:"text-red-400 hover:bg-red-600 hover:text-white",children:(0,a.jsx)(U.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"bg-gray-800 px-3 py-1 border-b border-gray-700 relative",children:(0,a.jsxs)("div",{className:"flex items-center h-6",children:[(0,a.jsx)("div",{className:"w-48 border-r border-gray-700"}),(0,a.jsxs)("div",{className:"flex-1 relative",ref:x,children:[Array.from({length:Math.ceil(r.totalDuration)+1},(e,t)=>(0,a.jsxs)("div",{className:"absolute top-0 h-full",style:{left:t*u},children:[(0,a.jsx)("div",{className:"border-l border-gray-600 h-full"}),(0,a.jsx)("span",{className:"absolute top-0 left-1 text-xs text-gray-400",children:el(t)})]},t)),(0,a.jsx)("div",{className:"absolute top-0 w-0.5 h-full bg-red-500 z-10 pointer-events-none",style:{left:j}})]})]})}),(0,a.jsx)(C.x,{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[N.map((e,t)=>G(e,t)),(0,a.jsx)("div",{className:"absolute top-0 w-0.5 bg-red-500 z-10 pointer-events-none",style:{left:192+j,height:N.length*(f+1)}})]})}),p.length>0&&(0,a.jsxs)("div",{className:"bg-gray-800 px-4 py-2 border-t border-gray-700 flex items-center justify-between text-sm",children:[(0,a.jsxs)("span",{children:[p.length," item(s) selecionado(s)"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"text-white hover:bg-gray-700",children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"text-white hover:bg-gray-700",children:(0,a.jsx)(ee.Z,{className:"w-4 h-4"})})]})]})]})});function el(e){return"".concat(Math.floor(e/60).toString().padStart(2,"0"),":").concat(Math.floor(e%60).toString().padStart(2,"0"),".").concat(Math.floor(e%1*100).toString().padStart(2,"0"))}function er(e){return({text:"#10b981",image:"#f59e0b",video:"#8b5cf6",shape:"#3b82f6",audio:"#ef4444",scene:"#6366f1",effects:"#ec4899"})[e]||"#6b7280"}ea.displayName="TimelineEditorV2";var ei=s(91723);function en(e){let{scenes:t,currentScene:s,onSceneSelect:n,onSceneUpdate:c,onSceneAdd:d,onSceneDelete:m,onSceneDuplicate:x}=e,[f,g]=(0,l.useState)(null),v=(e,t)=>{c(e,{title:t}),g(null)},b=(e,l)=>{let c=l===s,d=e.elements.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{});return(0,a.jsx)(r.Zb,{className:"mb-3 cursor-pointer transition-all ".concat(c?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"),onClick:()=>n(l),children:(0,a.jsxs)(r.aY,{className:"p-3",children:[(0,a.jsxs)("div",{className:"aspect-video bg-gray-200 rounded mb-2 flex items-center justify-center relative overflow-hidden",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(p.Z,{className:"w-8 h-8 text-gray-400 mb-1"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:[e.elements.length," elementos"]})]}),(0,a.jsx)("div",{className:"absolute top-1 left-1 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:l+1})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[f===l?(0,a.jsx)(_.I,{defaultValue:e.title,className:"text-sm h-8",onBlur:e=>v(l,e.target.value),onKeyDown:e=>{"Enter"===e.key&&v(l,e.currentTarget.value),"Escape"===e.key&&g(null)},autoFocus:!0}):(0,a.jsx)("h4",{className:"font-medium text-sm truncate cursor-pointer hover:text-blue-600",onDoubleClick:()=>g(l),title:e.title,children:e.title}),(0,a.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,a.jsx)(ei.Z,{className:"w-3 h-3 mr-1"}),e.duration,"s"]}),Object.keys(d).length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(d).map(e=>{let[t,s]=e;return(0,a.jsxs)(o.C,{variant:"secondary",className:"text-xs px-1 py-0 h-5",children:["text"===t&&(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1"}),"image"===t&&(0,a.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"shape"===t&&(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),s]},t)})}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-1",children:[(0,a.jsx)("div",{className:"flex items-center space-x-1",children:(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:e=>{e.stopPropagation()},children:(0,a.jsx)(Q.Z,{className:"w-3 h-3"})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[x&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:e=>{e.stopPropagation(),x(l)},children:(0,a.jsx)(O.Z,{className:"w-3 h-3"})}),m&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-500 hover:text-red-700",onClick:e=>{e.stopPropagation(),t.length>1&&m(l)},children:(0,a.jsx)(U.Z,{className:"w-3 h-3"})})]})]})]})]})},e.id)};return(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Cenas"}),(0,a.jsxs)(o.C,{variant:"secondary",className:"text-xs",children:[t.length," slide",1!==t.length?"s":""]})]}),d&&(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:d,className:"w-full",children:[(0,a.jsx)($.Z,{className:"w-4 h-4 mr-2"}),"Nova Cena"]})]}),(0,a.jsx)(C.x,{className:"flex-1 p-4",children:(0,a.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>b(e,t))})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:(0,a.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Dura\xe7\xe3o total:"}),(0,a.jsxs)("span",{children:[t.reduce((e,t)=>e+(t.duration||0),0),"s"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Elementos totais:"}),(0,a.jsx)("span",{children:t.reduce((e,t)=>e+t.elements.length,0)})]})]})})]})}var eo=s(49665),ec=s(60967),ed=s(48662),em=s(92369),ex=s(82023);function eu(e){let{onContentGenerated:t,onAddToSlide:s}=e,[r,c]=(0,l.useState)(""),[d,m]=(0,l.useState)("pt-BR-female-1"),[x,u]=(0,l.useState)("instructor-male"),[h,f]=(0,l.useState)(!1),[p,g]=(0,l.useState)(0),v=[{id:"pt-BR-female-1",name:"Ana (Feminina)",language:"Portugu\xeas",premium:!1},{id:"pt-BR-male-1",name:"Carlos (Masculino)",language:"Portugu\xeas",premium:!1},{id:"pt-BR-female-2",name:"Beatriz (Profissional)",language:"Portugu\xeas",premium:!0},{id:"pt-BR-male-2",name:"Eduardo (Corporativo)",language:"Portugu\xeas",premium:!0}],b=async()=>{if(r.trim()){f(!0),g(0);try{let e=setInterval(()=>{g(e=>Math.min(e+10,90))},200);await new Promise(e=>setTimeout(e,2e3)),clearInterval(e),g(100);let s={type:"tts",data:{text:r,voice:d,audioUrl:"/api/tts/generated/".concat(Date.now(),".mp3"),duration:Math.ceil(.1*r.length)}};t(s)}catch(e){console.error("Erro na gera\xe7\xe3o TTS:",e)}finally{f(!1),g(0)}}},j=async()=>{if(r.trim()){f(!0),g(0);try{let e=setInterval(()=>{g(e=>Math.min(e+8,85))},300);await new Promise(e=>setTimeout(e,3e3)),clearInterval(e),g(100);let s={type:"avatar",data:{text:r,avatar:x,voice:d,videoUrl:"/api/avatar/generated/".concat(Date.now(),".mp4"),duration:Math.ceil(.12*r.length)}};t(s)}catch(e){console.error("Erro na gera\xe7\xe3o Avatar:",e)}finally{f(!1),g(0)}}};return(0,a.jsx)("div",{className:"h-full flex flex-col",children:(0,a.jsxs)(z.mQ,{defaultValue:"tts",className:"flex-1 flex flex-col",children:[(0,a.jsxs)(z.dr,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(z.SP,{value:"tts",className:"flex items-center",children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4 mr-2"}),"TTS"]}),(0,a.jsxs)(z.SP,{value:"avatar",className:"flex items-center",children:[(0,a.jsx)(em.Z,{className:"w-4 h-4 mr-2"}),"Avatar"]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,a.jsx)(z.nU,{value:"tts",className:"h-full",children:(0,a.jsx)(C.x,{className:"h-full p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Texto para Narra\xe7\xe3o"}),(0,a.jsx)(eo.g,{placeholder:"Digite o texto que ser\xe1 narrado...",value:r,onChange:e=>c(e.target.value),rows:4,className:"resize-none"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[r.length," caracteres • ~",Math.ceil(.1*r.length),"s"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Voz"}),(0,a.jsxs)(ec.Ph,{value:d,onValueChange:m,children:[(0,a.jsx)(ec.i4,{children:(0,a.jsx)(ec.ki,{placeholder:"Selecionar voz"})}),(0,a.jsx)(ec.Bw,{children:v.map(e=>(0,a.jsx)(ec.Ql,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:e.name}),e.premium&&(0,a.jsx)(o.C,{variant:"secondary",className:"text-xs",children:"Premium"})]})},e.id))})]})]}),h&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.E,{value:p}),(0,a.jsxs)("p",{className:"text-sm text-center text-gray-600",children:["Gerando narra\xe7\xe3o... ",p,"%"]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(i.z,{onClick:b,disabled:!r.trim()||h,className:"flex-1",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 mr-2"}),"Gerar TTS"]})})]})})}),(0,a.jsx)(z.nU,{value:"avatar",className:"h-full",children:(0,a.jsx)(C.x,{className:"h-full p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Texto para Avatar"}),(0,a.jsx)(eo.g,{placeholder:"Digite o texto que o avatar falar\xe1...",value:r,onChange:e=>c(e.target.value),rows:4,className:"resize-none"}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[r.length," caracteres • ~",Math.ceil(.12*r.length),"s"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Avatar"}),(0,a.jsxs)(ec.Ph,{value:x,onValueChange:u,children:[(0,a.jsx)(ec.i4,{children:(0,a.jsx)(ec.ki,{placeholder:"Selecionar avatar"})}),(0,a.jsx)(ec.Bw,{children:[{id:"instructor-male",name:"Instrutor Masculino",category:"Profissional"},{id:"instructor-female",name:"Instrutora Feminina",category:"Profissional"},{id:"safety-engineer",name:"Engenheiro de Seguran\xe7a",category:"T\xe9cnico"},{id:"worker",name:"Operador",category:"Industrial"}].map(e=>(0,a.jsx)(ec.Ql,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(o.C,{variant:"outline",className:"text-xs",children:e.category})]})},e.id))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Voz do Avatar"}),(0,a.jsxs)(ec.Ph,{value:d,onValueChange:m,children:[(0,a.jsx)(ec.i4,{children:(0,a.jsx)(ec.ki,{placeholder:"Selecionar voz"})}),(0,a.jsx)(ec.Bw,{children:v.map(e=>(0,a.jsx)(ec.Ql,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{children:e.name}),e.premium&&(0,a.jsx)(o.C,{variant:"secondary",className:"text-xs",children:"Premium"})]})},e.id))})]})]}),h&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.E,{value:p}),(0,a.jsxs)("p",{className:"text-sm text-center text-gray-600",children:["Gerando avatar falante... ",p,"%"]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(i.z,{onClick:j,disabled:!r.trim()||h,className:"flex-1",children:[(0,a.jsx)(ex.Z,{className:"w-4 h-4 mr-2"}),"Gerar Avatar"]})})]})})})]})]})})}let eh={canvas:{width:1920,height:1080,zoom:50,showGrid:!1,gridSize:20,showRulers:!1,snapToGrid:!0,snapDistance:5,pan:{x:0,y:0},backgroundColor:"#ffffff"},timeline:{pixelsPerSecond:50,trackHeight:60,visibleTracks:10,showKeyframes:!0,snapToKeyframes:!0},export:{format:"mp4",quality:"high",fps:30,bitrate:"8000k",resolution:{width:1920,height:1080}}};function ef(e){var t;let{projectData:s,onSave:n,onExport:c}=e,[m,x]=(0,l.useState)(s.slides),[h,g]=(0,l.useState)(eh),[b,y]=(0,l.useState)({currentSlide:0,selectedElements:[],clipboard:[],history:{past:[],future:[],maxSteps:50},playback:{isPlaying:!1,currentTime:0,playbackRate:1,loop:!1},tools:{activeTool:"select",brush:{size:5,color:"#3b82f6",opacity:1}},canvas:eh.canvas}),N=(0,l.useRef)(null),w=(0,l.useRef)(null),k=(0,l.useRef)(null),_=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{slides:m,metadata:s.metadata,timeline:s.timeline,...e}},[m,s.metadata,s.timeline]);(0,l.useEffect)(()=>()=>{k.current&&clearTimeout(k.current)},[]);let V=(0,l.useCallback)(e=>{console.log("\uD83C\uDFAC Editor Event:",e);let t=e.data;switch(e.type){case"element_select":y(e=>({...e,selectedElements:t.elementIds||[]}));break;case"element_update":n&&(k.current&&clearTimeout(k.current),k.current=window.setTimeout(()=>{n(_())},2e3));break;case"timeline_update":"play"===t.action?y(e=>({...e,playback:{...e.playback,isPlaying:!0}})):"pause"===t.action?y(e=>({...e,playback:{...e.playback,isPlaying:!1}})):"stop"===t.action&&y(e=>({...e,playback:{...e.playback,isPlaying:!1,currentTime:0}}))}},[_,n]),F=(0,l.useCallback)(e=>{y(t=>({...t,currentSlide:e,selectedElements:[]})),V({type:"slide_change",data:{slideIndex:e},timestamp:Date.now()})},[V]),O=(0,l.useCallback)(e=>{y(t=>({...t,selectedElements:e})),V({type:"element_select",data:{elementIds:e},timestamp:Date.now()})},[V]),U=(0,l.useCallback)((e,t)=>{x(s=>{let a=[...s],l=a[b.currentSlide];if(l){let s=l.elements.findIndex(t=>t.id===e);s>=0&&(l.elements[s]={...l.elements[s],...t,style:{...l.elements[s].style,...t.style,position:{...l.elements[s].style.position,...void 0!==t.x?{x:t.x}:{},...void 0!==t.y?{y:t.y}:{},...void 0!==t.width?{width:t.width}:{},...void 0!==t.height?{height:t.height}:{}}}})}return a}),V({type:"element_update",data:{elementId:e,updates:t},timestamp:Date.now()})},[b.currentSlide,V]),K=(0,l.useCallback)(e=>{x(t=>{let s=[...t],a=s[b.currentSlide];return a&&(a.elements=a.elements.filter(t=>!e.includes(t.id))),s}),y(t=>({...t,selectedElements:t.selectedElements.filter(t=>!e.includes(t))})),d.Am.success("".concat(e.length," elemento(s) exclu\xeddo(s)"))},[b.currentSlide]),G=(0,l.useCallback)(e=>{var t;let s={id:"element_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:e.type||"text",content:e.content||null,x:e.x||100,y:e.y||100,width:e.width||200,height:e.height||100,zIndex:e.zIndex||((null===(t=m[b.currentSlide])||void 0===t?void 0:t.elements.length)||0)+1,visible:!1!==e.visible,locked:e.locked||!1,style:{position:{x:e.x||100,y:e.y||100,width:e.width||200,height:e.height||100},fontSize:16,fontFamily:"Arial",color:"#000000",...e.style},animations:e.animations||[],properties:e.properties||{}};x(e=>{let t=[...e],a=t[b.currentSlide];return a&&a.elements.push(s),t}),y(e=>({...e,selectedElements:[s.id]})),d.Am.success("".concat(s.type," adicionado"))},[m,b.currentSlide]),q=(0,l.useCallback)(()=>{var e;let t=!b.playback.isPlaying;y(e=>({...e,playback:{...e.playback,isPlaying:t}})),null===(e=w.current)||void 0===e||e.togglePlayback()},[b.playback.isPlaying]),Q=(0,l.useCallback)(()=>{var e;y(e=>({...e,playback:{...e.playback,isPlaying:!1,currentTime:0}})),null===(e=w.current)||void 0===e||e.stop()},[]),H=(0,l.useCallback)(e=>{y(t=>({...t,playback:{...t.playback,currentTime:e}}))},[]),J=(0,l.useCallback)(()=>{let e=_({lastModified:new Date().toISOString(),version:"2.0"});n&&n(e),d.Am.success("Projeto salvo com sucesso!")},[_,n]),L=(0,l.useCallback)(async()=>{try{d.Am.loading("Iniciando renderiza\xe7\xe3o...",{id:"export-toast"}),V({type:"export_start",data:{settings:h.export},timestamp:Date.now()});let e=await fetch("/api/v1/render/video-production-v2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slides:m,timeline:s.timeline,settings:h.export})});if(!e.ok)throw Error("Erro na renderiza\xe7\xe3o");let t=await e.json();if(!t.success)throw Error(t.error||"Falha na renderiza\xe7\xe3o");let a=t.jobId;d.Am.success("Renderiza\xe7\xe3o iniciada! ID: ".concat(a),{id:"export-toast"}),c&&c(),V({type:"export_complete",data:{jobId:a},timestamp:Date.now()})}catch(e){console.error("❌ Erro no export:",e),d.Am.error("Erro: ".concat(e instanceof Error?e.message:"Erro desconhecido"),{id:"export-toast"})}},[m,s.timeline,h.export,c,V]),$=(0,l.useCallback)(()=>{(0,d.Am)("Desfazer (em desenvolvimento)")},[]),ee=(0,l.useCallback)(()=>{(0,d.Am)("Refazer (em desenvolvimento)")},[]),et=(0,l.useCallback)(e=>{y(t=>({...t,tools:{...t.tools,activeTool:e}}))},[]),es=(0,l.useCallback)(()=>{g(e=>({...e,canvas:{...e.canvas,zoom:Math.min(1.2*e.canvas.zoom,200)}})),y(e=>({...e,canvas:e.canvas?{...e.canvas,zoom:Math.min(1.2*e.canvas.zoom,200)}:eh.canvas}))},[]),el=(0,l.useCallback)(()=>{g(e=>({...e,canvas:{...e.canvas,zoom:Math.max(e.canvas.zoom/1.2,25)}})),y(e=>({...e,canvas:e.canvas?{...e.canvas,zoom:Math.max(e.canvas.zoom/1.2,25)}:eh.canvas}))},[]),er=m[b.currentSlide];return(0,a.jsxs)("div",{className:"h-screen bg-gray-50 flex flex-col overflow-hidden","data-testid":"animaker-editor",children:[(0,a.jsxs)("header",{className:"bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center",children:(0,a.jsx)(f.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:s.metadata.title})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:$,children:(0,a.jsx)(E.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:ee,children:(0,a.jsx)(Z.Z,{className:"w-4 h-4"})}),(0,a.jsx)(S.Z,{orientation:"vertical",className:"h-6"}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>et("select"),className:"select"===b.tools.activeTool?"bg-blue-100":"",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>et("text"),className:"text"===b.tools.activeTool?"bg-blue-100":"",children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg px-3 py-2",children:[(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:Q,children:(0,a.jsx)(P.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(M.Z,{className:"w-4 h-4"})}),(0,a.jsx)(i.z,{onClick:q,className:"w-10 h-10 rounded-full bg-blue-600 hover:bg-blue-700 text-white","data-testid":"timeline-play",children:b.playback.isPlaying?(0,a.jsx)(I.Z,{className:"w-5 h-5"}):(0,a.jsx)(A.Z,{className:"w-5 h-5"})}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(D.Z,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"text-sm text-gray-600","data-testid":"current-time",children:(t=b.playback.currentTime,"".concat(Math.floor(t/60).toString().padStart(2,"0"),":").concat(Math.floor(t%60).toString().padStart(2,"0"),".").concat(Math.floor(t%1*100).toString().padStart(2,"0")))})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:J,children:[(0,a.jsx)(R.Z,{className:"w-4 h-4 mr-2"}),"Salvar"]}),(0,a.jsxs)(i.z,{onClick:L,className:"bg-green-600 hover:bg-green-700 text-white","data-testid":"export-button",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),"Exportar"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsx)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:(0,a.jsxs)(z.mQ,{defaultValue:"elements",className:"flex-1 flex flex-col",children:[(0,a.jsxs)(z.dr,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(z.SP,{value:"elements",children:"Assets"}),(0,a.jsx)(z.SP,{value:"ai-voice",children:"IA Voice"}),(0,a.jsx)(z.SP,{value:"templates",children:"Templates"}),(0,a.jsx)(z.SP,{value:"uploads",children:"Upload"})]}),(0,a.jsx)(z.nU,{value:"elements",className:"flex-1 p-3",children:(0,a.jsx)(C.x,{className:"h-full",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{className:"py-3",children:(0,a.jsx)(r.ll,{className:"text-sm",children:"Elementos R\xe1pidos"})}),(0,a.jsx)(r.aY,{className:"py-2",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>G({type:"text",content:"Novo texto"}),className:"h-12 flex flex-col",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-xs",children:"Texto"})]}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>G({type:"shape"}),className:"h-12 flex flex-col",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-xs",children:"Forma"})]})]})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{className:"py-3",children:(0,a.jsx)(r.ll,{className:"text-sm",children:"Biblioteca"})}),(0,a.jsx)(r.aY,{className:"py-2",children:(0,a.jsxs)("div",{className:"text-center text-gray-500 text-sm",children:["Assets carregados: ",s.assets.images.length," imagens"]})})]})]})})}),(0,a.jsx)(z.nU,{value:"ai-voice",className:"flex-1 p-2",children:(0,a.jsx)(eu,{onContentGenerated:e=>{d.Am.success("".concat(e.type," gerado!"))},onAddToSlide:(e,t)=>{d.Am.success("".concat(e.type," adicionado ao slide!"))}})}),(0,a.jsx)(z.nU,{value:"templates",className:"flex-1 p-3",children:(0,a.jsx)("div",{className:"text-center text-gray-500",children:"Templates em desenvolvimento"})}),(0,a.jsx)(z.nU,{value:"uploads",className:"flex-1 p-3",children:(0,a.jsxs)(i.z,{className:"w-full",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Upload de Assets"]})})]})}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col bg-gray-100",children:[(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>g(e=>({...e,canvas:{...e.canvas,showGrid:!e.canvas.showGrid}})),className:h.canvas.showGrid?"bg-blue-100":"",children:(0,a.jsx)(X.Z,{className:"w-4 h-4"})}),(0,a.jsx)(S.Z,{orientation:"vertical",className:"h-6"}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:el,children:(0,a.jsx)(B.Z,{className:"w-4 h-4"})}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(h.canvas.zoom),"%"]}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:es,children:(0,a.jsx)(Y.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:["Slide ",b.currentSlide+1," de ",m.length]}),(0,a.jsx)(o.C,{variant:"outline",children:(null==er?void 0:er.layout)||"padr\xe3o"})]})]}),(0,a.jsx)("div",{className:"flex-1 relative overflow-auto","data-testid":"canvas-editor",children:(0,a.jsx)(W,{ref:N,slide:er,selectedElements:b.selectedElements,editorState:b,onElementSelect:O,onElementUpdate:U,onElementDelete:K,onElementAdd:G,onEventEmit:V})})]}),(0,a.jsx)("div",{className:"w-80 bg-white border-l border-gray-200",children:(0,a.jsx)(en,{scenes:m,currentScene:b.currentSlide,onSceneSelect:F,onSceneUpdate:(e,t)=>{x(s=>{let a=[...s];return a[e]&&(a[e]={...a[e],...t}),a})}})})]}),(0,a.jsx)("div",{className:"h-64 bg-gray-900 border-t border-gray-700","data-testid":"timeline-editor",children:(0,a.jsx)(ea,{ref:w,slides:m,timeline:s.timeline,editorState:b,onTimeUpdate:H,onSlideSelect:F,onTimelineUpdate:e=>{},onEventEmit:V})}),!1]})}function ep(){let[e,t]=(0,l.useState)("upload"),[s,r]=(0,l.useState)(null);return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:["upload"===e&&(0,a.jsx)(k,{onAnalysisComplete:e=>{console.log("\uD83C\uDFAC Dados do projeto carregados:",{slides:e.slides.length,totalElements:e.statistics.totalElements,editableElements:e.statistics.editableElements,elementsByType:e.statistics.elementsByType}),r(e),t("editor")},onCancel:()=>window.history.back()}),"editor"===e&&s&&(0,a.jsx)(ef,{projectData:s,onSave:e=>{console.log("\uD83D\uDCBE Salvando projeto v2:",e)},onExport:()=>{t("export"),console.log("\uD83C\uDFAC Iniciando renderiza\xe7\xe3o v2...")}}),"export"===e&&(0,a.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto bg-green-100 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-green-600 border-t-transparent rounded-full animate-spin"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Renderizando V\xeddeo v2.0"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Pipeline de renderiza\xe7\xe3o real em execu\xe7\xe3o..."}),(0,a.jsx)("button",{onClick:()=>t("editor"),className:"text-blue-600 hover:underline",children:"← Voltar ao Editor"})]})})]})}},22835:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var a=s(61994),l=s(53335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.m6)((0,a.W)(t))}}},function(e){e.O(0,[6137,7479,271,3347,6241,51,926,9064,4986,9043,8608,2971,2117,1744],function(){return e(e.s=26263)}),_N_E=e.O()}]);