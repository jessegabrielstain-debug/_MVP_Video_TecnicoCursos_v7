(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1258],{57591:function(e,t,a){Promise.resolve().then(a.bind(a,57062))},41875:function(e,t,a){"use strict";a.d(t,{C:function(){return o}});var s=a(57437);a(2265);var r=a(90535),n=a(22835);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:a}),t),...r})}},92595:function(e,t,a){"use strict";a.d(t,{d:function(){return o},z:function(){return l}});var s=a(57437),r=a(2265),n=a(90535),i=a(22835);let o=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:l=!1,...c}=e;return(0,s.jsx)(l?"span":"button",{className:(0,i.cn)(o({variant:r,size:n,className:a})),ref:t,...c})});l.displayName="Button"},34029:function(e,t,a){"use strict";a.d(t,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var s=a(57437),r=a(2265),n=a(22835);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});i.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...r})});o.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...r})});l.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},3805:function(e,t,a){"use strict";a.d(t,{$N:function(){return x},Be:function(){return p},Vq:function(){return l},cN:function(){return h},cZ:function(){return f},fK:function(){return m},hg:function(){return c}});var s=a(57437),r=a(2265),n=a(49027),i=a(32489),o=a(22835);let l=n.fC,c=n.xz,d=n.h_;n.x8;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.aV,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});u.displayName=n.aV.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(n.VY,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,s.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.VY.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Dx,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});x.displayName=n.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.dk,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});p.displayName=n.dk.displayName},2351:function(e,t,a){"use strict";a.d(t,{$F:function(){return u},AW:function(){return f},Ju:function(){return h},VD:function(){return x},Xi:function(){return m},h_:function(){return d}});var s=a(57437),r=a(2265),n=a(70085),i=a(10407),o=a(30401),l=a(40519),c=a(22835);let d=n.fC,u=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,r.forwardRef((e,t)=>{let{className:a,inset:r,children:o,...l}=e;return(0,s.jsxs)(n.fF,{ref:t,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",a),...l,children:[o,(0,s.jsx)(i.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=n.fF.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=n.tu.displayName;let f=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...i}=e;return(0,s.jsx)(n.Uv,{children:(0,s.jsx)(n.VY,{ref:t,sideOffset:r,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})})});f.displayName=n.VY.displayName;let m=r.forwardRef((e,t)=>{let{className:a,inset:r,...i}=e;return(0,s.jsx)(n.ck,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",a),...i})});m.displayName=n.ck.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:i,...l}=e;return(0,s.jsxs)(n.oC,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:i,...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),r]})}).displayName=n.oC.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(n.Rk,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(l.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=n.Rk.displayName;let h=r.forwardRef((e,t)=>{let{className:a,inset:r,...i}=e;return(0,s.jsx)(n.__,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...i})});h.displayName=n.__.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});x.displayName=n.Z0.displayName},46393:function(e,t,a){"use strict";a.d(t,{_:function(){return c}});var s=a(57437),r=a(2265),n=a(6394),i=a(90535),o=a(22835);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.f,{ref:t,className:(0,o.cn)(l(),a),...r})});c.displayName=n.f.displayName},6403:function(e,t,a){"use strict";a.d(t,{B:function(){return l},x:function(){return o}});var s=a(57437),r=a(2265),n=a(43643),i=a(22835);let o=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(n.fC,{ref:t,className:(0,i.cn)("relative overflow-hidden",a),...o,children:[(0,s.jsx)(n.l_,{className:"h-full w-full rounded-[inherit]",children:r}),(0,s.jsx)(l,{}),(0,s.jsx)(n.Ns,{})]})});o.displayName=n.fC.displayName;let l=r.forwardRef((e,t)=>{let{className:a,orientation:r="vertical",...o}=e;return(0,s.jsx)(n.gb,{ref:t,orientation:r,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 border-t border-t-transparent p-[1px]",a),...o,children:(0,s.jsx)(n.q4,{className:"relative flex-1 rounded-full bg-border"})})});l.displayName=n.gb.displayName},60967:function(e,t,a){"use strict";a.d(t,{Bw:function(){return f},Ph:function(){return c},Ql:function(){return m},i4:function(){return u},ki:function(){return d}});var s=a(57437),r=a(2265),n=a(56873),i=a(40875),o=a(30401),l=a(22835);let c=n.fC;n.ZA;let d=n.B4,u=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(n.xz,{ref:t,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...o,children:[r,(0,s.jsx)(n.JO,{asChild:!0,children:(0,s.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.xz.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,position:i="popper",...o}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsx)(n.VY,{ref:t,className:(0,l.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...o,children:(0,s.jsx)(n.l_,{className:(0,l.cn)("popper"===i&&"p-1",a),children:r})})})});f.displayName=n.VY.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.__,{ref:t,className:(0,l.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=n.__.displayName;let m=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(n.ck,{ref:t,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(n.eT,{children:r})]})});m.displayName=n.ck.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:t,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=n.Z0.displayName},72927:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var s=a(57437),r=a(2265),n=a(55156),i=a(22835);let o=r.forwardRef((e,t)=>{let{className:a,orientation:r="horizontal",decorative:o=!0,...l}=e;return(0,s.jsx)(n.f,{ref:t,decorative:o,orientation:r,className:(0,i.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...l})});o.displayName=n.f.displayName},15353:function(e,t,a){"use strict";a.d(t,{r:function(){return o}});var s=a(57437),r=a(2265),n=a(50721),i=a(22835);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.fC,{className:(0,i.cn)("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:t,children:(0,s.jsx)(n.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});o.displayName=n.fC.displayName},51098:function(e,t,a){"use strict";a.d(t,{SP:function(){return c},dr:function(){return l},mQ:function(){return o},nU:function(){return d}});var s=a(57437),r=a(2265),n=a(20271),i=a(22835);let o=n.fC,l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});l.displayName=n.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});c.displayName=n.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});d.displayName=n.VY.displayName},57062:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Y}});var s=a(57437),r=a(2265),n=a(77086),i=a(14438),o=a(58113);let l=async e=>{let t=await fetch(e,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")}});if(!t.ok)throw Error("Notifications API error: ".concat(t.statusText));return t.json()};var c=a(92595),d=a(34029),u=a(41875),f=a(15353),m=a(46393),h=a(51098),x=a(60967),p=a(3805),g=a(2351),y=a(6403),j=a(72927),v=a(33245),b=a(41671),N=a(49322),w=a(99388),k=a(96137),C=a(92369),_=a(29374),Z=a(53417),z=a(69292),A=a(18930),E=a(98728),S=a(89345),R=a(33388),T=a(81706),I=a(73247),F=a(90740),P=a(94766),U=a(91723),V=a(67782),B=a(30401),O=a(42208);let D={info:v.Z,success:b.Z,warning:N.Z,error:w.Z,system:k.Z,user:C.Z,render:_.Z,message:Z.Z},M={info:"text-blue-500",success:"text-green-500",warning:"text-yellow-500",error:"text-red-500",system:"text-gray-500",user:"text-purple-500",render:"text-indigo-500",message:"text-cyan-500"};function Q(){let{notifications:e,unreadCount:t,preferences:a,isLoading:b,error:N,markAsRead:w,markAllAsRead:k,deleteNotification:C,deleteAllRead:_,updatePreferences:Z,testNotification:Q,filters:Y,setFilters:J}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.useMemo)(()=>(0,o.eI)(),[]),[a,s]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=!0;(async()=>{try{var a;let{data:r}=await t.auth.getUser();if(!e)return;s(null!==(a=r.user)&&void 0!==a?a:null)}catch(e){console.error("[Notifications] Falha ao carregar usu\xe1rio:",e)}})();let{data:a}=t.auth.onAuthStateChange((t,a)=>{var r;e&&s(null!==(r=null==a?void 0:a.user)&&void 0!==r?r:null)});return()=>{e=!1,null==a||a.subscription.unsubscribe()}},[t]);let[u,f]=(0,r.useState)([]),[m,h]=(0,r.useState)(0);(0,r.useRef)([]);let x=(0,r.useRef)(!0),p=new URLSearchParams({...e.type&&{type:e.type.join(",")},...e.category&&{category:e.category},...e.priority&&{priority:e.priority.join(",")},...e.status&&{status:e.status},...e.timeRange&&{timeRange:e.timeRange},...e.projectId&&{projectId:e.projectId},...e.limit&&{limit:e.limit.toString()},...e.offset&&{offset:e.offset.toString()}}).toString(),{data:g,error:y,mutate:j,isLoading:v}=(0,n.ZP)(a?"/api/notifications?".concat(p):null,l,{refreshInterval:3e4,revalidateOnFocus:!0,errorRetryCount:3,onSuccess:e=>{e.success&&h(e.stats.unread)}}),{data:b,error:N,mutate:w,isLoading:k}=(0,n.ZP)(a?"/api/notifications/preferences":null,l,{revalidateOnFocus:!1,errorRetryCount:2}),C=(0,r.useCallback)(e=>{f(t=>[e,...t.slice(0,49)]),h(e=>e+1);let t=null==b?void 0:b.data;if(null==t?void 0:t.in_app_notifications){let a=e.type;!1!==t.notification_types[a]&&(_(e),x.current&&"low"!==e.priority&&Z(e.priority))}j()},[b,j]);(0,r.useEffect)(()=>{if(!a)return;let e=t.channel("notifications_changes").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:"user_id=eq.".concat(a.id)},e=>{if("INSERT"===e.eventType)C(e.new);else if("UPDATE"===e.eventType){let t=e.new;f(e=>e.map(e=>e.id===t.id?t:e)),j()}else if("DELETE"===e.eventType){let t=e.old.id;f(e=>e.filter(e=>e.id!==t)),j()}}).subscribe(e=>{d("SUBSCRIBED"===e)});return()=>{t.removeChannel(e)}},[t,a,j,C]);let _=(0,r.useCallback)(e=>{var t;let a={duration:"urgent"===e.priority?1e4:"high"===e.priority?6e3:4e3,action:(null===(t=e.actions)||void 0===t?void 0:t[0])?{label:e.actions[0].label,onClick:()=>R(e.id,e.actions[0])}:void 0};switch(e.type){case"success":i.Am.success(e.title,{description:e.message,...a});break;case"error":i.Am.error(e.title,{description:e.message,...a});break;case"warning":i.Am.warning(e.title,{description:e.message,...a});break;default:(0,i.Am)(e.title,{description:e.message,...a})}},[]),Z=(0,r.useCallback)(e=>{try{let t=new Audio;switch(t.volume=.3,e){case"urgent":t.src="/sounds/urgent-notification.mp3";break;case"high":t.src="/sounds/high-notification.mp3";break;default:t.src="/sounds/default-notification.mp3"}t.play().catch(e=>{console.warn("Could not play notification sound:",e)})}catch(e){console.warn("Notification sound not available:",e)}},[]),z=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/notifications/".concat(e,"/read"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")}});if(!t.ok)throw Error("Failed to mark notification as read: ".concat(t.statusText));return h(e=>Math.max(0,e-1)),j(),{success:!0}}catch(e){return console.error("Error marking notification as read:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[j]),A=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/notifications/mark-all-read",{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")}});if(!e.ok)throw Error("Failed to mark all notifications as read: ".concat(e.statusText));return h(0),j(),{success:!0}}catch(e){return console.error("Error marking all notifications as read:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[j]),E=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/notifications/".concat(e,"/archive"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")}});if(!t.ok)throw Error("Failed to archive notification: ".concat(t.statusText));return j(),{success:!0}}catch(e){return console.error("Error archiving notification:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[j]),S=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/notifications/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")}});if(!t.ok)throw Error("Failed to delete notification: ".concat(t.statusText));return j(),{success:!0}}catch(e){return console.error("Error deleting notification:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[j]),R=(0,r.useCallback)(async(e,t)=>{try{if("link"===t.type&&t.url)window.open(t.url,"_blank");else if("button"===t.type){let a=await fetch("/api/notifications/".concat(e,"/action"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")},body:JSON.stringify({action:t.action})});if(!a.ok)throw Error("Failed to execute notification action: ".concat(a.statusText))}return await z(e),{success:!0}}catch(e){return console.error("Error handling notification action:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[z]),T=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/notifications/preferences",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to update preferences: ".concat(t.statusText));return w(),{success:!0}}catch(e){return console.error("Error updating notification preferences:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[w]),I=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/notifications",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token")||"")},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create notification: ".concat(t.statusText));let a=await t.json();return j(),{success:!0,data:a.data}}catch(e){return console.error("Error creating notification:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},[j]),F=(0,r.useCallback)(e=>{x.current=e},[]),P=(0,r.useCallback)(async()=>"Notification"in window&&"granted"===await Notification.requestPermission(),[]),[U,V]=(0,r.useState)(e),B=(0,r.useMemo)(()=>((null==g?void 0:g.data)||[]).map(e=>{var t,a;return{...e,read:"read"===e.status,timestamp:new Date(e.created_at),action_url:null===(a=e.actions)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.url}}),[null==g?void 0:g.data]),O=(0,r.useMemo)(()=>{if(!(null==b?void 0:b.data))return;let e=b.data;return{...e,email_enabled:e.email_notifications,push_enabled:e.push_notifications,email_digest:!1,sound_enabled:!0,render_notifications:e.notification_types.render_complete,system_notifications:e.notification_types.system_maintenance,collaboration_notifications:e.notification_types.collaboration_invite}},[null==b?void 0:b.data]),D=(0,r.useCallback)(async()=>{i.Am.success("All read notifications deleted"),j()},[j]),M=(0,r.useCallback)(async e=>{i.Am.success("Test notification of type ".concat(e," sent"))},[]),Q={notifications:y,preferences:N,combined:!!(y||N)};return{notifications:B,realTimeNotifications:u,preferences:O,stats:null==g?void 0:g.stats,unreadCount:m,isLoading:v||k,error:Q.combined?Error("Failed to load notifications"):void 0,errors:Q,isConnected:c,markAsRead:z,markAllAsRead:A,archiveNotification:E,deleteNotification:S,deleteAllRead:D,handleNotificationAction:R,updatePreferences:T,createNotification:I,toggleSound:F,requestPermission:P,testNotification:M,filters:U,setFilters:V,refreshNotifications:j,refreshPreferences:w}}(),[L,X]=(0,r.useState)("all"),[H,W]=(0,r.useState)(!1),[q,K]=(0,r.useState)(""),[$,G]=(0,r.useState)("all"),[ee,et]=(0,r.useState)("all"),ea=(null==e?void 0:e.filter(e=>!!(("unread"!==L||!e.read)&&("read"!==L||e.read)&&(!q||e.title.toLowerCase().includes(q.toLowerCase())||e.message.toLowerCase().includes(q.toLowerCase())))&&("all"===$||e.type===$)&&("all"===ee||e.priority===ee)))||[],es=async e=>{try{await w(e)}catch(e){i.Am.error("Failed to mark notification as read")}},er=async()=>{try{await k(),i.Am.success("All notifications marked as read")}catch(e){i.Am.error("Failed to mark all notifications as read")}},en=async e=>{try{await C(e),i.Am.success("Notification deleted")}catch(e){i.Am.error("Failed to delete notification")}},ei=async()=>{try{await _(),i.Am.success("All read notifications deleted")}catch(e){i.Am.error("Failed to delete read notifications")}},eo=async e=>{try{await Z(e),i.Am.success("Notification preferences updated")}catch(e){i.Am.error("Failed to update preferences")}},el=async e=>{try{await Q(e),i.Am.success("Test notification sent")}catch(e){i.Am.error("Failed to send test notification")}},ec=e=>{let t=new Date,a=new Date(e),s=Math.floor((t.getTime()-a.getTime())/1e3);return s<60?"Just now":s<3600?"".concat(Math.floor(s/60),"m ago"):s<86400?"".concat(Math.floor(s/3600),"h ago"):s<604800?"".concat(Math.floor(s/86400),"d ago"):a.toLocaleDateString()},ed=e=>{switch(e){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}};return N?(0,s.jsx)(d.Zb,{children:(0,s.jsx)(d.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center text-red-600",children:["Error loading notifications: ",N.message]})})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Notification Center"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Stay updated with smart alerts and system notifications"})]}),t>0&&(0,s.jsxs)(u.C,{variant:"destructive",className:"ml-2",children:[t," unread"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)(c.z,{variant:"outline",onClick:er,disabled:0===t,children:[(0,s.jsx)(z.Z,{className:"mr-2 h-4 w-4"}),"Mark All Read"]}),(0,s.jsxs)(c.z,{variant:"outline",onClick:ei,children:[(0,s.jsx)(A.Z,{className:"mr-2 h-4 w-4"}),"Clear Read"]}),(0,s.jsxs)(p.Vq,{open:H,onOpenChange:W,children:[(0,s.jsx)(p.hg,{asChild:!0,children:(0,s.jsxs)(c.z,{variant:"outline",children:[(0,s.jsx)(E.Z,{className:"mr-2 h-4 w-4"}),"Settings"]})}),(0,s.jsxs)(p.cZ,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(p.fK,{children:[(0,s.jsx)(p.$N,{children:"Notification Preferences"}),(0,s.jsx)(p.Be,{children:"Configure how and when you receive notifications"})]}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Email Notifications"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(S.Z,{className:"h-4 w-4"}),(0,s.jsx)(m._,{htmlFor:"email-enabled",children:"Enable email notifications"})]}),(0,s.jsx)(f.r,{id:"email-enabled",checked:(null==a?void 0:a.email_enabled)||!1,onCheckedChange:e=>eo({...a,email_enabled:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{htmlFor:"email-digest",children:"Daily digest"}),(0,s.jsx)(f.r,{id:"email-digest",checked:(null==a?void 0:a.email_digest)||!1,onCheckedChange:e=>eo({...a,email_digest:e})})]})]})]}),(0,s.jsx)(j.Z,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Push Notifications"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(R.Z,{className:"h-4 w-4"}),(0,s.jsx)(m._,{htmlFor:"push-enabled",children:"Enable push notifications"})]}),(0,s.jsx)(f.r,{id:"push-enabled",checked:(null==a?void 0:a.push_enabled)||!1,onCheckedChange:e=>eo({...a,push_enabled:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(T.Z,{className:"h-4 w-4"}),(0,s.jsx)(m._,{htmlFor:"sound-enabled",children:"Sound alerts"})]}),(0,s.jsx)(f.r,{id:"sound-enabled",checked:(null==a?void 0:a.sound_enabled)||!1,onCheckedChange:e=>eo({...a,sound_enabled:e})})]})]})]}),(0,s.jsx)(j.Z,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Notification Types"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{htmlFor:"render-notifications",children:"Render completion"}),(0,s.jsx)(f.r,{id:"render-notifications",checked:(null==a?void 0:a.render_notifications)||!1,onCheckedChange:e=>eo({...a,render_notifications:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{htmlFor:"system-notifications",children:"System alerts"}),(0,s.jsx)(f.r,{id:"system-notifications",checked:(null==a?void 0:a.system_notifications)||!1,onCheckedChange:e=>eo({...a,system_notifications:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(m._,{htmlFor:"collaboration-notifications",children:"Collaboration updates"}),(0,s.jsx)(f.r,{id:"collaboration-notifications",checked:(null==a?void 0:a.collaboration_notifications)||!1,onCheckedChange:e=>eo({...a,collaboration_notifications:e})})]})]})]}),(0,s.jsx)(j.Z,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Test Notifications"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>el("info"),children:"Test Info"}),(0,s.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>el("success"),children:"Test Success"}),(0,s.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>el("warning"),children:"Test Warning"}),(0,s.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>el("error"),children:"Test Error"})]})]})]}),(0,s.jsx)(p.cN,{children:(0,s.jsx)(c.z,{onClick:()=>W(!1),children:"Close"})})]})]})]})]}),(0,s.jsx)(d.Zb,{children:(0,s.jsx)(d.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-1 items-center space-x-2",children:[(0,s.jsx)(I.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("input",{type:"text",placeholder:"Search notifications...",value:q,onChange:e=>K(e.target.value),className:"flex-1 bg-transparent border-none outline-none placeholder:text-muted-foreground"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(F.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)(x.Ph,{value:$,onValueChange:G,children:[(0,s.jsx)(x.i4,{className:"w-[120px]",children:(0,s.jsx)(x.ki,{placeholder:"Type"})}),(0,s.jsxs)(x.Bw,{children:[(0,s.jsx)(x.Ql,{value:"all",children:"All Types"}),(0,s.jsx)(x.Ql,{value:"info",children:"Info"}),(0,s.jsx)(x.Ql,{value:"success",children:"Success"}),(0,s.jsx)(x.Ql,{value:"warning",children:"Warning"}),(0,s.jsx)(x.Ql,{value:"error",children:"Error"}),(0,s.jsx)(x.Ql,{value:"system",children:"System"}),(0,s.jsx)(x.Ql,{value:"render",children:"Render"})]})]}),(0,s.jsxs)(x.Ph,{value:ee,onValueChange:et,children:[(0,s.jsx)(x.i4,{className:"w-[120px]",children:(0,s.jsx)(x.ki,{placeholder:"Priority"})}),(0,s.jsxs)(x.Bw,{children:[(0,s.jsx)(x.Ql,{value:"all",children:"All Priority"}),(0,s.jsx)(x.Ql,{value:"high",children:"High"}),(0,s.jsx)(x.Ql,{value:"medium",children:"Medium"}),(0,s.jsx)(x.Ql,{value:"low",children:"Low"})]})]})]})]})})}),(0,s.jsxs)(d.Zb,{children:[(0,s.jsx)(d.Ol,{children:(0,s.jsx)(h.mQ,{value:L,onValueChange:X,children:(0,s.jsxs)(h.dr,{className:"grid w-full grid-cols-3",children:[(0,s.jsxs)(h.SP,{value:"all",children:["All (",(null==e?void 0:e.length)||0,")"]}),(0,s.jsxs)(h.SP,{value:"unread",children:["Unread (",t,")"]}),(0,s.jsxs)(h.SP,{value:"read",children:["Read (",((null==e?void 0:e.length)||0)-t,")"]})]})})}),(0,s.jsx)(d.aY,{className:"p-0",children:(0,s.jsx)(y.x,{className:"h-[600px]",children:b?(0,s.jsx)("div",{className:"space-y-4 p-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-4 p-4 animate-pulse",children:[(0,s.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},t))}):0===ea.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(P.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No notifications"}),(0,s.jsx)("p",{className:"mt-2 text-muted-foreground",children:q||"all"!==$||"all"!==ee?"No notifications match your filters":"You're all caught up!"})]}):(0,s.jsx)("div",{className:"divide-y",children:ea.map(e=>{let t=D[e.type]||v.Z,a=M[e.type]||"text-gray-500";return(0,s.jsxs)("div",{className:"flex items-start space-x-4 p-4 hover:bg-muted/50 transition-colors ".concat(e.read?"":"bg-blue-50/50 border-l-4 border-l-blue-500"),children:[(0,s.jsx)("div",{className:"flex-shrink-0 ".concat(a),children:(0,s.jsx)(t,{className:"h-5 w-5"})}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("h4",{className:"text-sm font-medium ".concat(e.read?"":"font-semibold"),children:e.title}),(0,s.jsx)(u.C,{className:"".concat(ed(e.priority)," text-white text-xs"),variant:"secondary",children:e.priority}),!e.read&&(0,s.jsx)("div",{className:"h-2 w-2 bg-blue-500 rounded-full"})]}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground line-clamp-2",children:e.message}),(0,s.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-xs text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(U.Z,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:ec(e.created_at)})]}),e.action_url&&(0,s.jsx)(c.z,{variant:"link",size:"sm",className:"h-auto p-0 text-xs",onClick:()=>window.open(e.action_url,"_blank"),children:"View Details"})]})]}),(0,s.jsxs)(g.h_,{children:[(0,s.jsx)(g.$F,{asChild:!0,children:(0,s.jsx)(c.z,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,s.jsx)(V.Z,{className:"h-4 w-4"})})}),(0,s.jsxs)(g.AW,{align:"end",children:[(0,s.jsx)(g.Ju,{children:"Actions"}),e.read?(0,s.jsxs)(g.Xi,{onClick:()=>es(e.id),children:[(0,s.jsx)(O.Z,{className:"mr-2 h-4 w-4"}),"Mark as unread"]}):(0,s.jsxs)(g.Xi,{onClick:()=>es(e.id),children:[(0,s.jsx)(B.Z,{className:"mr-2 h-4 w-4"}),"Mark as read"]}),(0,s.jsx)(g.VD,{}),(0,s.jsxs)(g.Xi,{onClick:()=>en(e.id),className:"text-red-600",children:[(0,s.jsx)(A.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})})]},e.id)})})})})]})]})}function Y(){return(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(Q,{})})}},27669:function(e,t,a){"use strict";a.d(t,{W:function(){return i}});var s=a(17272);let r=null,n=null;function i(){if(n)return n;let{url:e,anonKey:t}=function(){if(r)return r;let e="https://ofhzrdiadxigrvmrhaiz.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ";if(!e||!t)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return r={url:e,anonKey:t}}();return n=(0,s.createBrowserClient)(e,t)}},58113:function(e,t,a){"use strict";a.d(t,{OQ:function(){return r},eI:function(){return n}});var s=a(27669);let r=(0,s.W)(),n=()=>(0,s.W)()},22835:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var s=a(61994),r=a(53335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}}},function(e){e.O(0,[6137,7479,271,5644,3347,6241,51,4919,7272,926,8577,5184,2232,2971,2117,1744],function(){return e(e.s=57591)}),_N_E=e.O()}]);