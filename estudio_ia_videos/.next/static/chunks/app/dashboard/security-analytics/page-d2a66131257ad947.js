(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4645],{69016:function(e,s,t){Promise.resolve().then(t.bind(t,33265))},34029:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},eW:function(){return u},ll:function(){return c}});var a=t(57437),r=t(2265),l=t(22835);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...r})});n.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,l.cn)("font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})});u.displayName="CardFooter"},51098:function(e,s,t){"use strict";t.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return i},nU:function(){return o}});var a=t(57437),r=t(2265),l=t(20271),n=t(22835);let i=l.fC,c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.aV,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});c.displayName=l.aV.displayName;let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.xz,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});d.displayName=l.xz.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});o.displayName=l.VY.displayName},33265:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Z}});var a=t(57437),r=t(2265),l=t(34029),n=t(51098),i=t(47625),c=t(86810),d=t(10062),o=t(20407),u=t(78155),x=t(77031),m=t(56940),f=t(97059),h=t(62994),j=t(40626),g=t(41671),p=t(76865),b=t(95805),v=t(66337),y=t(88906),N=t(42488),w=t(70525),S=t(58113);function Z(){var e;let s=(0,r.useMemo)(()=>(0,S.eI)(),[]),[t,Z]=(0,r.useState)(null),[C,M]=(0,r.useState)(null),[k,O]=(0,r.useState)(!0),[A,D]=(0,r.useState)("30d"),I=null==t?void 0:null===(e=t.user_metadata)||void 0===e?void 0:e.currentOrgId;(0,r.useEffect)(()=>{let e=!0;(async()=>{try{var t;let{data:a}=await s.auth.getUser();if(!e)return;Z(null!==(t=a.user)&&void 0!==t?t:null)}catch(e){console.error("[SecurityAnalytics] Falha ao carregar usu\xe1rio:",e)}})();let{data:t}=s.auth.onAuthStateChange((s,t)=>{var a;e&&Z(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null)});return()=>{e=!1,null==t||t.subscription.unsubscribe()}},[s]),(0,r.useEffect)(()=>{I&&U()},[I,A]);let U=async()=>{if(I){O(!0);try{let e="7d"===A?7:"30d"===A?30:90,s=new Date,t=new Date;t.setDate(t.getDate()-e);let a=await fetch("/api/org/".concat(I,"/alerts/statistics?")+new URLSearchParams({startDate:t.toISOString(),endDate:s.toISOString()})),r=await a.json(),l={logins:{successful:1250+Math.floor(500*Math.random()),failed:45+Math.floor(50*Math.random()),sso:890+Math.floor(300*Math.random()),successRate:96.5+2*Math.random()},alerts:r.statistics||{total:0,critical:0,high:0,bySeverity:{},byType:{}},usage:{activeUsers:45+Math.floor(20*Math.random()),projects:123+Math.floor(50*Math.random()),renders:456+Math.floor(100*Math.random()),ttsConversions:789+Math.floor(200*Math.random())},sso:{enabled:!0,providers:2,loginsBySso:890}};M(l)}catch(e){console.error("Erro ao carregar estat\xedsticas:",e)}finally{O(!1)}}};if(!t)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("p",{children:"Fa\xe7a login para acessar o dashboard de seguran\xe7a."})});if(k||!C)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});let R={critical:"#991b1b",high:"#ef4444",medium:"#f59e0b",low:"#3b82f6"},Y=[{name:"Bem-sucedidos",value:C.logins.successful,fill:"#10b981"},{name:"Falhados",value:C.logins.failed,fill:"#ef4444"}],E=Object.entries(C.alerts.bySeverity||{}).map(e=>{let[s,t]=e;return{name:s,value:t,fill:R[s]||"#6b7280"}});return(0,a.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDD12 Security & Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Monitoramento avan\xe7ado de seguran\xe7a e uso da plataforma"})]}),(0,a.jsx)("div",{className:"mb-6 flex gap-2",children:["7d","30d","90d"].map(e=>(0,a.jsx)("button",{onClick:()=>D(e),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(A===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"7d"===e?"7 dias":"30d"===e?"30 dias":"90 dias"},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Taxa de Sucesso"}),(0,a.jsx)(g.Z,{className:"h-5 w-5 text-green-600"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:[C.logins.successRate.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[C.logins.successful," logins bem-sucedidos"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Alertas Cr\xedticos"}),(0,a.jsx)(p.Z,{className:"h-5 w-5 text-red-600"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-red-600",children:C.alerts.critical}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[C.alerts.total," alertas no total"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Usu\xe1rios Ativos"}),(0,a.jsx)(b.Z,{className:"h-5 w-5 text-blue-600"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:C.usage.activeUsers}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["\xdaltimos ","7d"===A?7:"30d"===A?30:90," dias"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"SSO Ativo"}),(0,a.jsx)(v.Z,{className:"h-5 w-5 text-purple-600"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:C.sso.providers}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[C.sso.loginsBySso," logins via SSO"]})]})]})]}),(0,a.jsxs)(n.mQ,{defaultValue:"security",className:"space-y-6",children:[(0,a.jsxs)(n.dr,{children:[(0,a.jsx)(n.SP,{value:"security",children:"\uD83D\uDD12 Seguran\xe7a"}),(0,a.jsx)(n.SP,{value:"usage",children:"\uD83D\uDCCA Uso"}),(0,a.jsx)(n.SP,{value:"alerts",children:"\uD83D\uDEA8 Alertas"})]}),(0,a.jsx)(n.nU,{value:"security",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{children:"Logins por Status"})}),(0,a.jsx)(l.aY,{children:(0,a.jsx)(i.h,{width:"100%",height:300,children:(0,a.jsxs)(c.u,{children:[(0,a.jsx)(d.b,{data:Y,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:t}=e;return"".concat(s,": ").concat((100*t).toFixed(0),"%")},outerRadius:100,fill:"#8884d8",dataKey:"value",children:Y.map((e,s)=>(0,a.jsx)(o.b,{fill:e.fill},"cell-".concat(s)))}),(0,a.jsx)(u.u,{})]})})})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{children:"Estat\xedsticas SSO"})}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-900",children:"Status"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:"Ativo"})]}),(0,a.jsx)(y.Z,{className:"h-12 w-12 text-green-600"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Provedores Configurados"}),(0,a.jsx)("span",{className:"font-bold",children:C.sso.providers})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Logins via SSO"}),(0,a.jsx)("span",{className:"font-bold",children:C.sso.loginsBySso})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Taxa de uso SSO"}),(0,a.jsxs)("span",{className:"font-bold",children:[(C.sso.loginsBySso/C.logins.successful*100).toFixed(1),"%"]})]})]})]})]})]})}),(0,a.jsx)(n.nU,{value:"usage",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{children:"Atividade da Plataforma"})}),(0,a.jsx)(l.aY,{children:(0,a.jsx)(i.h,{width:"100%",height:300,children:(0,a.jsxs)(x.v,{data:[{name:"Projetos",value:C.usage.projects},{name:"Renders",value:C.usage.renders},{name:"TTS",value:C.usage.ttsConversions}],children:[(0,a.jsx)(m.q,{strokeDasharray:"3 3"}),(0,a.jsx)(f.K,{dataKey:"name"}),(0,a.jsx)(h.B,{}),(0,a.jsx)(u.u,{}),(0,a.jsx)(j.$,{dataKey:"value",fill:"#3b82f6"})]})})})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{children:"M\xe9tricas de Uso"})}),(0,a.jsx)(l.aY,{className:"space-y-4",children:[{label:"Usu\xe1rios Ativos",value:C.usage.activeUsers,icon:b.Z},{label:"Projetos",value:C.usage.projects,icon:N.Z},{label:"Renders",value:C.usage.renders,icon:w.Z},{label:"TTS",value:C.usage.ttsConversions,icon:N.Z}].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(e.icon,{className:"h-5 w-5 text-gray-600"}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]}),(0,a.jsx)("span",{className:"text-xl font-bold",children:e.value})]},s))})]})]})}),(0,a.jsx)(n.nU,{value:"alerts",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[E.length>0&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{children:"Alertas por Severidade"})}),(0,a.jsx)(l.aY,{children:(0,a.jsx)(i.h,{width:"100%",height:300,children:(0,a.jsxs)(c.u,{children:[(0,a.jsx)(d.b,{data:E,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:t}=e;return"".concat(s,": ").concat((100*t).toFixed(0),"%")},outerRadius:100,fill:"#8884d8",dataKey:"value",children:E.map((e,s)=>(0,a.jsx)(o.b,{fill:e.fill},"cell-".concat(s)))}),(0,a.jsx)(u.u,{})]})})})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{children:"Resumo de Alertas"})}),(0,a.jsxs)(l.aY,{className:"space-y-3",children:[Object.entries(C.alerts.bySeverity||{}).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg",style:{backgroundColor:R[s]+"20"},children:[(0,a.jsx)("span",{className:"font-medium capitalize",children:s}),(0,a.jsx)("span",{className:"text-xl font-bold",children:t})]},s)}),0===Object.keys(C.alerts.bySeverity||{}).length&&(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(g.Z,{className:"h-12 w-12 text-green-600 mx-auto mb-2"}),(0,a.jsx)("p",{children:"Nenhum alerta no per\xedodo selecionado"})]})]})]})]})})]})]})}},27669:function(e,s,t){"use strict";t.d(s,{W:function(){return n}});var a=t(17272);let r=null,l=null;function n(){if(l)return l;let{url:e,anonKey:s}=function(){if(r)return r;let e="https://ofhzrdiadxigrvmrhaiz.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ";if(!e||!s)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return r={url:e,anonKey:s}}();return l=(0,a.createBrowserClient)(e,s)}},58113:function(e,s,t){"use strict";t.d(s,{OQ:function(){return r},eI:function(){return l}});var a=t(27669);let r=(0,a.W)(),l=()=>(0,a.W)()},22835:function(e,s,t){"use strict";t.d(s,{cn:function(){return l}});var a=t(61994),r=t(53335);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}},42488:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},41671:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},66337:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},88906:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},76865:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},95805:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[6137,7479,271,4919,7272,3310,7711,2971,2117,1744],function(){return e(e.s=69016)}),_N_E=e.O()}]);