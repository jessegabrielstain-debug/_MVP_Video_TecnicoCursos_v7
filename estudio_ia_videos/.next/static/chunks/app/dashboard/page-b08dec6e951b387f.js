(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{21860:function(e,s,a){Promise.resolve().then(a.bind(a,75362))},47778:function(e,s,a){"use strict";a.d(s,{O:function(){return l}});var t=a(57437),r=a(22835);function l(e){let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",s),...a})}},75362:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return T}});var t=a(57437),r=a(34029),l=a(41875),i=a(47778),o=a(92595),n=a(70525),c=a(99397),d=a(49322),u=a(82431),m=a(56475),h=a(33276),x=a(11239),j=a(94766),p=a(77086),g=a(2980);let f=async e=>{try{let s=await fetch(e,{credentials:"include"});if(!s.ok){if(401===s.status)return null;throw Error("HTTP ".concat(s.status))}return await s.json()}catch(e){return null}};var v=a(91723),b=a(71533),N=a(39795),w=a(66916),y=a(33145);function C(){return(0,t.jsx)(r.Zb,{children:(0,t.jsxs)(r.aY,{className:"p-0",children:[(0,t.jsx)(i.O,{className:"h-[200px] w-full rounded-t-lg"}),(0,t.jsxs)("div",{className:"p-4 space-y-2",children:[(0,t.jsx)(i.O,{className:"h-4 w-[180px]"}),(0,t.jsx)(i.O,{className:"h-3 w-[120px]"}),(0,t.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,t.jsx)(i.O,{className:"h-8 w-20"}),(0,t.jsx)(i.O,{className:"h-8 w-20"})]})]})]})})}var E=a(27648);function A(e){let{loading:s,projects:a=[]}=e;return s?(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Projetos Recentes"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((e,s)=>(0,t.jsx)(C,{},s))})]}):0===a.length?(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Projetos Recentes"}),(0,t.jsx)(r.Zb,{children:(0,t.jsxs)(r.aY,{className:"p-12 text-center",children:[(0,t.jsx)("div",{className:"mx-auto w-24 h-24 mb-4 rounded-full bg-muted flex items-center justify-center",children:(0,t.jsx)(h.Z,{className:"h-12 w-12 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Nenhum projeto ainda"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"Comece criando seu primeiro v\xeddeo de treinamento"}),(0,t.jsx)(o.z,{asChild:!0,children:(0,t.jsx)(E.default,{href:"/editor-canvas",prefetch:!1,children:"Criar Primeiro V\xeddeo"})})]})})]}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"Projetos Recentes"}),(0,t.jsx)(o.z,{variant:"ghost",asChild:!0,children:(0,t.jsx)(E.default,{href:"/dashboard/projects",children:"Ver todos"})})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.slice(0,6).map(e=>(0,t.jsx)(r.Zb,{className:"group hover:shadow-lg transition-shadow",children:(0,t.jsxs)(r.aY,{className:"p-0",children:[(0,t.jsxs)("div",{className:"relative aspect-video bg-muted rounded-t-lg overflow-hidden",children:[e.thumbnail?(0,t.jsx)(y.default,{src:e.thumbnail,alt:e.title,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-300"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(h.Z,{className:"h-12 w-12 text-muted-foreground"})}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:(0,t.jsx)(o.z,{size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity",asChild:!0,children:(0,t.jsx)(E.default,{href:"/editor-canvas?project=".concat(e.id),prefetch:!1,children:(0,t.jsx)(h.Z,{className:"h-5 w-5"})})})}),(0,t.jsx)("div",{className:"absolute top-2 right-2",children:(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("completed"===e.status?"bg-green-500 text-white":"processing"===e.status?"bg-blue-500 text-white":"bg-yellow-500 text-white"),children:"completed"===e.status?"Completo":"processing"===e.status?"Processando":"Rascunho"})})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"font-medium line-clamp-1 mb-2",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(v.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:(0,N.Q)(new Date(e.updatedAt),{addSuffix:!0,locale:w.F})})]}),(0,t.jsx)(o.z,{size:"icon",variant:"ghost",className:"h-8 w-8",children:(0,t.jsx)(b.Z,{className:"h-4 w-4"})})]})]})]})},e.id))})]})}var Z=a(57318),k=a(84544),P=a(82023),S=a(48736),O=a(92369),z=a(64372);function _(){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[60vh] space-y-8 text-center animate-in fade-in duration-500",children:[(0,t.jsxs)("div",{className:"space-y-2 max-w-2xl",children:[(0,t.jsx)("div",{className:"mx-auto w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mb-6",children:(0,t.jsx)(P.Z,{className:"h-10 w-10 text-primary"})}),(0,t.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"Bem-vindo ao seu Est\xfadio de V\xeddeo IA"}),(0,t.jsx)("p",{className:"text-xl text-muted-foreground",children:"Voc\xea ainda n\xe3o tem projetos. Crie v\xeddeos profissionais a partir de apresenta\xe7\xf5es, textos ou avatares em minutos."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-4xl px-4",children:[(0,t.jsx)(r.Zb,{className:"border-muted/60 hover:border-primary/50 transition-colors bg-card/50 backdrop-blur-sm",children:(0,t.jsxs)(r.aY,{className:"p-6 flex flex-col items-center text-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-full",children:(0,t.jsx)(S.Z,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"PPTX para V\xeddeo"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Importe slides e gere narra\xe7\xe3o autom\xe1tica."})]})]})}),(0,t.jsx)(r.Zb,{className:"border-muted/60 hover:border-primary/50 transition-colors bg-card/50 backdrop-blur-sm",children:(0,t.jsxs)(r.aY,{className:"p-6 flex flex-col items-center text-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-full",children:(0,t.jsx)(O.Z,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Avatares IA"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Avatares realistas que falam seu texto."})]})]})}),(0,t.jsx)(r.Zb,{className:"border-muted/60 hover:border-primary/50 transition-colors bg-card/50 backdrop-blur-sm",children:(0,t.jsxs)(r.aY,{className:"p-6 flex flex-col items-center text-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-full",children:(0,t.jsx)(z.Z,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Editor Completo"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Controle total na timeline."})]})]})})]}),(0,t.jsxs)("div",{className:"pt-4",children:[(0,t.jsx)(k.p,{trigger:(0,t.jsxs)(o.z,{size:"lg",className:"h-14 px-8 text-lg shadow-lg hover:shadow-xl transition-all bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[(0,t.jsx)(z.Z,{className:"mr-2 h-5 w-5"}),"Criar Primeiro Projeto Agora"]})}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-4",children:["Precisa de ajuda? Confira o ",(0,t.jsx)("span",{className:"underline decoration-dotted cursor-help",title:"Clique no \xedcone de ajuda na barra lateral",children:"Guia do Usu\xe1rio"})," na barra lateral."]})]})]})}var I=a(2265);function R(e){let{title:s,value:a,subtitle:l,icon:o,loading:c,trend:d,testId:u}=e;return(0,t.jsxs)(r.Zb,{"data-testid":u,className:"hover:shadow-md transition-shadow",children:[(0,t.jsxs)(r.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(r.ll,{className:"text-sm font-medium text-muted-foreground",children:s}),(0,t.jsx)(o,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsx)(r.aY,{children:c?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.O,{className:"h-8 w-20"}),(0,t.jsx)(i.O,{className:"h-3 w-24"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:a}),d&&(0,t.jsxs)("span",{className:"text-xs flex items-center ".concat(d.positive?"text-green-600":"text-red-600"),children:[(0,t.jsx)(n.Z,{className:"h-3 w-3 mr-0.5 ".concat(!d.positive&&"rotate-180")}),d.value,"%"]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:l})]})})]})}function T(){let{stats:e,isLoading:s,isError:a}=function(){let{user:e,loading:s}=(0,g.a)(),{data:a,error:t,isLoading:r}=(0,p.ZP)(e?"/api/dashboard/unified-stats":null,f,{refreshInterval:3e4,revalidateOnFocus:!1,revalidateOnReconnect:!0,shouldRetryOnError:!1,errorRetryCount:0,isPaused:()=>s||!e});return{stats:a,isLoading:r,isError:t}}(),{projects:n,isLoading:v}=(0,Z.Z0)({limit:6,sortBy:"updated_at",sortOrder:"desc"}),b=!s&&(null==e?void 0:e.totalProjects)===0&&!v&&0===n.length,N=(0,I.useMemo)(()=>n.map(e=>({id:e.id,title:e.name,thumbnail:e.thumbnail_url,updatedAt:new Date(e.updated_at),status:e.status})),[n]),w=(0,I.useCallback)(e=>{let s={healthy:{className:"bg-green-500",label:"Saud\xe1vel"},warning:{className:"bg-yellow-500",label:"Aten\xe7\xe3o"},error:{className:"bg-red-500",label:"Cr\xedtico"},default:{className:"bg-gray-500",label:"Desconhecido"}},{className:a,label:r}=s[e]||s.default;return(0,t.jsx)(l.C,{className:a,children:r})},[]);return b?(0,t.jsx)(_,{}):(0,t.jsxs)("div",{className:"space-y-6 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Bem-vindo de volta! Aqui est\xe1 um resumo dos seus projetos."})]}),(0,t.jsx)(k.p,{trigger:(0,t.jsxs)(o.z,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg",children:[(0,t.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Criar Projeto"]})})]}),a&&(0,t.jsx)(r.Zb,{className:"border-yellow-200 bg-yellow-50",children:(0,t.jsxs)(r.aY,{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)(d.Z,{className:"h-5 w-5 text-yellow-600"}),(0,t.jsx)("p",{className:"text-sm text-yellow-800",children:"N\xe3o foi poss\xedvel carregar as estat\xedsticas. Alguns dados podem estar desatualizados."}),(0,t.jsxs)(o.z,{variant:"ghost",size:"sm",className:"ml-auto",onClick:()=>window.location.reload(),children:[(0,t.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),"Tentar novamente"]})]})}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsx)(R,{testId:"dashboard-card-total-projects",title:"Total de Projetos",value:(null==e?void 0:e.totalProjects)||0,subtitle:"Projetos ativos",icon:m.Z,loading:s}),(0,t.jsx)(R,{testId:"dashboard-card-active-renders",title:"Renders Ativos",value:(null==e?void 0:e.activeRenders)||0,subtitle:"".concat((null==e?void 0:e.completedToday)||0," conclu\xeddos hoje"),icon:h.Z,loading:s}),(0,t.jsx)(R,{testId:"dashboard-card-total-views",title:"Visualiza\xe7\xf5es",value:(null==e?void 0:e.totalViews)||0,subtitle:"Em todos os projetos",icon:x.Z,loading:s}),(0,t.jsx)(R,{testId:"dashboard-card-avg-render-time",title:"Tempo M\xe9dio de Render",value:"".concat((null==e?void 0:e.avgRenderTime)||0,"m"),subtitle:"\xdaltimos 10 jobs",icon:j.Z,loading:s})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(r.Zb,{className:"col-span-2 md:col-span-1",children:[(0,t.jsx)(r.Ol,{className:"flex flex-row items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(r.ll,{children:"Projetos Recentes"}),(0,t.jsx)(r.SZ,{children:"Seus \xfaltimos projetos de v\xeddeo"})]})}),(0,t.jsx)(r.aY,{children:(0,t.jsx)(A,{loading:v,projects:N})})]}),(0,t.jsxs)(r.Zb,{className:"col-span-2 md:col-span-1",children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsx)(r.ll,{children:"Status do Sistema"}),(0,t.jsx)(r.SZ,{children:"Sa\xfade e performance atual"})]}),(0,t.jsx)(r.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Sa\xfade Geral"}),s?(0,t.jsx)(i.O,{className:"h-5 w-20"}):w(null==e?void 0:e.systemHealth)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Servi\xe7os de API"}),(0,t.jsx)(l.C,{className:"bg-green-500",children:"Online"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Banco de Dados"}),(0,t.jsx)(l.C,{className:"bg-green-500",children:"Conectado"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Fila de Render"}),(0,t.jsx)(l.C,{className:"bg-green-500",children:"Ativa"})]})]})})]})]})]})}},2980:function(e,s,a){"use strict";a.d(s,{AuthProvider:function(){return N},a:function(){return w}});var t=a(57437),r=a(2265),l=a(99376),i=a(69064),o=a(27669);let n=()=>(0,o.W)(),c=e=>{let s=window.location.origin.replace(/\/$/,"");return"".concat(s).concat(e)},d={role:"user",metadata:{}};async function u(e,s){let a=n(),{data:t,error:r}=await a.auth.signInWithPassword({email:e,password:s});if(r)throw Error(r.message);return t}async function m(e,s,a){let t=n(),{data:r,error:l}=await t.auth.signUp({email:e,password:s,options:{data:{full_name:a},emailRedirectTo:c("/auth/callback")}});if(l)throw Error(l.message);return r}async function h(){let e=n(),{error:s}=await e.auth.signOut();if(s)throw Error(s.message)}async function x(e){let s=n(),{error:a}=await s.auth.resetPasswordForEmail(e,{redirectTo:c("/auth/reset-password")});if(a)throw Error(a.message)}async function j(e){let s=n(),{error:a}=await s.auth.updateUser({password:e});if(a)throw Error(a.message)}async function p(e){let s=n(),{data:a,error:t}=await s.from("users").select("*").eq("id",e).single();if(t){let e=(t.message||"").toLowerCase();return"PGRST116"===t.code||e.includes("no rows")||e.includes("jwt expired")||"PGRST303"===t.code||console.error("Error fetching user profile:",t),null}return a}async function g(e,s){let a=await p(e);if(a)return a;let t=n(),r=new Date().toISOString(),{data:l,error:i}=await t.from("users").insert({id:e,email:s,...d,created_at:r,updated_at:r}).select().single();if(i){let a=(i.message||"").toLowerCase();if(a.includes("could not find the 'role' column")||a.includes("column role")){let{data:a,error:l}=await t.from("users").insert({id:e,email:s,created_at:r,updated_at:r}).select().single();if(l)throw Error(l.message);return a}throw Error(i.message)}return l}async function f(){let e=n(),{error:s}=await e.auth.signInWithOAuth({provider:"google",options:{redirectTo:c("/auth/callback")}});if(s)throw Error(s.message)}async function v(){let e=n(),{error:s}=await e.auth.signInWithOAuth({provider:"github",options:{redirectTo:c("/auth/callback")}});if(s)throw Error(s.message)}let b=(0,r.createContext)(void 0);function N(e){var s,a;let{children:o}=e,[c,d]=(0,r.useState)(null),[N,w]=(0,r.useState)(null),[y,C]=(0,r.useState)(null),[E,A]=(0,r.useState)(!0),[Z,k]=(0,r.useState)(null),P=(0,l.useRouter)(),S=n();(0,r.useEffect)(()=>{(async()=>{try{var e;let{data:{session:s}}=await S.auth.getSession();if(C(s),d(null!==(e=null==s?void 0:s.user)&&void 0!==e?e:null),null==s?void 0:s.user){let e=await p(s.user.id);if(e)w(e);else{let e=await g(s.user.id,s.user.email);w(e)}}}catch(s){console.error("Error initializing auth:",s);let e=s instanceof Error?s.message:String(s);if(k(e),e&&e.toLowerCase().includes("jwt expired")){try{await S.auth.signOut()}catch(e){}let e=encodeURIComponent(window.location.pathname+window.location.search);P.push("/login?reason=unauthorized&redirect=".concat(e))}}finally{A(!1)}})()},[]),(0,r.useEffect)(()=>{let{data:{subscription:e}}=S.auth.onAuthStateChange(async(e,s)=>{var a;if(console.log("Auth state changed:",e),C(s),d(null!==(a=null==s?void 0:s.user)&&void 0!==a?a:null),null==s?void 0:s.user){let e=await p(s.user.id);e?w(e):w(await g(s.user.id,s.user.email))}else w(null);"SIGNED_IN"===e||"SIGNED_OUT"===e&&(i.Am.success("Logout realizado com sucesso!"),P.push("/login"))});return()=>{e.unsubscribe()}},[P]);let O=(0,r.useCallback)(async(e,s)=>{A(!0),k(null);try{await u(e,s)}catch(s){let e=s instanceof Error?s.message:"Erro ao fazer login";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),z=(0,r.useCallback)(async(e,s,a)=>{A(!0),k(null);try{await m(e,s,a),i.Am.success("Conta criada! Verifique seu email.")}catch(s){let e=s instanceof Error?s.message:"Erro ao criar conta";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),_=(0,r.useCallback)(async()=>{A(!0),k(null);try{await h()}catch(s){let e=s instanceof Error?s.message:"Erro ao fazer logout";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),I=(0,r.useCallback)(async()=>{A(!0),k(null);try{await f()}catch(s){let e=s instanceof Error?s.message:"Erro ao fazer login com Google";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),R=(0,r.useCallback)(async()=>{A(!0),k(null);try{await v()}catch(s){let e=s instanceof Error?s.message:"Erro ao fazer login com GitHub";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),T=(0,r.useCallback)(async e=>{A(!0),k(null);try{await x(e),i.Am.success("Email de recupera\xe7\xe3o enviado!")}catch(s){let e=s instanceof Error?s.message:"Erro ao solicitar reset";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),D=(0,r.useCallback)(async e=>{A(!0),k(null);try{await j(e),i.Am.success("Senha atualizada com sucesso!")}catch(s){let e=s instanceof Error?s.message:"Erro ao atualizar senha";throw k(e),i.Am.error(e),s}finally{A(!1)}},[]),V=(0,r.useCallback)(async()=>{if(c)try{let e=await p(c.id);e&&w(e)}catch(e){console.error("Error refreshing profile:",e)}},[c]),Y={user:c,profile:N,session:y,loading:E,error:Z,signIn:O,signUp:z,signOut:_,signInWithGoogle:I,signInWithGithub:R,resetPassword:T,updatePassword:D,refreshProfile:V,isAdmin:(null==N?void 0:N.role)==="admin",isPro:(null==N?void 0:null===(s=N.metadata)||void 0===s?void 0:s.subscription_tier)==="pro",isEnterprise:(null==N?void 0:null===(a=N.metadata)||void 0===a?void 0:a.subscription_tier)==="enterprise"};return(0,t.jsx)(b.Provider,{value:Y,children:o})}function w(){let e=(0,r.useContext)(b);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},84544:function(e,s,a){"use strict";a.d(s,{p:function(){return g}});var t=a(57437),r=a(2265),l=a(99376),i=a(3805),o=a(92595),n=a(81973),c=a(46393),d=a(58113),u=a(89291),m=a(48736),h=a(92369),x=a(51817),j=a(14438),p=a(22835);function g(e){let{trigger:s,open:a,onOpenChange:g}=e,[f,v]=(0,r.useState)(""),[b,N]=(0,r.useState)("custom"),[w,y]=(0,r.useState)(!1),[C,E]=(0,r.useState)(!1),A=(0,l.useRouter)(),Z=(0,d.eI)(),k=void 0!==a,P=k?g:E,S=async()=>{if(!f.trim()){j.Am.error("Por favor, digite um nome para o projeto");return}y(!0);try{let{data:{user:e}}=await Z.auth.getUser();if(!e){j.Am.error("Voc\xea precisa estar logado para criar um projeto");return}let{data:s,error:a}=await Z.from("projects").insert({name:f,type:b,user_id:e.id,status:"draft",thumbnail_url:"/placeholder-project.jpg",render_settings:{},updated_at:new Date().toISOString()}).select("id, type").single();if(a)throw a;j.Am.success("Projeto criado com sucesso!"),null==P||P(!1),v(""),"pptx"===b?A.push("/editor/pptx/".concat(s.id)):"talking-photo"===b?A.push("/editor/avatars/".concat(s.id)):A.push("/editor/timeline/".concat(s.id)),A.refresh()}catch(e){console.error("Error creating project:",e),j.Am.error("Falha ao criar projeto")}finally{y(!1)}},O=[{id:"custom",label:"Criar do Zero",description:"Editor de v\xeddeo completo com timeline",icon:u.Z},{id:"pptx",label:"Importar PPTX",description:"Converta seus slides em v\xeddeo",icon:m.Z},{id:"talking-photo",label:"Avatar Falante",description:"D\xea vida a fotos com IA",icon:h.Z}];return(0,t.jsxs)(i.Vq,{open:k?a:C,onOpenChange:P,children:[s&&(0,t.jsx)(i.hg,{asChild:!0,children:s}),(0,t.jsxs)(i.cZ,{className:"sm:max-w-[600px]",children:[(0,t.jsxs)(i.fK,{children:[(0,t.jsx)(i.$N,{children:"Novo Projeto"}),(0,t.jsx)(i.Be,{children:"Escolha como voc\xea quer come\xe7ar seu v\xeddeo."})]}),(0,t.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(c._,{htmlFor:"name",children:"Nome do Projeto"}),(0,t.jsx)(n.I,{id:"name",value:f,onChange:e=>v(e.target.value),placeholder:"Ex: Treinamento de Seguran\xe7a",className:"text-lg"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(c._,{children:"Tipo de Projeto"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-4",children:O.map(e=>{let s=e.icon,a=b===e.id;return(0,t.jsxs)("div",{onClick:()=>N(e.id),className:(0,p.cn)("cursor-pointer rounded-xl border-2 p-4 hover:bg-accent hover:text-accent-foreground transition-all",a?"border-primary bg-primary/5":"border-muted bg-card"),children:[(0,t.jsx)(s,{className:(0,p.cn)("mb-3 h-6 w-6",a?"text-primary":"text-muted-foreground")}),(0,t.jsx)("div",{className:"font-semibold leading-none tracking-tight mb-1",children:e.label}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground leading-snug",children:e.description})]},e.id)})})]})]}),(0,t.jsxs)(i.cN,{children:[(0,t.jsx)(o.z,{variant:"ghost",onClick:()=>null==P?void 0:P(!1),disabled:w,children:"Cancelar"}),(0,t.jsxs)(o.z,{onClick:S,disabled:w,children:[w&&(0,t.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Criar Projeto"]})]})]})]})}}},function(e){e.O(0,[6137,5644,3347,4919,7272,2972,9064,1787,4986,8577,9795,3812,5166,2971,2117,1744],function(){return e(e.s=21860)}),_N_E=e.O()}]);