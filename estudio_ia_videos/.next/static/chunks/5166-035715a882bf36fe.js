"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5166],{41875:function(e,t,r){r.d(t,{C:function(){return s}});var a=r(57437);r(2265);var n=r(90535),o=r(22835);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function s(e){let{className:t,variant:r,...n}=e;return(0,a.jsx)("div",{className:(0,o.cn)(i({variant:r}),t),...n})}},92595:function(e,t,r){r.d(t,{d:function(){return s},z:function(){return l}});var a=r(57437),n=r(2265),o=r(90535),i=r(22835);let s=(0,o.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,size:o,asChild:l=!1,...d}=e;return(0,a.jsx)(l?"span":"button",{className:(0,i.cn)(s({variant:n,size:o,className:r})),ref:t,...d})});l.displayName="Button"},34029:function(e,t,r){r.d(t,{Ol:function(){return s},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var a=r(57437),n=r(2265),o=r(22835);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...n})});i.displayName="Card";let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...n})});s.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},3805:function(e,t,r){r.d(t,{$N:function(){return g},Be:function(){return y},Vq:function(){return l},cN:function(){return m},cZ:function(){return f},fK:function(){return p},hg:function(){return d}});var a=r(57437),n=r(2265),o=r(49027),i=r(32489),s=r(22835);let l=o.fC,d=o.xz,c=o.h_;o.x8;let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.aV,{ref:t,className:(0,s.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n})});u.displayName=o.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:r,children:n,...l}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(o.VY,{ref:t,className:(0,s.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...l,children:[n,(0,a.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=o.VY.displayName;let p=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};p.displayName="DialogHeader";let m=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,s.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};m.displayName="DialogFooter";let g=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.Dx,{ref:t,className:(0,s.cn)("text-lg font-semibold leading-none tracking-tight",r),...n})});g.displayName=o.Dx.displayName;let y=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.dk,{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})});y.displayName=o.dk.displayName},81973:function(e,t,r){r.d(t,{I:function(){return i}});var a=r(57437),n=r(2265),o=r(22835);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,a.jsx)("input",{type:n,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},46393:function(e,t,r){r.d(t,{_:function(){return d}});var a=r(57437),n=r(2265),o=r(6394),i=r(90535),s=r(22835);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.f,{ref:t,className:(0,s.cn)(l(),r),...n})});d.displayName=o.f.displayName},57318:function(e,t,r){r.d(t,{Z0:function(){return s}});var a=r(2265),n=r(77086),o=r(58113),i=r(14438);function s(e,t){var r;let{page:s=1,limit:d=20,realtime:c=!0}=t||{},u=null!==(r=null==e?void 0:e.limit)&&void 0!==r?r:d,[f,p]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),[y,b]=(0,a.useState)(!1),[h,v]=(0,a.useState)([]),w=async()=>{let{data:{user:t}}=await o.OQ.auth.getUser();if(!t)throw Error("User not authenticated");let r=o.OQ.from("projects").select("*").eq("user_id",t.id);(null==e?void 0:e.type)&&(r=r.eq("type",e.type)),(null==e?void 0:e.status)&&(r=r.eq("status",e.status)),(null==e?void 0:e.search)&&(r=r.or("name.ilike.%".concat(e.search,"%,description.ilike.%").concat(e.search,"%"))),(null==e?void 0:e.category)&&(r=r.eq("metadata->>category",e.category)),(null==e?void 0:e.priority)&&(r=r.eq("metadata->>priority",e.priority)),(null==e?void 0:e.dateRange)&&(r=r.gte("created_at",e.dateRange.start).lte("created_at",e.dateRange.end));let a=(null==e?void 0:e.sortBy)||"updated_at",n=(null==e?void 0:e.sortOrder)||"desc";r=r.order(a,{ascending:"asc"===n});let i=(s-1)*u;r=r.range(i,i+u-1);let{data:l,error:d,count:c}=await r;if(d)throw d;let f=Array.isArray(l)?l:[];return(null==e?void 0:e.tags)&&e.tags.length>0&&(f=f.filter(t=>{var r;let a=(null===(r=t.metadata)||void 0===r?void 0:r.tags)||[];return e.tags.some(e=>a.includes(e))})),{projects:f,total:c||0,page:s,limit:u,hasMore:(c||0)>s*u}},{data:x,error:j,isLoading:N,mutate:_}=(0,n.ZP)(["projects",e,s,u],w,{revalidateOnFocus:!1,revalidateOnReconnect:!0,dedupingInterval:5e3,errorRetryCount:3,errorRetryInterval:1e3});(0,a.useEffect)(()=>{if(!c)return;let e=o.OQ.channel("projects_realtime").on("postgres_changes",{event:"*",schema:"public",table:"projects"},e=>{console.log("Project realtime update:",e),_(),"INSERT"===e.eventType?i.Am.success("New project created"):"UPDATE"===e.eventType?i.Am.info("Project updated"):"DELETE"===e.eventType&&i.Am.info("Project deleted")}).subscribe();return()=>{o.OQ.removeChannel(e)}},[c,_]);let C=(0,a.useCallback)(async e=>{p(!0);try{let{data:{user:t}}=await o.OQ.auth.getUser();if(!t)throw Error("User not authenticated");let r={tags:[],category:"general",priority:"medium",...e.metadata},{data:a,error:n}=await o.OQ.from("projects").insert({name:e.name,type:e.type,description:e.description,user_id:t.id,owner_id:t.id,status:"draft",metadata:r,current_version:"1.0.0",is_template:e.is_template||!1,is_public:e.is_public||!1,collaboration_enabled:e.collaboration_enabled||!1,render_settings:e.render_settings||{},last_accessed_at:new Date().toISOString()}).select().single();if(n)throw n;return await _(),i.Am.success("Project created successfully"),a}catch(e){throw console.error("Error creating project:",e),i.Am.error("Failed to create project"),e}finally{p(!1)}},[_]),E=(0,a.useCallback)(async(e,t)=>{g(!0);try{let{data:{user:r}}=await o.OQ.auth.getUser();if(!r)throw Error("User not authenticated");let{data:a}=await o.OQ.from("projects").select("*").eq("id",e).single();if(!a)throw Error("Project not found");let n={...a.metadata,...t.metadata},{data:s,error:d}=await o.OQ.from("projects").update({...t,metadata:n,render_settings:t.render_settings,updated_at:new Date().toISOString(),last_accessed_at:new Date().toISOString()}).eq("id",e).select().single();if(d)throw d;if(t.name||t.description||t.metadata){let t=await l(e);await o.OQ.from("projects").update({current_version:t}).eq("id",e)}return await _(),i.Am.success("Project updated successfully"),s}catch(e){throw console.error("Error updating project:",e),i.Am.error("Failed to update project"),e}finally{g(!1)}},[_]),O=(0,a.useCallback)(async e=>{b(!0);try{let{error:t}=await o.OQ.from("projects").delete().eq("id",e);if(t)throw t;await _(),i.Am.success("Project deleted successfully")}catch(e){throw console.error("Error deleting project:",e),i.Am.error("Failed to delete project"),e}finally{b(!1)}},[_]),k=(0,a.useCallback)(async(e,t)=>{try{let{data:{user:r}}=await o.OQ.auth.getUser();if(!r)throw Error("User not authenticated");let{data:a}=await o.OQ.from("projects").select("*").eq("id",e).single();if(!a)throw Error("Project not found");return await C({name:t||"".concat(a.name," (Copy)"),type:a.type,description:a.description||void 0,metadata:a.metadata,is_template:a.is_template,is_public:!1,collaboration_enabled:a.collaboration_enabled,render_settings:a.render_settings||{}})}catch(e){throw console.error("Error duplicating project:",e),i.Am.error("Failed to duplicate project"),e}},[C]),I=(0,a.useCallback)(async e=>{await E(e,{status:"archived"})},[E]),A=(0,a.useCallback)(async e=>{await E(e,{status:"draft"})},[E]),Q=(0,a.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"viewer";try{let{data:{user:a}}=await o.OQ.auth.getUser();if(!a)throw Error("User not authenticated");let{data:n}=await o.OQ.from("users").select("id").eq("email",t).single();if(!n)throw Error("User not found");let{data:s}=await o.OQ.from("projects").select("metadata").eq("id",e).single(),l=(null==s?void 0:s.metadata)||{},d=l.collaborators||[];d.push({user_id:n.id,role:r,invited_by:a.id,joined_at:new Date().toISOString()});let{error:c}=await o.OQ.from("projects").update({metadata:{...l,collaborators:d}}).eq("id",e);if(c)throw c;await _(),i.Am.success("Collaborator added successfully")}catch(e){throw console.error("Error adding collaborator:",e),i.Am.error("Failed to add collaborator"),e}},[_]),R=(0,a.useCallback)(async e=>{try{let{data:t,error:r}=await o.OQ.rpc("get_project_analytics",{project_id:e});if(r)throw r;return t}catch(e){throw console.error("Error getting project analytics:",e),e}},[]);return{projects:Array.isArray(null==x?void 0:x.projects)?x.projects:[],total:(null==x?void 0:x.total)||0,hasMore:(null==x?void 0:x.hasMore)||!1,isLoading:N,isCreating:f,isUpdating:m,isDeleting:y,error:j,createProject:C,updateProject:E,deleteProject:O,duplicateProject:k,archiveProject:I,restoreProject:A,addCollaborator:Q,getProjectAnalytics:R,refresh:_}}async function l(e){let t=Date.now();return"1.0.".concat(t%1e3)}},27669:function(e,t,r){r.d(t,{W:function(){return i}});var a=r(17272);let n=null,o=null;function i(){if(o)return o;let{url:e,anonKey:t}=function(){if(n)return n;let e="https://ofhzrdiadxigrvmrhaiz.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ";if(!e||!t)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return n={url:e,anonKey:t}}();return o=(0,a.createBrowserClient)(e,t)}},58113:function(e,t,r){r.d(t,{OQ:function(){return n},eI:function(){return o}});var a=r(27669);let n=(0,a.W)(),o=()=>(0,a.W)()},22835:function(e,t,r){r.d(t,{cn:function(){return o}});var a=r(61994),n=r(53335);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}}}]);