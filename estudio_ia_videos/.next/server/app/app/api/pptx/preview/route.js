"use strict";(()=>{var e={};e.id=9061,e.ids=[9061],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},17702:e=>{e.exports=require("events")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},67270:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>g,staticGenerationAsyncStorage:()=>x});var i={};r.r(i),r.d(i,{POST:()=>c,dynamic:()=>u,runtime:()=>d});var a=r(49303),s=r(88716),o=r(60670),n=r(87070),p=r(89190),l=r.n(p);let d="nodejs",u="force-dynamic";async function c(e){try{let t=(await e.formData()).get("file");if(!t)return n.NextResponse.json({error:"Nenhum arquivo enviado"},{status:400});let r=await t.arrayBuffer(),i=await l().loadAsync(r),a=[];if(!i.folder("ppt/slides"))return n.NextResponse.json({error:"Arquivo PPTX inv\xe1lido"},{status:400});let s=Object.keys(i.files).filter(e=>e.match(/ppt\/slides\/slide\d+\.xml/)).sort((e,t)=>{let r=parseInt(e.match(/\d+/)?.[0]||"0"),i=parseInt(t.match(/\d+/)?.[0]||"0");return r-i});for(let e=0;e<s.length;e++){let t=s[e],r=await i.file(t)?.async("text");if(!r)continue;let o=e+1,n="",p=`ppt/media/image${o}.png`,l=i.file(p);if(l){let e=await l.async("base64");n=`data:image/png;base64,${e}`}else n=function(e){let t=`
    <svg width="400" height="225" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="grad${e}" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:rgb(139,92,246);stop-opacity:1" />
          <stop offset="100%" style="stop-color:rgb(59,130,246);stop-opacity:1" />
        </linearGradient>
      </defs>
      <rect width="400" height="225" fill="url(#grad${e})" />
      <text x="50%" y="50%" font-family="Arial" font-size="48" fill="white" text-anchor="middle" dominant-baseline="middle">
        ${e}
      </text>
      <text x="50%" y="70%" font-family="Arial" font-size="16" fill="white" text-anchor="middle" dominant-baseline="middle">
        Slide ${e}
      </text>
    </svg>
  `;return`data:image/svg+xml;base64,${Buffer.from(t).toString("base64")}`}(o);let d=r.includes("<a:t>")||r.includes("<a:p>"),u=r.includes("<p:pic>")||r.includes("<a:blip"),c=r.includes("<p:timing>")||r.includes("<p:animEffect>"),f=r.match(/<a:t>([^<]+)<\/a:t>/),m=f?f[1].substring(0,50):`Slide ${o}`,x=5;d&&(x+=3),u&&(x+=2),c&&(x+=2),a.push({index:e,thumbnail:n,title:m,hasText:d,hasImages:u,hasAnimations:c,estimatedDuration:x})}return n.NextResponse.json({success:!0,slides:a,totalSlides:a.length,totalEstimatedDuration:a.reduce((e,t)=>e+t.estimatedDuration,0)})}catch(e){return console.error("Erro ao extrair preview do PPTX:",e),n.NextResponse.json({error:"Erro ao processar arquivo",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/app/api/pptx/preview/route",pathname:"/app/api/pptx/preview",filename:"route",bundlePath:"app/app/api/pptx/preview/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\pptx\\preview\\route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:g}=f,h="/app/api/pptx/preview/route";function v(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:x})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[1216],()=>r(67270));module.exports=i})();