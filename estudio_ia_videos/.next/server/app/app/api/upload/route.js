"use strict";(()=>{var e={};e.id=3871,e.ids=[3871],e.modules={92885:e=>{e.exports=require("@supabase/supabase-js")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},8505:(e,r,s)=>{s.r(r),s.d(r,{originalPathname:()=>q,patchFetch:()=>w,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>E,staticGenerationAsyncStorage:()=>v});var t={};s.r(t),s.d(t,{GET:()=>f,POST:()=>x});var o=s(49303),a=s(88716),i=s(60670),n=s(87070),u=s(75571),p=s(18707),l=s(92885);let c=process.env.SUPABASE_SERVICE_ROLE_KEY||"",d=(0,l.createClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co",c);async function m(e,r){try{if(!e.name.endsWith(".pptx"))return{success:!1,error:"Apenas arquivos .pptx s\xe3o permitidos"};if(e.size>314572800)return{success:!1,error:"Arquivo muito grande. M\xe1ximo: 300MB"};let s=Date.now(),t=`${r}/${s}-${e.name}`,{data:o,error:a}=await d.storage.from("uploads").upload(t,e,{cacheControl:"3600",upsert:!1});if(a)return console.error("Erro no upload:",a),{success:!1,error:"Erro ao fazer upload do arquivo"};let{data:i}=d.storage.from("uploads").getPublicUrl(t);return{success:!0,fileUrl:i.publicUrl,fileName:e.name,fileSize:e.size}}catch(e){return console.error("Erro no upload:",e),{success:!1,error:"Erro inesperado ao fazer upload"}}}async function x(e){try{let r=await (0,u.getServerSession)(p.L);if(!r||!r.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let s=(await e.formData()).get("file");if(!s)return n.NextResponse.json({error:"Nenhum arquivo enviado"},{status:400});let t=await m(s,r.user.id);if(!t.success)return n.NextResponse.json({error:t.error},{status:400});return n.NextResponse.json({success:!0,data:{fileUrl:t.fileUrl,fileName:t.fileName,fileSize:t.fileSize}})}catch(e){return console.error("Erro na API de upload:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function f(e){try{let e=await (0,u.getServerSession)(p.L);if(!e||!e.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});return n.NextResponse.json({success:!0,uploads:[]})}catch(e){return console.error("Erro ao listar uploads:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/app/api/upload/route",pathname:"/app/api/upload",filename:"route",bundlePath:"app/app/api/upload/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\upload\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:E}=h,q="/app/api/upload/route";function w(){return(0,i.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:v})}},18707:(e,r,s)=>{s.d(r,{L:()=>u});var t=s(53797),o=s(98691),a=s(92885);let i=process.env.SUPABASE_SERVICE_ROLE_KEY||"",n=(0,a.createClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co",i),u={providers:[(0,t.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email",placeholder:"seu@email.com"},password:{label:"Senha",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Email e senha s\xe3o obrigat\xf3rios");try{let{data:r,error:s}=await n.from("users").select("*").eq("email",e.email).single();if(s||!r||!await (0,o.qu)(e.password,r.password_hash))throw Error("Credenciais inv\xe1lidas");return{id:r.id,email:r.email,name:r.name,role:r.role||"user",tier:r.tier||"free",image:r.avatar_url}}catch(e){throw console.error("Erro na autentica\xe7\xe3o:",e),Error("Erro ao autenticar usu\xe1rio")}}})],callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id,e.role=r.role,e.tier=r.tier),e),session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id,e.user.role=r.role,e.user.tier=r.tier),e)},pages:{signIn:"/login",error:"/login"},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET,debug:!1}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[1216],()=>s(8505));module.exports=t})();