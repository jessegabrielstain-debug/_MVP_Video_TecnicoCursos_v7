"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/dashboard/unified-stats/route";
exports.ids = ["app/api/dashboard/unified-stats/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Funified-stats%2Froute&page=%2Fapi%2Fdashboard%2Funified-stats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Funified-stats%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Funified-stats%2Froute&page=%2Fapi%2Fdashboard%2Funified-stats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Funified-stats%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_xampp_htdocs_MVP_Video_TecnicoCursos_v7_estudio_ia_videos_app_api_dashboard_unified_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/dashboard/unified-stats/route.ts */ \"(rsc)/./app/api/dashboard/unified-stats/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/dashboard/unified-stats/route\",\n        pathname: \"/api/dashboard/unified-stats\",\n        filename: \"route\",\n        bundlePath: \"app/api/dashboard/unified-stats/route\"\n    },\n    resolvedPagePath: \"C:\\\\xampp\\\\htdocs\\\\_MVP_Video_TecnicoCursos_v7\\\\estudio_ia_videos\\\\app\\\\api\\\\dashboard\\\\unified-stats\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_xampp_htdocs_MVP_Video_TecnicoCursos_v7_estudio_ia_videos_app_api_dashboard_unified_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/dashboard/unified-stats/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZkYXNoYm9hcmQlMkZ1bmlmaWVkLXN0YXRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZkYXNoYm9hcmQlMkZ1bmlmaWVkLXN0YXRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZGFzaGJvYXJkJTJGdW5pZmllZC1zdGF0cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDeGFtcHAlNUNodGRvY3MlNUNfTVZQX1ZpZGVvX1RlY25pY29DdXJzb3NfdjclNUNlc3R1ZGlvX2lhX3ZpZGVvcyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q3hhbXBwJTVDaHRkb2NzJTVDX01WUF9WaWRlb19UZWNuaWNvQ3Vyc29zX3Y3JTVDZXN0dWRpb19pYV92aWRlb3MmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQytEO0FBQzVJO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXN0dWRpby1pYS12aWRlb3MvP2YwZGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxceGFtcHBcXFxcaHRkb2NzXFxcXF9NVlBfVmlkZW9fVGVjbmljb0N1cnNvc192N1xcXFxlc3R1ZGlvX2lhX3ZpZGVvc1xcXFxhcHBcXFxcYXBpXFxcXGRhc2hib2FyZFxcXFx1bmlmaWVkLXN0YXRzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9kYXNoYm9hcmQvdW5pZmllZC1zdGF0cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2Rhc2hib2FyZC91bmlmaWVkLXN0YXRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9kYXNoYm9hcmQvdW5pZmllZC1zdGF0cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXHhhbXBwXFxcXGh0ZG9jc1xcXFxfTVZQX1ZpZGVvX1RlY25pY29DdXJzb3NfdjdcXFxcZXN0dWRpb19pYV92aWRlb3NcXFxcYXBwXFxcXGFwaVxcXFxkYXNoYm9hcmRcXFxcdW5pZmllZC1zdGF0c1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZGFzaGJvYXJkL3VuaWZpZWQtc3RhdHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Funified-stats%2Froute&page=%2Fapi%2Fdashboard%2Funified-stats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Funified-stats%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/dashboard/unified-stats/route.ts":
/*!**************************************************!*\
  !*** ./app/api/dashboard/unified-stats/route.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./app/lib/supabase/server.ts\");\nconst dynamic = \"force-dynamic\";\n\n\nasync function GET(request) {\n    try {\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        const { data: { user }, error: authError } = await supabase.auth.getUser();\n        if (authError || !user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // 1. Total Projects\n        const { count: totalProjects, error: projectsError } = await supabase.from(\"projects\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        }).eq(\"user_id\", user.id);\n        if (projectsError) throw projectsError;\n        // 2. Active Renders (queued or processing)\n        // We need to join with projects to filter by user_id, or if render_jobs has user_id (it doesn't seem to have user_id directly, but project_id)\n        // Let's assume we want all active renders for the user's projects.\n        // Since Supabase RLS usually handles \"my projects\", we can just query render_jobs if RLS is set up correctly to join projects.\n        // However, render_jobs table definition: project_id UUID REFERENCES public.projects(id)\n        // If RLS on render_jobs checks project.user_id, we are good.\n        // Let's try to query render_jobs directly.\n        // Fetch project IDs first to be safe/explicit if RLS isn't perfect on joins yet\n        const { data: userProjects } = await supabase.from(\"projects\").select(\"id\").eq(\"user_id\", user.id);\n        const projectIds = userProjects?.map((p)=>p.id) || [];\n        let activeRenders = 0;\n        let completedToday = 0;\n        let avgRenderTime = 0;\n        if (projectIds.length > 0) {\n            const { count: activeCount } = await supabase.from(\"render_jobs\").select(\"*\", {\n                count: \"exact\",\n                head: true\n            }).in(\"project_id\", projectIds).in(\"status\", [\n                \"queued\",\n                \"processing\"\n            ]);\n            activeRenders = activeCount || 0;\n            // 3. Completed Today\n            const startOfDay = new Date();\n            startOfDay.setHours(0, 0, 0, 0);\n            const { count: completedCount } = await supabase.from(\"render_jobs\").select(\"*\", {\n                count: \"exact\",\n                head: true\n            }).in(\"project_id\", projectIds).eq(\"status\", \"completed\").gte(\"completed_at\", startOfDay.toISOString());\n            completedToday = completedCount || 0;\n            // 5. Average Render Time (last 10 completed jobs)\n            const { data: recentJobs } = await supabase.from(\"render_jobs\").select(\"started_at, completed_at\").in(\"project_id\", projectIds).eq(\"status\", \"completed\").not(\"completed_at\", \"is\", null).not(\"started_at\", \"is\", null).order(\"completed_at\", {\n                ascending: false\n            }).limit(10);\n            if (recentJobs && recentJobs.length > 0) {\n                const totalDurationMs = recentJobs.reduce((acc, job)=>{\n                    if (!job.started_at || !job.completed_at) return acc;\n                    const start = new Date(job.started_at).getTime();\n                    const end = new Date(job.completed_at).getTime();\n                    return acc + (end - start);\n                }, 0);\n                avgRenderTime = Math.round(totalDurationMs / recentJobs.length / 1000 / 60) // in minutes\n                ;\n            }\n        }\n        // 4. Total Views (Mocked for now as we don't have a clear views table yet, maybe analytics_events?)\n        // Let's check analytics_events for 'view_project' or similar\n        const { count: viewsCount } = await supabase.from(\"analytics_events\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        }).eq(\"user_id\", user.id).eq(\"event_type\", \"project_view\") // Assuming this event type\n        ;\n        const totalViews = viewsCount || 0;\n        // 6. System Health (Mocked or check a health endpoint)\n        // We can check if we can connect to DB (which we just did)\n        const systemHealth = \"healthy\";\n        const stats = {\n            totalProjects: totalProjects || 0,\n            activeRenders,\n            completedToday,\n            totalViews,\n            avgRenderTime,\n            systemHealth\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(stats);\n    } catch (error) {\n        console.error(\"Error fetching dashboard stats:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2Rhc2hib2FyZC91bmlmaWVkLXN0YXRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSxVQUFVLGdCQUFnQjtBQUVnQjtBQUNIO0FBZ0I3QyxlQUFlRyxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsTUFBTUMsV0FBV0gsa0VBQVlBO1FBRTdCLE1BQU0sRUFBRUksTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTUosU0FBU0ssSUFBSSxDQUFDQyxPQUFPO1FBRXhFLElBQUlGLGFBQWEsQ0FBQ0YsTUFBTTtZQUN0QixPQUFPTixxREFBWUEsQ0FBQ1csSUFBSSxDQUN0QjtnQkFBRUosT0FBTztZQUFlLEdBQ3hCO2dCQUFFSyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxvQkFBb0I7UUFDcEIsTUFBTSxFQUFFQyxPQUFPQyxhQUFhLEVBQUVQLE9BQU9RLGFBQWEsRUFBRSxHQUFHLE1BQU1YLFNBQzFEWSxJQUFJLENBQUMsWUFDTEMsTUFBTSxDQUFDLEtBQUs7WUFBRUosT0FBTztZQUFTSyxNQUFNO1FBQUssR0FDekNDLEVBQUUsQ0FBQyxXQUFXYixLQUFLYyxFQUFFO1FBRXhCLElBQUlMLGVBQWUsTUFBTUE7UUFFekIsMkNBQTJDO1FBQzNDLCtJQUErSTtRQUMvSSxtRUFBbUU7UUFDbkUsK0hBQStIO1FBQy9ILHdGQUF3RjtRQUN4Riw2REFBNkQ7UUFDN0QsMkNBQTJDO1FBRTNDLGdGQUFnRjtRQUNoRixNQUFNLEVBQUVWLE1BQU1nQixZQUFZLEVBQUUsR0FBRyxNQUFNakIsU0FDaENZLElBQUksQ0FBQyxZQUNMQyxNQUFNLENBQUMsTUFDUEUsRUFBRSxDQUFDLFdBQVdiLEtBQUtjLEVBQUU7UUFFMUIsTUFBTUUsYUFBYUQsY0FBY0UsSUFBSUMsQ0FBQUEsSUFBS0EsRUFBRUosRUFBRSxLQUFLLEVBQUU7UUFFckQsSUFBSUssZ0JBQWdCO1FBQ3BCLElBQUlDLGlCQUFpQjtRQUNyQixJQUFJQyxnQkFBZ0I7UUFFcEIsSUFBSUwsV0FBV00sTUFBTSxHQUFHLEdBQUc7WUFDdkIsTUFBTSxFQUFFZixPQUFPZ0IsV0FBVyxFQUFFLEdBQUcsTUFBTXpCLFNBQ2hDWSxJQUFJLENBQUMsZUFDTEMsTUFBTSxDQUFDLEtBQUs7Z0JBQUVKLE9BQU87Z0JBQVNLLE1BQU07WUFBSyxHQUN6Q1ksRUFBRSxDQUFDLGNBQWNSLFlBQ2pCUSxFQUFFLENBQUMsVUFBVTtnQkFBQztnQkFBVTthQUFhO1lBRTFDTCxnQkFBZ0JJLGVBQWU7WUFFL0IscUJBQXFCO1lBQ3JCLE1BQU1FLGFBQWEsSUFBSUM7WUFDdkJELFdBQVdFLFFBQVEsQ0FBQyxHQUFHLEdBQUcsR0FBRztZQUU3QixNQUFNLEVBQUVwQixPQUFPcUIsY0FBYyxFQUFFLEdBQUcsTUFBTTlCLFNBQ25DWSxJQUFJLENBQUMsZUFDTEMsTUFBTSxDQUFDLEtBQUs7Z0JBQUVKLE9BQU87Z0JBQVNLLE1BQU07WUFBSyxHQUN6Q1ksRUFBRSxDQUFDLGNBQWNSLFlBQ2pCSCxFQUFFLENBQUMsVUFBVSxhQUNiZ0IsR0FBRyxDQUFDLGdCQUFnQkosV0FBV0ssV0FBVztZQUUvQ1YsaUJBQWlCUSxrQkFBa0I7WUFFbkMsa0RBQWtEO1lBQ2xELE1BQU0sRUFBRTdCLE1BQU1nQyxVQUFVLEVBQUUsR0FBRyxNQUFNakMsU0FDOUJZLElBQUksQ0FBQyxlQUNMQyxNQUFNLENBQUMsNEJBQ1BhLEVBQUUsQ0FBQyxjQUFjUixZQUNqQkgsRUFBRSxDQUFDLFVBQVUsYUFDYm1CLEdBQUcsQ0FBQyxnQkFBZ0IsTUFBTSxNQUMxQkEsR0FBRyxDQUFDLGNBQWMsTUFBTSxNQUN4QkMsS0FBSyxDQUFDLGdCQUFnQjtnQkFBRUMsV0FBVztZQUFNLEdBQ3pDQyxLQUFLLENBQUM7WUFFWCxJQUFJSixjQUFjQSxXQUFXVCxNQUFNLEdBQUcsR0FBRztnQkFDckMsTUFBTWMsa0JBQWtCTCxXQUFXTSxNQUFNLENBQUMsQ0FBQ0MsS0FBS0M7b0JBQzVDLElBQUksQ0FBQ0EsSUFBSUMsVUFBVSxJQUFJLENBQUNELElBQUlFLFlBQVksRUFBRSxPQUFPSDtvQkFDakQsTUFBTUksUUFBUSxJQUFJaEIsS0FBS2EsSUFBSUMsVUFBVSxFQUFFRyxPQUFPO29CQUM5QyxNQUFNQyxNQUFNLElBQUlsQixLQUFLYSxJQUFJRSxZQUFZLEVBQUVFLE9BQU87b0JBQzlDLE9BQU9MLE1BQU9NLENBQUFBLE1BQU1GLEtBQUk7Z0JBQzVCLEdBQUc7Z0JBQ0hyQixnQkFBZ0J3QixLQUFLQyxLQUFLLENBQUMsa0JBQW1CZixXQUFXVCxNQUFNLEdBQUksT0FBTyxJQUFJLGFBQWE7O1lBQy9GO1FBQ0o7UUFFQSxvR0FBb0c7UUFDcEcsNkRBQTZEO1FBQzdELE1BQU0sRUFBRWYsT0FBT3dDLFVBQVUsRUFBRSxHQUFHLE1BQU1qRCxTQUMvQlksSUFBSSxDQUFDLG9CQUNMQyxNQUFNLENBQUMsS0FBSztZQUFFSixPQUFPO1lBQVNLLE1BQU07UUFBSyxHQUN6Q0MsRUFBRSxDQUFDLFdBQVdiLEtBQUtjLEVBQUUsRUFDckJELEVBQUUsQ0FBQyxjQUFjLGdCQUFnQiwyQkFBMkI7O1FBRWpFLE1BQU1tQyxhQUFhRCxjQUFjO1FBRWpDLHVEQUF1RDtRQUN2RCwyREFBMkQ7UUFDM0QsTUFBTUUsZUFBZTtRQUVyQixNQUFNQyxRQUF3QjtZQUM1QjFDLGVBQWVBLGlCQUFpQjtZQUNoQ1c7WUFDQUM7WUFDQTRCO1lBQ0EzQjtZQUNBNEI7UUFDRjtRQUVBLE9BQU92RCxxREFBWUEsQ0FBQ1csSUFBSSxDQUFDNkM7SUFDM0IsRUFBRSxPQUFPakQsT0FBTztRQUNka0QsUUFBUWxELEtBQUssQ0FBQyxtQ0FBbUNBO1FBQ2pELE9BQU9QLHFEQUFZQSxDQUFDVyxJQUFJLENBQ3RCO1lBQUVKLE9BQU87UUFBd0IsR0FDakM7WUFBRUssUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lc3R1ZGlvLWlhLXZpZGVvcy8uL2FwcC9hcGkvZGFzaGJvYXJkL3VuaWZpZWQtc3RhdHMvcm91dGUudHM/NDQ1YiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgZHluYW1pYyA9ICdmb3JjZS1keW5hbWljJztcclxuXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJ1xyXG5cclxuLyoqXHJcbiAqIPCfk4ogVU5JRklFRCBEQVNIQk9BUkQgU1RBVFMgQVBJXHJcbiAqIFByb3ZpZGVzIGNvbXByZWhlbnNpdmUgc3RhdGlzdGljcyBmb3IgdGhlIHVuaWZpZWQgZGFzaGJvYXJkXHJcbiAqL1xyXG5cclxuaW50ZXJmYWNlIERhc2hib2FyZFN0YXRzIHtcclxuICB0b3RhbFByb2plY3RzOiBudW1iZXJcclxuICBhY3RpdmVSZW5kZXJzOiBudW1iZXJcclxuICBjb21wbGV0ZWRUb2RheTogbnVtYmVyXHJcbiAgdG90YWxWaWV3czogbnVtYmVyXHJcbiAgYXZnUmVuZGVyVGltZTogbnVtYmVyXHJcbiAgc3lzdGVtSGVhbHRoOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnZXJyb3InXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoKVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKVxyXG4gICAgXHJcbiAgICBpZiAoYXV0aEVycm9yIHx8ICF1c2VyKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gMS4gVG90YWwgUHJvamVjdHNcclxuICAgIGNvbnN0IHsgY291bnQ6IHRvdGFsUHJvamVjdHMsIGVycm9yOiBwcm9qZWN0c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvamVjdHMnKVxyXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxyXG5cclxuICAgIGlmIChwcm9qZWN0c0Vycm9yKSB0aHJvdyBwcm9qZWN0c0Vycm9yXHJcblxyXG4gICAgLy8gMi4gQWN0aXZlIFJlbmRlcnMgKHF1ZXVlZCBvciBwcm9jZXNzaW5nKVxyXG4gICAgLy8gV2UgbmVlZCB0byBqb2luIHdpdGggcHJvamVjdHMgdG8gZmlsdGVyIGJ5IHVzZXJfaWQsIG9yIGlmIHJlbmRlcl9qb2JzIGhhcyB1c2VyX2lkIChpdCBkb2Vzbid0IHNlZW0gdG8gaGF2ZSB1c2VyX2lkIGRpcmVjdGx5LCBidXQgcHJvamVjdF9pZClcclxuICAgIC8vIExldCdzIGFzc3VtZSB3ZSB3YW50IGFsbCBhY3RpdmUgcmVuZGVycyBmb3IgdGhlIHVzZXIncyBwcm9qZWN0cy5cclxuICAgIC8vIFNpbmNlIFN1cGFiYXNlIFJMUyB1c3VhbGx5IGhhbmRsZXMgXCJteSBwcm9qZWN0c1wiLCB3ZSBjYW4ganVzdCBxdWVyeSByZW5kZXJfam9icyBpZiBSTFMgaXMgc2V0IHVwIGNvcnJlY3RseSB0byBqb2luIHByb2plY3RzLlxyXG4gICAgLy8gSG93ZXZlciwgcmVuZGVyX2pvYnMgdGFibGUgZGVmaW5pdGlvbjogcHJvamVjdF9pZCBVVUlEIFJFRkVSRU5DRVMgcHVibGljLnByb2plY3RzKGlkKVxyXG4gICAgLy8gSWYgUkxTIG9uIHJlbmRlcl9qb2JzIGNoZWNrcyBwcm9qZWN0LnVzZXJfaWQsIHdlIGFyZSBnb29kLlxyXG4gICAgLy8gTGV0J3MgdHJ5IHRvIHF1ZXJ5IHJlbmRlcl9qb2JzIGRpcmVjdGx5LlxyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBwcm9qZWN0IElEcyBmaXJzdCB0byBiZSBzYWZlL2V4cGxpY2l0IGlmIFJMUyBpc24ndCBwZXJmZWN0IG9uIGpvaW5zIHlldFxyXG4gICAgY29uc3QgeyBkYXRhOiB1c2VyUHJvamVjdHMgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ3Byb2plY3RzJylcclxuICAgICAgICAuc2VsZWN0KCdpZCcpXHJcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcclxuICAgIFxyXG4gICAgY29uc3QgcHJvamVjdElkcyA9IHVzZXJQcm9qZWN0cz8ubWFwKHAgPT4gcC5pZCkgfHwgW11cclxuICAgIFxyXG4gICAgbGV0IGFjdGl2ZVJlbmRlcnMgPSAwXHJcbiAgICBsZXQgY29tcGxldGVkVG9kYXkgPSAwXHJcbiAgICBsZXQgYXZnUmVuZGVyVGltZSA9IDBcclxuXHJcbiAgICBpZiAocHJvamVjdElkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb3VudDogYWN0aXZlQ291bnQgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAgIC5mcm9tKCdyZW5kZXJfam9icycpXHJcbiAgICAgICAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pXHJcbiAgICAgICAgICAgIC5pbigncHJvamVjdF9pZCcsIHByb2plY3RJZHMpXHJcbiAgICAgICAgICAgIC5pbignc3RhdHVzJywgWydxdWV1ZWQnLCAncHJvY2Vzc2luZyddIGFzIGNvbnN0KVxyXG4gICAgICAgIFxyXG4gICAgICAgIGFjdGl2ZVJlbmRlcnMgPSBhY3RpdmVDb3VudCB8fCAwXHJcblxyXG4gICAgICAgIC8vIDMuIENvbXBsZXRlZCBUb2RheVxyXG4gICAgICAgIGNvbnN0IHN0YXJ0T2ZEYXkgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHN0YXJ0T2ZEYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgeyBjb3VudDogY29tcGxldGVkQ291bnQgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAgIC5mcm9tKCdyZW5kZXJfam9icycpXHJcbiAgICAgICAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pXHJcbiAgICAgICAgICAgIC5pbigncHJvamVjdF9pZCcsIHByb2plY3RJZHMpXHJcbiAgICAgICAgICAgIC5lcSgnc3RhdHVzJywgJ2NvbXBsZXRlZCcgYXMgY29uc3QpXHJcbiAgICAgICAgICAgIC5ndGUoJ2NvbXBsZXRlZF9hdCcsIHN0YXJ0T2ZEYXkudG9JU09TdHJpbmcoKSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgY29tcGxldGVkVG9kYXkgPSBjb21wbGV0ZWRDb3VudCB8fCAwXHJcblxyXG4gICAgICAgIC8vIDUuIEF2ZXJhZ2UgUmVuZGVyIFRpbWUgKGxhc3QgMTAgY29tcGxldGVkIGpvYnMpXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiByZWNlbnRKb2JzIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgICAgICAuZnJvbSgncmVuZGVyX2pvYnMnKVxyXG4gICAgICAgICAgICAuc2VsZWN0KCdzdGFydGVkX2F0LCBjb21wbGV0ZWRfYXQnKVxyXG4gICAgICAgICAgICAuaW4oJ3Byb2plY3RfaWQnLCBwcm9qZWN0SWRzKVxyXG4gICAgICAgICAgICAuZXEoJ3N0YXR1cycsICdjb21wbGV0ZWQnKVxyXG4gICAgICAgICAgICAubm90KCdjb21wbGV0ZWRfYXQnLCAnaXMnLCBudWxsKVxyXG4gICAgICAgICAgICAubm90KCdzdGFydGVkX2F0JywgJ2lzJywgbnVsbClcclxuICAgICAgICAgICAgLm9yZGVyKCdjb21wbGV0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgICAgICAgICAgLmxpbWl0KDEwKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChyZWNlbnRKb2JzICYmIHJlY2VudEpvYnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCB0b3RhbER1cmF0aW9uTXMgPSByZWNlbnRKb2JzLnJlZHVjZSgoYWNjLCBqb2IpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICgham9iLnN0YXJ0ZWRfYXQgfHwgIWpvYi5jb21wbGV0ZWRfYXQpIHJldHVybiBhY2M7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKGpvYi5zdGFydGVkX2F0KS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZShqb2IuY29tcGxldGVkX2F0KS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjICsgKGVuZCAtIHN0YXJ0KTtcclxuICAgICAgICAgICAgfSwgMClcclxuICAgICAgICAgICAgYXZnUmVuZGVyVGltZSA9IE1hdGgucm91bmQoKHRvdGFsRHVyYXRpb25NcyAvIHJlY2VudEpvYnMubGVuZ3RoKSAvIDEwMDAgLyA2MCkgLy8gaW4gbWludXRlc1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyA0LiBUb3RhbCBWaWV3cyAoTW9ja2VkIGZvciBub3cgYXMgd2UgZG9uJ3QgaGF2ZSBhIGNsZWFyIHZpZXdzIHRhYmxlIHlldCwgbWF5YmUgYW5hbHl0aWNzX2V2ZW50cz8pXHJcbiAgICAvLyBMZXQncyBjaGVjayBhbmFseXRpY3NfZXZlbnRzIGZvciAndmlld19wcm9qZWN0JyBvciBzaW1pbGFyXHJcbiAgICBjb25zdCB7IGNvdW50OiB2aWV3c0NvdW50IH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdhbmFseXRpY3NfZXZlbnRzJylcclxuICAgICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KVxyXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgICAgLmVxKCdldmVudF90eXBlJywgJ3Byb2plY3RfdmlldycpIC8vIEFzc3VtaW5nIHRoaXMgZXZlbnQgdHlwZVxyXG4gICAgXHJcbiAgICBjb25zdCB0b3RhbFZpZXdzID0gdmlld3NDb3VudCB8fCAwXHJcblxyXG4gICAgLy8gNi4gU3lzdGVtIEhlYWx0aCAoTW9ja2VkIG9yIGNoZWNrIGEgaGVhbHRoIGVuZHBvaW50KVxyXG4gICAgLy8gV2UgY2FuIGNoZWNrIGlmIHdlIGNhbiBjb25uZWN0IHRvIERCICh3aGljaCB3ZSBqdXN0IGRpZClcclxuICAgIGNvbnN0IHN5c3RlbUhlYWx0aCA9ICdoZWFsdGh5J1xyXG5cclxuICAgIGNvbnN0IHN0YXRzOiBEYXNoYm9hcmRTdGF0cyA9IHtcclxuICAgICAgdG90YWxQcm9qZWN0czogdG90YWxQcm9qZWN0cyB8fCAwLFxyXG4gICAgICBhY3RpdmVSZW5kZXJzLFxyXG4gICAgICBjb21wbGV0ZWRUb2RheSxcclxuICAgICAgdG90YWxWaWV3cyxcclxuICAgICAgYXZnUmVuZGVyVGltZSxcclxuICAgICAgc3lzdGVtSGVhbHRoXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHN0YXRzKVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBkYXNoYm9hcmQgc3RhdHM6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZHluYW1pYyIsIk5leHRSZXNwb25zZSIsImNyZWF0ZUNsaWVudCIsIkdFVCIsInJlcXVlc3QiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiZXJyb3IiLCJhdXRoRXJyb3IiLCJhdXRoIiwiZ2V0VXNlciIsImpzb24iLCJzdGF0dXMiLCJjb3VudCIsInRvdGFsUHJvamVjdHMiLCJwcm9qZWN0c0Vycm9yIiwiZnJvbSIsInNlbGVjdCIsImhlYWQiLCJlcSIsImlkIiwidXNlclByb2plY3RzIiwicHJvamVjdElkcyIsIm1hcCIsInAiLCJhY3RpdmVSZW5kZXJzIiwiY29tcGxldGVkVG9kYXkiLCJhdmdSZW5kZXJUaW1lIiwibGVuZ3RoIiwiYWN0aXZlQ291bnQiLCJpbiIsInN0YXJ0T2ZEYXkiLCJEYXRlIiwic2V0SG91cnMiLCJjb21wbGV0ZWRDb3VudCIsImd0ZSIsInRvSVNPU3RyaW5nIiwicmVjZW50Sm9icyIsIm5vdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibGltaXQiLCJ0b3RhbER1cmF0aW9uTXMiLCJyZWR1Y2UiLCJhY2MiLCJqb2IiLCJzdGFydGVkX2F0IiwiY29tcGxldGVkX2F0Iiwic3RhcnQiLCJnZXRUaW1lIiwiZW5kIiwiTWF0aCIsInJvdW5kIiwidmlld3NDb3VudCIsInRvdGFsVmlld3MiLCJzeXN0ZW1IZWFsdGgiLCJzdGF0cyIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/dashboard/unified-stats/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/lib/supabase/server.ts":
/*!************************************!*\
  !*** ./app/lib/supabase/server.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ createClient),\n/* harmony export */   getSupabaseForRequest: () => (/* binding */ getSupabaseForRequest),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\n\n// Criando o cliente Supabase para uso no lado do servidor\nconst createClient = ()=>{\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://ofhzrdiadxigrvmrhaiz.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ\", {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value,\n                        ...options\n                    });\n                } catch (error) {\n                // The `set` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            },\n            remove (name, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value: \"\",\n                        ...options\n                    });\n                } catch (error) {\n                // The `remove` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n};\n// Cliente Supabase com a chave de serviço para operações administrativas\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://ofhzrdiadxigrvmrhaiz.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\n// Cria cliente Supabase usando Authorization do Request (para APIs)\nfunction getSupabaseForRequest(req) {\n    const authHeader = req.headers.get(\"authorization\") || req.headers.get(\"Authorization\");\n    // Se houver header de autorização, usa o cliente padrão (API externa/Service)\n    if (authHeader) {\n        const url = \"https://ofhzrdiadxigrvmrhaiz.supabase.co\" || 0 || 0;\n        const anonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ\" || 0 || 0;\n        const globalHeaders = {\n            \"Authorization\": authHeader\n        };\n        return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(url, anonKey, {\n            global: {\n                headers: globalHeaders\n            },\n            auth: {\n                persistSession: false,\n                autoRefreshToken: false\n            }\n        });\n    }\n    // Fallback: Se não houver header, tenta usar cookies (Browser/Dashboard)\n    return createClient();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvbGliL3N1cGFiYXNlL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBdUU7QUFDdUQ7QUFDdkY7QUFHdkMsMERBQTBEO0FBQ25ELE1BQU1DLGVBQWU7SUFDMUIsTUFBTUcsY0FBY0QscURBQU9BO0lBRTNCLE9BQU9ILGlFQUFrQkEsQ0FDdkJLLDBDQUFvQyxFQUNwQ0Esa05BQXlDLEVBQ3pDO1FBQ0VGLFNBQVM7WUFDUE0sS0FBSUMsSUFBWTtnQkFDZCxPQUFPTixZQUFZSyxHQUFHLENBQUNDLE9BQU9DO1lBQ2hDO1lBQ0FDLEtBQUlGLElBQVksRUFBRUMsS0FBYSxFQUFFRSxPQUFzQjtnQkFDckQsSUFBSTtvQkFDRlQsWUFBWVEsR0FBRyxDQUFDO3dCQUFFRjt3QkFBTUM7d0JBQU8sR0FBR0UsT0FBTztvQkFBQztnQkFDNUMsRUFBRSxPQUFPQyxPQUFPO2dCQUNkLHVEQUF1RDtnQkFDdkQsd0RBQXdEO2dCQUN4RCxpQkFBaUI7Z0JBQ25CO1lBQ0Y7WUFDQUMsUUFBT0wsSUFBWSxFQUFFRyxPQUFzQjtnQkFDekMsSUFBSTtvQkFDRlQsWUFBWVEsR0FBRyxDQUFDO3dCQUFFRjt3QkFBTUMsT0FBTzt3QkFBSSxHQUFHRSxPQUFPO29CQUFDO2dCQUNoRCxFQUFFLE9BQU9DLE9BQU87Z0JBQ2QsMERBQTBEO2dCQUMxRCx3REFBd0Q7Z0JBQ3hELGlCQUFpQjtnQkFDbkI7WUFDRjtRQUNGO0lBQ0Y7QUFFSixFQUFFO0FBRUYseUVBQXlFO0FBQ2xFLE1BQU1FLGdCQUFnQmQsbUVBQW9CQSxDQUMvQ0csMENBQW9DLEVBQ3BDQSxRQUFRQyxHQUFHLENBQUNXLHlCQUF5QixFQUNyQztJQUNFQyxNQUFNO1FBQ0pDLGtCQUFrQjtRQUNsQkMsZ0JBQWdCO0lBQ2xCO0FBQ0YsR0FDQTtBQUVGLG9FQUFvRTtBQUM3RCxTQUFTQyxzQkFBc0JDLEdBQVk7SUFDaEQsTUFBTUMsYUFBY0QsSUFBSUUsT0FBTyxDQUFDZixHQUFHLENBQUMsb0JBQW9CYSxJQUFJRSxPQUFPLENBQUNmLEdBQUcsQ0FBQztJQUV4RSw4RUFBOEU7SUFDOUUsSUFBSWMsWUFBWTtRQUNkLE1BQU1FLE1BQU1wQiwwQ0FBb0MsSUFBSUEsQ0FBd0IsSUFBSTtRQUNoRixNQUFNc0IsVUFBVXRCLGtOQUF5QyxJQUFJQSxDQUE2QixJQUFJO1FBQzlGLE1BQU13QixnQkFBd0M7WUFBRSxpQkFBaUJOO1FBQVc7UUFFNUUsT0FBT3JCLG1FQUFvQkEsQ0FBV3VCLEtBQUtFLFNBQVM7WUFDbERHLFFBQVE7Z0JBQUVOLFNBQVNLO1lBQWM7WUFDakNYLE1BQU07Z0JBQUVFLGdCQUFnQjtnQkFBT0Qsa0JBQWtCO1lBQU07UUFDekQ7SUFDRjtJQUVBLHlFQUF5RTtJQUN6RSxPQUFPbEI7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2VzdHVkaW8taWEtdmlkZW9zLy4vYXBwL2xpYi9zdXBhYmFzZS9zZXJ2ZXIudHM/MDZjYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQsIHR5cGUgQ29va2llT3B0aW9ucyB9IGZyb20gJ0BzdXBhYmFzZS9zc3InO1xyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgYXMgY3JlYXRlU3VwYWJhc2VDbGllbnQsIHR5cGUgU3VwYWJhc2VDbGllbnQsIHR5cGUgU3VwYWJhc2VDbGllbnRPcHRpb25zIH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycyc7XHJcbmltcG9ydCB7IERhdGFiYXNlIH0gZnJvbSAnLi9kYXRhYmFzZS50eXBlcyc7XHJcblxyXG4vLyBDcmlhbmRvIG8gY2xpZW50ZSBTdXBhYmFzZSBwYXJhIHVzbyBubyBsYWRvIGRvIHNlcnZpZG9yXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVDbGllbnQgPSAoKSA9PiB7XHJcbiAgY29uc3QgY29va2llU3RvcmUgPSBjb29raWVzKCk7XHJcbiAgXHJcbiAgcmV0dXJuIGNyZWF0ZVNlcnZlckNsaWVudDxEYXRhYmFzZT4oXHJcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxyXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxyXG4gICAge1xyXG4gICAgICBjb29raWVzOiB7XHJcbiAgICAgICAgZ2V0KG5hbWU6IHN0cmluZykge1xyXG4gICAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldChuYW1lKT8udmFsdWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBDb29raWVPcHRpb25zKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb29raWVTdG9yZS5zZXQoeyBuYW1lLCB2YWx1ZSwgLi4ub3B0aW9ucyB9KTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBgc2V0YCBtZXRob2Qgd2FzIGNhbGxlZCBmcm9tIGEgU2VydmVyIENvbXBvbmVudC5cclxuICAgICAgICAgICAgLy8gVGhpcyBjYW4gYmUgaWdub3JlZCBpZiB5b3UgaGF2ZSBtaWRkbGV3YXJlIHJlZnJlc2hpbmdcclxuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbW92ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IENvb2tpZU9wdGlvbnMpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldCh7IG5hbWUsIHZhbHVlOiAnJywgLi4ub3B0aW9ucyB9KTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBgcmVtb3ZlYCBtZXRob2Qgd2FzIGNhbGxlZCBmcm9tIGEgU2VydmVyIENvbXBvbmVudC5cclxuICAgICAgICAgICAgLy8gVGhpcyBjYW4gYmUgaWdub3JlZCBpZiB5b3UgaGF2ZSBtaWRkbGV3YXJlIHJlZnJlc2hpbmdcclxuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG4gICk7XHJcbn07XHJcblxyXG4vLyBDbGllbnRlIFN1cGFiYXNlIGNvbSBhIGNoYXZlIGRlIHNlcnZpw6dvIHBhcmEgb3BlcmHDp8O1ZXMgYWRtaW5pc3RyYXRpdmFzXHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZUFkbWluID0gY3JlYXRlU3VwYWJhc2VDbGllbnQ8RGF0YWJhc2U+KFxyXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXHJcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEsXHJcbiAge1xyXG4gICAgYXV0aDoge1xyXG4gICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcclxuICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLFxyXG4gICAgfSxcclxuICB9XHJcbik7XHJcblxyXG4vLyBDcmlhIGNsaWVudGUgU3VwYWJhc2UgdXNhbmRvIEF1dGhvcml6YXRpb24gZG8gUmVxdWVzdCAocGFyYSBBUElzKVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwYWJhc2VGb3JSZXF1ZXN0KHJlcTogUmVxdWVzdCk6IFN1cGFiYXNlQ2xpZW50PERhdGFiYXNlPiB7XHJcbiAgY29uc3QgYXV0aEhlYWRlciA9IChyZXEuaGVhZGVycy5nZXQoJ2F1dGhvcml6YXRpb24nKSB8fCByZXEuaGVhZGVycy5nZXQoJ0F1dGhvcml6YXRpb24nKSk7XHJcblxyXG4gIC8vIFNlIGhvdXZlciBoZWFkZXIgZGUgYXV0b3JpemHDp8OjbywgdXNhIG8gY2xpZW50ZSBwYWRyw6NvIChBUEkgZXh0ZXJuYS9TZXJ2aWNlKVxyXG4gIGlmIChhdXRoSGVhZGVyKSB7XHJcbiAgICBjb25zdCB1cmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfVVJMIHx8ICcnO1xyXG4gICAgY29uc3QgYW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8IHByb2Nlc3MuZW52LlNVUEFCQVNFX0FOT05fS0VZIHx8ICcnO1xyXG4gICAgY29uc3QgZ2xvYmFsSGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgJ0F1dGhvcml6YXRpb24nOiBhdXRoSGVhZGVyIH07XHJcblxyXG4gICAgcmV0dXJuIGNyZWF0ZVN1cGFiYXNlQ2xpZW50PERhdGFiYXNlPih1cmwsIGFub25LZXksIHtcclxuICAgICAgZ2xvYmFsOiB7IGhlYWRlcnM6IGdsb2JhbEhlYWRlcnMgfSxcclxuICAgICAgYXV0aDogeyBwZXJzaXN0U2Vzc2lvbjogZmFsc2UsIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlIH0sXHJcbiAgICB9IGFzIFN1cGFiYXNlQ2xpZW50T3B0aW9uczwncHVibGljJz4pO1xyXG4gIH1cclxuXHJcbiAgLy8gRmFsbGJhY2s6IFNlIG7Do28gaG91dmVyIGhlYWRlciwgdGVudGEgdXNhciBjb29raWVzIChCcm93c2VyL0Rhc2hib2FyZClcclxuICByZXR1cm4gY3JlYXRlQ2xpZW50KCk7XHJcbn0iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyQ2xpZW50IiwiY3JlYXRlQ2xpZW50IiwiY3JlYXRlU3VwYWJhc2VDbGllbnQiLCJjb29raWVzIiwiY29va2llU3RvcmUiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXQiLCJuYW1lIiwidmFsdWUiLCJzZXQiLCJvcHRpb25zIiwiZXJyb3IiLCJyZW1vdmUiLCJzdXBhYmFzZUFkbWluIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImF1dGgiLCJhdXRvUmVmcmVzaFRva2VuIiwicGVyc2lzdFNlc3Npb24iLCJnZXRTdXBhYmFzZUZvclJlcXVlc3QiLCJyZXEiLCJhdXRoSGVhZGVyIiwiaGVhZGVycyIsInVybCIsIlNVUEFCQVNFX1VSTCIsImFub25LZXkiLCJTVVBBQkFTRV9BTk9OX0tFWSIsImdsb2JhbEhlYWRlcnMiLCJnbG9iYWwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@opentelemetry","vendor-chunks/next","vendor-chunks/@supabase"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fdashboard%2Funified-stats%2Froute&page=%2Fapi%2Fdashboard%2Funified-stats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdashboard%2Funified-stats%2Froute.ts&appDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Chtdocs%5C_MVP_Video_TecnicoCursos_v7%5Cestudio_ia_videos&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();