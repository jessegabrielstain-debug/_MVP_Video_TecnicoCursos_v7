"use strict";(()=>{var e={};e.id=5670,e.ids=[5670,3936],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},80216:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>I,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>p});var i=r(49303),o=r(88716),a=r(60670),n=r(87070),u=r(13936),c=r(23778);async function p(e,{params:t}){try{let r=(0,u.getSupabaseForRequest)(e),{data:{user:s}}=await r.auth.getUser();if(!s?.id)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{decision:i,feedback:o}=await e.json();if(!i||!["APPROVED","REJECTED","CHANGES_REQUESTED","approved","rejected","changes_requested"].includes(i))return n.NextResponse.json({error:"decision inv\xe1lido (approved, rejected, changes_requested)"},{status:400});let a=i.toLowerCase();return await c.S.submitReview({reviewId:t.reviewId,userId:s.id,decision:a,comments:o}),n.NextResponse.json({success:!0})}catch(e){return console.error("âŒ Erro ao submeter revis\xe3o:",e),n.NextResponse.json({error:e instanceof Error?e.message:String(e)||"Erro ao submeter revis\xe3o"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/review/[reviewId]/submit/route",pathname:"/api/review/[reviewId]/submit",filename:"route",bundlePath:"app/api/review/[reviewId]/submit/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\review\\[reviewId]\\submit\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:h}=d,v="/api/review/[reviewId]/submit/route";function I(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},23778:(e,t,r)=>{r.d(t,{S:()=>i});class s{async createReviewRequest(e,t,r){let s=crypto.randomUUID(),i={id:s,projectId:e,requesterId:t,reviewers:r,status:"pending",createdAt:new Date,comments:[]};return this.requests.set(s,i),s}async updateStatus(e,t){let r=this.requests.get(e);return!!r&&(r.status=t,("approved"===t||"rejected"===t)&&(r.completedAt=new Date),!0)}async getRequest(e){return this.requests.get(e)||null}async listForReviewer(e){return Array.from(this.requests.values()).filter(t=>t.reviewers.includes(e))}async publishProject(e){return console.log(`Publishing project ${e.projectId} by user ${e.userId}`),{success:!0}}async reopenForEditing(e){let t=Array.from(this.requests.values()).find(t=>t.projectId===e.projectId);return t?(t.status="pending",t.completedAt=void 0,{success:!0}):{success:!1,error:"Review not found"}}async submitReview(e){let t=this.requests.get(e.reviewId);return t?(t.status=e.decision,t.completedAt=new Date,e.comments&&(t.comments=t.comments||[],t.comments.push(e.comments)),{success:!0}):{success:!1,error:"Review not found"}}async getReviewStats(e){let t=Array.from(this.requests.values()).filter(t=>t.reviewers.includes(e.userId));return{pending:t.filter(e=>"pending"===e.status).length,approved:t.filter(e=>"approved"===e.status).length,rejected:t.filter(e=>"rejected"===e.status).length}}async getReviewStatus(e){return this.requests.get(e)||null}constructor(){this.requests=new Map}}let i=new s},13936:(e,t,r)=>{r.d(t,{e:()=>a,getSupabaseForRequest:()=>u,p:()=>n});var s=r(67721),i=r(61657),o=r(71615);let a=()=>{let e=(0,o.cookies)();return(0,s.createServerClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{cookies:{get:t=>e.get(t)?.value,set(t,r,s){try{e.set({name:t,value:r,...s})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})},n=(0,i.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});function u(e){let t=e.headers.get("authorization")||e.headers.get("Authorization");return t?(0,i.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{global:{headers:{Authorization:t}},auth:{persistSession:!1,autoRefreshToken:!1}}):a()}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,1657,9702],()=>r(80216));module.exports=s})();