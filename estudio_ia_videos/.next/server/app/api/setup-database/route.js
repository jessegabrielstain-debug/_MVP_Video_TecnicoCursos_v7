"use strict";(()=>{var e={};e.id=4125,e.ids=[4125,3936],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},87890:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>I,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{GET:()=>d,POST:()=>u});var a=s(49303),o=s(88716),i=s(60670),n=s(87070),c=s(13936);async function u(e){try{console.log("\uD83D\uDE80 [SETUP-DB] Iniciando configura\xe7\xe3o do banco de dados...");let t=(0,c.getSupabaseForRequest)(e),{data:s,error:r}=await t.rpc("check_table_exists",{table_name:"projects"});r&&console.log("⚠️ [SETUP-DB] N\xe3o foi poss\xedvel verificar tabelas existentes, prosseguindo...");let a=`
      CREATE TABLE IF NOT EXISTS public.projects (
          id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
          name VARCHAR(255) NOT NULL,
          description TEXT,
          status VARCHAR(50) DEFAULT 'draft',
          user_id VARCHAR(255),
          settings JSONB DEFAULT '{}',
          created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
          updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
          metadata JSONB DEFAULT '{}'
      );
    `,{error:o}=await t.rpc("exec_sql",{sql:a});if(o){console.error("❌ [SETUP-DB] Erro ao criar tabela projects:",o);let{data:e,error:s}=await t.from("projects").insert({name:"Projeto de Teste",description:"Projeto criado durante setup do banco",status:"draft",user_id:"test-user-setup",settings:{width:1920,height:1080,fps:30},metadata:{type:"video",is_public:!1}}).select();if(s)return n.NextResponse.json({success:!1,error:"Tabela projects n\xe3o existe e n\xe3o foi poss\xedvel criar",details:s.message,suggestion:"Execute o SQL manualmente no Supabase Dashboard",timestamp:new Date().toISOString()},{status:500});return n.NextResponse.json({success:!0,message:"Tabela projects j\xe1 existe! Dados de teste inseridos.",data:e,timestamp:new Date().toISOString()})}return console.log("✅ [SETUP-DB] Banco de dados configurado com sucesso!"),n.NextResponse.json({success:!0,message:"Banco de dados configurado com sucesso!",tables_created:["projects"],timestamp:new Date().toISOString()})}catch(e){return console.error("\uD83D\uDCA5 [SETUP-DB] Erro interno:",e),n.NextResponse.json({success:!1,error:"Erro interno do servidor",details:e instanceof Error?e.message:"Erro desconhecido",timestamp:new Date().toISOString()},{status:500})}}async function d(e){try{console.log("\uD83D\uDD0D [SETUP-DB] Verificando status do banco de dados...");let t=(0,c.getSupabaseForRequest)(e),{data:s,error:r}=await t.from("projects").select("id, name, created_at").limit(5);if(r)return n.NextResponse.json({success:!1,database_ready:!1,error:"Tabela projects n\xe3o encontrada",details:r.message,suggestion:"Execute POST /api/setup-database para configurar",timestamp:new Date().toISOString()});return n.NextResponse.json({success:!0,database_ready:!0,message:"Banco de dados configurado e funcionando!",projects_count:s?.length||0,sample_projects:s,timestamp:new Date().toISOString()})}catch(e){return console.error("\uD83D\uDCA5 [SETUP-DB] Erro ao verificar banco:",e),n.NextResponse.json({success:!1,database_ready:!1,error:"Erro interno do servidor",details:e instanceof Error?e.message:"Erro desconhecido",timestamp:new Date().toISOString()},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/setup-database/route",pathname:"/api/setup-database",filename:"route",bundlePath:"app/api/setup-database/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\setup-database\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=p,I="/api/setup-database/route";function h(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},13936:(e,t,s)=>{s.d(t,{e:()=>i,getSupabaseForRequest:()=>c,p:()=>n});var r=s(67721),a=s(61657),o=s(71615);let i=()=>{let e=(0,o.cookies)();return(0,r.createServerClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{cookies:{get:t=>e.get(t)?.value,set(t,s,r){try{e.set({name:t,value:s,...r})}catch(e){}},remove(t,s){try{e.set({name:t,value:"",...s})}catch(e){}}}})},n=(0,a.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});function c(e){let t=e.headers.get("authorization")||e.headers.get("Authorization");return t?(0,a.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{global:{headers:{Authorization:t}},auth:{persistSession:!1,autoRefreshToken:!1}}):i()}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,5972,1657,9702],()=>s(87890));module.exports=r})();