"use strict";(()=>{var e={};e.id=8401,e.ids=[8401],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63994:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>h,staticGenerationAsyncStorage:()=>b});var s={};r.r(s),r.d(s,{DELETE:()=>p,GET:()=>l,POST:()=>c});var o=r(349303),a=r(88716),n=r(60670),i=r(387070);class u{static getInstance(){return this.instance||(this.instance=new u),this.instance}logEvent(e,t){console.log(`ðŸ“Š [${e}]`,t)}}class d{static getInstance(){return this.instance||(this.instance=new d),this.instance}async createJob(e,t,r){let s=`job_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,o={id:s,userId:e,text:t,config:r,status:"queued",progress:0,results:null,error:null,createdAt:new Date,updatedAt:new Date,startedAt:null,completedAt:null,estimatedDuration:45e3,actualDuration:null};return this.jobs.set(s,o),s}getJob(e){return this.jobs.get(e)||null}getJobsByUser(e){return Array.from(this.jobs.values()).filter(t=>t.userId===e)}getStats(){let e=Array.from(this.jobs.values());return{totalJobs:e.length,queuedJobs:e.filter(e=>"queued"===e.status).length,processingJobs:e.filter(e=>"processing"===e.status).length,completedJobs:e.filter(e=>"completed"===e.status).length,failedJobs:e.filter(e=>"failed"===e.status).length}}constructor(){this.jobs=new Map}}async function c(e){let t=u.getInstance(),r=Date.now();try{let{text:r,config:s={},userId:o,priority:a="normal"}=await e.json();if(!r||"string"!=typeof r)return i.NextResponse.json({error:"Texto \xe9 obrigat\xf3rio e deve ser uma string"},{status:400});if(!o)return i.NextResponse.json({error:"userId \xe9 obrigat\xf3rio"},{status:400});if(r.length>1e4)return i.NextResponse.json({error:"Texto muito longo (m\xe1ximo 10.000 caracteres)"},{status:400});t.logEvent("video_render_request",{userId:o,textLength:r.length,priority:a,config:s});let n=d.getInstance(),u={tts:{engine:"elevenlabs",voice:"pt-BR-AntonioNeural",language:"pt-BR",speed:1,pitch:1,stability:.75,clarity:.85,...s.tts},avatar:{modelId:"default-male",quality:"high",resolution:"1080p",fps:30,background:"studio",lighting:"natural",...s.avatar},video:{format:"mp4",codec:"h264",bitrate:5e6,watermark:!1,...s.video},processing:{priority:a,enableCache:!0,enableOptimizations:!0,maxRetries:3,timeout:3e5,...s.processing}},c=await n.createJob(o,r,u);return t.logEvent("video_render_job_created",{userId:o,jobId:c,estimatedDuration:45e3}),i.NextResponse.json({success:!0,data:{jobId:c,status:"queued",message:"Job de renderiza\xe7\xe3o criado com sucesso",estimatedDuration:45e3,config:u}})}catch(e){return t.logEvent("video_render_error",{error:e.message,stack:e.stack,processingTime:Date.now()-r}),console.error("Erro na cria\xe7\xe3o do job de renderiza\xe7\xe3o:",e),i.NextResponse.json({error:"Erro interno do servidor",message:e.message,code:"VIDEO_RENDER_ERROR"},{status:500})}}async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("jobId"),s=t.get("userId"),o=d.getInstance();if(r){let e=o.getJob(r);if(!e)return i.NextResponse.json({error:"Job n\xe3o encontrado"},{status:404});return i.NextResponse.json({success:!0,data:{jobId:e.id,userId:e.userId,status:e.status,progress:e.progress,results:e.results,error:e.error,createdAt:e.createdAt,updatedAt:e.updatedAt,startedAt:e.startedAt,completedAt:e.completedAt,estimatedDuration:e.estimatedDuration,actualDuration:e.actualDuration}})}if(s){let e=o.getJobsByUser(s);return i.NextResponse.json({success:!0,data:{jobs:e.map(e=>({jobId:e.id,status:e.status,progress:e.progress,createdAt:e.createdAt,updatedAt:e.updatedAt,estimatedDuration:e.estimatedDuration,actualDuration:e.actualDuration})),total:e.length}})}{let e=o.getStats();return i.NextResponse.json({success:!0,data:e})}}catch(e){return console.error("Erro ao obter informa\xe7\xf5es de renderiza\xe7\xe3o:",e),i.NextResponse.json({error:"Erro ao obter informa\xe7\xf5es",message:e.message},{status:500})}}async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("jobId");if(!r)return i.NextResponse.json({error:"jobId \xe9 obrigat\xf3rio"},{status:400});let s=d.getInstance();if(!await s.cancelJob(r))return i.NextResponse.json({error:"Job n\xe3o pode ser cancelado ou n\xe3o foi encontrado"},{status:400});return i.NextResponse.json({success:!0,message:"Job cancelado com sucesso",data:{jobId:r}})}catch(e){return console.error("Erro ao cancelar job:",e),i.NextResponse.json({error:"Erro ao cancelar job",message:e.message},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/video/render/route",pathname:"/api/video/render",filename:"route",bundlePath:"app/api/video/render/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\video\\render\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:b,serverHooks:h}=g,j="/api/video/render/route";function v(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:b})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972],()=>r(63994));module.exports=s})();