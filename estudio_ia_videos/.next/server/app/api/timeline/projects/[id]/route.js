"use strict";(()=>{var e={};e.id=1359,e.ids=[1359,3936],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},95786:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>j,requestAsyncStorage:()=>h,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{DELETE:()=>c,GET:()=>d,PUT:()=>p});var i=r(49303),o=r(88716),a=r(60670),n=r(87070),u=r(13936);async function d(e,{params:t}){try{let r=(0,u.getSupabaseForRequest)(e),{data:{user:s}}=await r.auth.getUser();if(!s)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{data:i,error:o}=await r.from("projects").select("*").eq("id",t.id).eq("user_id",s.id).single();if(o||!i)return n.NextResponse.json({error:"Project not found"},{status:404});let a=i.metadata,d=i.render_settings,p=a?.timeline||{id:i.id,name:i.name,duration:d?.duration||120,fps:d?.fps||30,width:d?.width||1920,height:d?.height||1080,tracks:[],currentTime:0,isPlaying:!1,zoom:1};return p.id=i.id,n.NextResponse.json(p)}catch(e){return console.error("Error loading project:",e),n.NextResponse.json({error:"Internal Server Error"},{status:500})}}async function p(e,{params:t}){try{let r=(0,u.getSupabaseForRequest)(e),{data:{user:s}}=await r.auth.getUser();if(!s)return n.NextResponse.json({error:"Unauthorized"},{status:401});let i=await e.json(),{error:o}=await r.from("projects").update({name:i.name,updated_at:new Date().toISOString(),metadata:{timeline:i},render_settings:{width:i.width,height:i.height,fps:i.fps,duration:i.duration}}).eq("id",t.id).eq("user_id",s.id);if(o)throw o;await r.from("slides").delete().eq("project_id",t.id);let a=i.tracks.find(e=>"Slides PPTX"===e.name||"video"===e.type);if(a&&a.elements){let e=a.elements.map((e,r)=>({project_id:t.id,order_index:r,title:e.name,content:e.properties?.content||e.name,duration:Math.round(e.duration),background_image:e.properties?.src}));if(e.length>0){let{error:t}=await r.from("slides").insert(e);t&&console.error("Error syncing slides:",t)}}return n.NextResponse.json({success:!0,message:"Project saved successfully"})}catch(e){return console.error("Error saving project:",e),n.NextResponse.json({error:"Internal Server Error"},{status:500})}}async function c(e,{params:t}){try{let r=(0,u.getSupabaseForRequest)(e),{data:{user:s}}=await r.auth.getUser();if(!s)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{error:i}=await r.from("projects").delete().eq("id",t.id).eq("user_id",s.id);if(i)throw i;return n.NextResponse.json({success:!0,message:"Project deleted successfully"})}catch(e){return console.error("Error deleting project:",e),n.NextResponse.json({error:"Internal Server Error"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/timeline/projects/[id]/route",pathname:"/api/timeline/projects/[id]",filename:"route",bundlePath:"app/api/timeline/projects/[id]/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\timeline\\projects\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:g}=l,x="/api/timeline/projects/[id]/route";function j(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},13936:(e,t,r)=>{r.d(t,{e:()=>a,getSupabaseForRequest:()=>u,p:()=>n});var s=r(67721),i=r(61657),o=r(71615);let a=()=>{let e=(0,o.cookies)();return(0,s.createServerClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{cookies:{get:t=>e.get(t)?.value,set(t,r,s){try{e.set({name:t,value:r,...s})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})},n=(0,i.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});function u(e){let t=e.headers.get("authorization")||e.headers.get("Authorization");return t?(0,i.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{global:{headers:{Authorization:t}},auth:{persistSession:!1,autoRefreshToken:!1}}):a()}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,1657,9702],()=>r(95786));module.exports=s})();