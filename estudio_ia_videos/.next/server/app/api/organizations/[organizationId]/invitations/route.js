"use strict";(()=>{var e={};e.id=9919,e.ids=[9919],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},31818:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>l,staticGenerationAsyncStorage:()=>u});var r={};a.r(r),a.d(r,{GET:()=>g,POST:()=>d});var s=a(49303),i=a(88716),n=a(60670),o=a(87070),c=a(67409);async function g(e,{params:t}){try{let{organizationId:a}=t,{searchParams:r}=new URL(e.url),s=r.get("userId");if(!s)return o.NextResponse.json({error:"User ID is required"},{status:400});if(!c.D0.hasPermission(s,a,"manageMembers"))return o.NextResponse.json({error:"Access denied"},{status:403});return o.NextResponse.json({success:!0,data:[]})}catch(e){return console.error("Error fetching invitations:",e),o.NextResponse.json({error:"Failed to fetch invitations"},{status:500})}}async function d(e,{params:t}){try{let{organizationId:a}=t,{userId:r,email:s,role:i="member",workspaces:n=[]}=await e.json();if(!r||!s)return o.NextResponse.json({error:"User ID and email are required"},{status:400});if(!c.D0.hasPermission(r,a,"manageMembers"))return o.NextResponse.json({error:"Insufficient permissions to send invitations"},{status:403});let g=c.D0.createInvitation(a,r,s,i,n);return o.NextResponse.json({success:!0,data:g},{status:201})}catch(e){return console.error("Error creating invitation:",e),o.NextResponse.json({error:e.message||"Failed to create invitation"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/organizations/[organizationId]/invitations/route",pathname:"/api/organizations/[organizationId]/invitations",filename:"route",bundlePath:"app/api/organizations/[organizationId]/invitations/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\organizations\\[organizationId]\\invitations\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:l}=m,h="/api/organizations/[organizationId]/invitations/route";function f(){return(0,n.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:u})}},67409:(e,t,a)=>{a.d(t,{D0:()=>s});class r{static{this.DEFAULT_PERMISSIONS={owner:{manageOrganization:!0,manageMembers:!0,manageBilling:!0,viewAnalytics:!0,createWorkspaces:!0,manageWorkspace:!0,deleteWorkspace:!0,createProjects:!0,editProjects:!0,deleteProjects:!0,exportProjects:!0,shareProjects:!0,manageBrandKits:!0,manageTemplates:!0,manageIntegrations:!0,viewAuditLogs:!0},admin:{manageOrganization:!1,manageMembers:!0,manageBilling:!1,viewAnalytics:!0,createWorkspaces:!0,manageWorkspace:!0,deleteWorkspace:!1,createProjects:!0,editProjects:!0,deleteProjects:!0,exportProjects:!0,shareProjects:!0,manageBrandKits:!0,manageTemplates:!0,manageIntegrations:!0,viewAuditLogs:!0},manager:{manageOrganization:!1,manageMembers:!1,manageBilling:!1,viewAnalytics:!1,createWorkspaces:!0,manageWorkspace:!0,deleteWorkspace:!1,createProjects:!0,editProjects:!0,deleteProjects:!1,exportProjects:!0,shareProjects:!0,manageBrandKits:!0,manageTemplates:!1,manageIntegrations:!1,viewAuditLogs:!1},member:{manageOrganization:!1,manageMembers:!1,manageBilling:!1,viewAnalytics:!1,createWorkspaces:!1,manageWorkspace:!1,deleteWorkspace:!1,createProjects:!0,editProjects:!0,deleteProjects:!1,exportProjects:!0,shareProjects:!0,manageBrandKits:!1,manageTemplates:!1,manageIntegrations:!1,viewAuditLogs:!1},guest:{manageOrganization:!1,manageMembers:!1,manageBilling:!1,viewAnalytics:!1,createWorkspaces:!1,manageWorkspace:!1,deleteWorkspace:!1,createProjects:!1,editProjects:!1,deleteProjects:!1,exportProjects:!1,shareProjects:!1,manageBrandKits:!1,manageTemplates:!1,manageIntegrations:!1,viewAuditLogs:!1}}}static getInstance(){return r.instance||(r.instance=new r),r.instance}createOrganization(e,t){let a={id:`org_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:t.name,domain:t.domain,description:t.description,plan:"free",settings:this.getDefaultOrganizationSettings("free"),createdAt:new Date,updatedAt:new Date,isActive:!0};return this.organizations.set(a.id,a),this.addMember(a.id,e,"owner"),this.createWorkspace(a.id,{name:"Principal",description:"Workspace principal da organiza\xe7\xe3o"}),this.logAudit(a.id,e,"organization_created","organization",a.id,{name:a.name,plan:a.plan}),a}updateOrganization(e,t,a){let r=this.organizations.get(e);if(!r)return null;if(!this.hasPermission(t,e,"manageOrganization"))throw Error("Insufficient permissions to update organization");return Object.assign(r,a,{updatedAt:new Date}),this.organizations.set(e,r),this.logAudit(e,t,"organization_updated","organization",e,a),r}createWorkspace(e,t){let a=this.organizations.get(e);if(!a)throw Error("Organization not found");if(Array.from(this.workspaces.values()).filter(t=>t.organizationId===e&&!t.isArchived).length>=a.settings.maxWorkspaces)throw Error("Workspace limit reached for this organization plan");let r={id:`ws_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:t.name,description:t.description,organizationId:e,color:t.color||this.getRandomColor(),settings:{visibility:"organization",allowGuestAccess:!1,requireApprovalForGuests:!0,defaultProjectPermissions:"editProjects"},createdAt:new Date,updatedAt:new Date,isArchived:!1};return this.workspaces.set(r.id,r),Array.from(this.members.values()).filter(t=>t.organizationId===e&&"active"===t.status).forEach(e=>{this.grantWorkspaceAccess(r.id,e.userId,e.role)}),r}addMember(e,t,a="member"){let s={id:`member_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:t,organizationId:e,role:a,permissions:{...r.DEFAULT_PERMISSIONS[a]},joinedAt:new Date,status:"active",workspaces:[]};return this.members.set(s.id,s),Array.from(this.workspaces.values()).filter(t=>t.organizationId===e&&!t.isArchived).forEach(e=>{this.grantWorkspaceAccess(e.id,t,a)}),s}grantWorkspaceAccess(e,t,a){let s=this.workspaces.get(e);if(!s)return;let i=Array.from(this.members.values()).find(e=>e.userId===t&&e.organizationId===s.organizationId);if(!i)return;let n=i.workspaces.find(t=>t.workspaceId===e);n?(n.role=a,n.permissions={...r.DEFAULT_PERMISSIONS[a]}):i.workspaces.push({workspaceId:e,role:a,permissions:{...r.DEFAULT_PERMISSIONS[a]},grantedAt:new Date,grantedBy:i.userId})}createInvitation(e,t,a,r,s=[]){let i={id:`inv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,email:a,organizationId:e,invitedBy:t,role:r,workspaces:s,status:"pending",expiresAt:new Date(Date.now()+6048e5),createdAt:new Date};return this.invitations.set(i.id,i),this.logAudit(e,t,"invitation_created","invitation",i.id,{email:i.email,role:i.role}),i}acceptInvitation(e,t){let a=this.invitations.get(e);if(!a||"pending"!==a.status)return null;if(a.expiresAt<new Date)return a.status="expired",null;let r=this.addMember(a.organizationId,t,a.role);return a.status="accepted",a.acceptedAt=new Date,this.logAudit(a.organizationId,t,"invitation_accepted","invitation",e,{role:a.role}),r}hasPermission(e,t,a){let r=Array.from(this.members.values()).find(a=>a.userId===e&&a.organizationId===t&&"active"===a.status);return!!r&&!!r.permissions[a]}hasWorkspacePermission(e,t,a){let r=this.workspaces.get(t);if(!r)return!1;let s=Array.from(this.members.values()).find(t=>t.userId===e&&t.organizationId===r.organizationId&&"active"===t.status);if(!s)return!1;if(s.permissions[a])return!0;let i=s.workspaces.find(e=>e.workspaceId===t);return!!i&&!!i.permissions[a]}logAudit(e,t,a,r,s,i){let n=this.organizations.get(e);if(!n?.settings.security.auditLogging)return;let o={id:`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,organizationId:e,userId:t,action:a,resourceType:r,resourceId:s,details:i,timestamp:new Date};this.auditLogs.push(o),console.log("Audit Log:",o)}getDefaultOrganizationSettings(e){let t={free:{maxMembers:3,maxWorkspaces:1,maxProjectsPerWorkspace:5,maxStorageGB:1},starter:{maxMembers:10,maxWorkspaces:3,maxProjectsPerWorkspace:25,maxStorageGB:10},professional:{maxMembers:50,maxWorkspaces:10,maxProjectsPerWorkspace:100,maxStorageGB:100},enterprise:{maxMembers:500,maxWorkspaces:50,maxProjectsPerWorkspace:1e3,maxStorageGB:1e3}}[e];return{maxMembers:t.maxMembers,maxWorkspaces:t.maxWorkspaces,maxProjectsPerWorkspace:t.maxProjectsPerWorkspace,maxStorageGB:t.maxStorageGB,features:{collaboration:"free"!==e,brandKits:"free"!==e,apiAccess:"enterprise"===e,analytics:"free"!==e,customIntegrations:"enterprise"===e,prioritySupport:"enterprise"===e},security:{ssoEnabled:"enterprise"===e,twoFactorRequired:"enterprise"===e,dataRetentionDays:"enterprise"===e?2555:365,auditLogging:"free"!==e},billing:{autoRenew:!0}}}getRandomColor(){let e=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#6366f1"];return e[Math.floor(Math.random()*e.length)]}getOrganization(e){return this.organizations.get(e)||null}getOrganizationsForUser(e){return Array.from(this.members.values()).filter(t=>t.userId===e&&"active"===t.status).map(e=>e.organizationId).map(e=>this.organizations.get(e)).filter(Boolean)}getWorkspacesForOrganization(e){return Array.from(this.workspaces.values()).filter(t=>t.organizationId===e&&!t.isArchived)}getMembersForOrganization(e){return Array.from(this.members.values()).filter(t=>t.organizationId===e)}getUserPermissions(e,t){let a=Array.from(this.members.values()).find(a=>a.userId===e&&a.organizationId===t&&"active"===a.status);return a?a.permissions:null}getAuditLogs(e,t=100){return this.auditLogs.filter(t=>t.organizationId===e).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}constructor(){this.organizations=new Map,this.workspaces=new Map,this.members=new Map,this.invitations=new Map,this.auditLogs=[]}}let s=r.getInstance()}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1216],()=>a(31818));module.exports=r})();