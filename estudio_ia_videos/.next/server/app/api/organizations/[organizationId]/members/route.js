"use strict";(()=>{var e={};e.id=7339,e.ids=[7339],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},80846:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>g,serverHooks:()=>l,staticGenerationAsyncStorage:()=>u});var a={};r.r(a),r.d(a,{GET:()=>m,POST:()=>d});var s=r(49303),i=r(88716),n=r(60670),o=r(87070),c=r(67409);async function m(e,{params:t}){try{let{organizationId:r}=t,{searchParams:a}=new URL(e.url),s=a.get("userId");if(!s)return o.NextResponse.json({error:"User ID is required"},{status:400});if(!c.D0.getOrganizationsForUser(s).some(e=>e.id===r))return o.NextResponse.json({error:"Access denied"},{status:403});let i=c.D0.getMembersForOrganization(r);return o.NextResponse.json({success:!0,data:i})}catch(e){return console.error("Error fetching members:",e),o.NextResponse.json({error:"Failed to fetch members"},{status:500})}}async function d(e,{params:t}){try{let{organizationId:r}=t,{userId:a,inviteeId:s,role:i="member"}=await e.json();if(!a||!s)return o.NextResponse.json({error:"User ID and invitee ID are required"},{status:400});if(!c.D0.hasPermission(a,r,"manageMembers"))return o.NextResponse.json({error:"Insufficient permissions to add members"},{status:403});let n=c.D0.addMember(r,s,i);return o.NextResponse.json({success:!0,data:n},{status:201})}catch(e){return console.error("Error adding member:",e),o.NextResponse.json({error:e.message||"Failed to add member"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/organizations/[organizationId]/members/route",pathname:"/api/organizations/[organizationId]/members",filename:"route",bundlePath:"app/api/organizations/[organizationId]/members/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\organizations\\[organizationId]\\members\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:l}=g,h="/api/organizations/[organizationId]/members/route";function f(){return(0,n.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:u})}},67409:(e,t,r)=>{r.d(t,{D0:()=>s});class a{static{this.DEFAULT_PERMISSIONS={owner:{manageOrganization:!0,manageMembers:!0,manageBilling:!0,viewAnalytics:!0,createWorkspaces:!0,manageWorkspace:!0,deleteWorkspace:!0,createProjects:!0,editProjects:!0,deleteProjects:!0,exportProjects:!0,shareProjects:!0,manageBrandKits:!0,manageTemplates:!0,manageIntegrations:!0,viewAuditLogs:!0},admin:{manageOrganization:!1,manageMembers:!0,manageBilling:!1,viewAnalytics:!0,createWorkspaces:!0,manageWorkspace:!0,deleteWorkspace:!1,createProjects:!0,editProjects:!0,deleteProjects:!0,exportProjects:!0,shareProjects:!0,manageBrandKits:!0,manageTemplates:!0,manageIntegrations:!0,viewAuditLogs:!0},manager:{manageOrganization:!1,manageMembers:!1,manageBilling:!1,viewAnalytics:!1,createWorkspaces:!0,manageWorkspace:!0,deleteWorkspace:!1,createProjects:!0,editProjects:!0,deleteProjects:!1,exportProjects:!0,shareProjects:!0,manageBrandKits:!0,manageTemplates:!1,manageIntegrations:!1,viewAuditLogs:!1},member:{manageOrganization:!1,manageMembers:!1,manageBilling:!1,viewAnalytics:!1,createWorkspaces:!1,manageWorkspace:!1,deleteWorkspace:!1,createProjects:!0,editProjects:!0,deleteProjects:!1,exportProjects:!0,shareProjects:!0,manageBrandKits:!1,manageTemplates:!1,manageIntegrations:!1,viewAuditLogs:!1},guest:{manageOrganization:!1,manageMembers:!1,manageBilling:!1,viewAnalytics:!1,createWorkspaces:!1,manageWorkspace:!1,deleteWorkspace:!1,createProjects:!1,editProjects:!1,deleteProjects:!1,exportProjects:!1,shareProjects:!1,manageBrandKits:!1,manageTemplates:!1,manageIntegrations:!1,viewAuditLogs:!1}}}static getInstance(){return a.instance||(a.instance=new a),a.instance}createOrganization(e,t){let r={id:`org_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:t.name,domain:t.domain,description:t.description,plan:"free",settings:this.getDefaultOrganizationSettings("free"),createdAt:new Date,updatedAt:new Date,isActive:!0};return this.organizations.set(r.id,r),this.addMember(r.id,e,"owner"),this.createWorkspace(r.id,{name:"Principal",description:"Workspace principal da organiza\xe7\xe3o"}),this.logAudit(r.id,e,"organization_created","organization",r.id,{name:r.name,plan:r.plan}),r}updateOrganization(e,t,r){let a=this.organizations.get(e);if(!a)return null;if(!this.hasPermission(t,e,"manageOrganization"))throw Error("Insufficient permissions to update organization");return Object.assign(a,r,{updatedAt:new Date}),this.organizations.set(e,a),this.logAudit(e,t,"organization_updated","organization",e,r),a}createWorkspace(e,t){let r=this.organizations.get(e);if(!r)throw Error("Organization not found");if(Array.from(this.workspaces.values()).filter(t=>t.organizationId===e&&!t.isArchived).length>=r.settings.maxWorkspaces)throw Error("Workspace limit reached for this organization plan");let a={id:`ws_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:t.name,description:t.description,organizationId:e,color:t.color||this.getRandomColor(),settings:{visibility:"organization",allowGuestAccess:!1,requireApprovalForGuests:!0,defaultProjectPermissions:"editProjects"},createdAt:new Date,updatedAt:new Date,isArchived:!1};return this.workspaces.set(a.id,a),Array.from(this.members.values()).filter(t=>t.organizationId===e&&"active"===t.status).forEach(e=>{this.grantWorkspaceAccess(a.id,e.userId,e.role)}),a}addMember(e,t,r="member"){let s={id:`member_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:t,organizationId:e,role:r,permissions:{...a.DEFAULT_PERMISSIONS[r]},joinedAt:new Date,status:"active",workspaces:[]};return this.members.set(s.id,s),Array.from(this.workspaces.values()).filter(t=>t.organizationId===e&&!t.isArchived).forEach(e=>{this.grantWorkspaceAccess(e.id,t,r)}),s}grantWorkspaceAccess(e,t,r){let s=this.workspaces.get(e);if(!s)return;let i=Array.from(this.members.values()).find(e=>e.userId===t&&e.organizationId===s.organizationId);if(!i)return;let n=i.workspaces.find(t=>t.workspaceId===e);n?(n.role=r,n.permissions={...a.DEFAULT_PERMISSIONS[r]}):i.workspaces.push({workspaceId:e,role:r,permissions:{...a.DEFAULT_PERMISSIONS[r]},grantedAt:new Date,grantedBy:i.userId})}createInvitation(e,t,r,a,s=[]){let i={id:`inv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,email:r,organizationId:e,invitedBy:t,role:a,workspaces:s,status:"pending",expiresAt:new Date(Date.now()+6048e5),createdAt:new Date};return this.invitations.set(i.id,i),this.logAudit(e,t,"invitation_created","invitation",i.id,{email:i.email,role:i.role}),i}acceptInvitation(e,t){let r=this.invitations.get(e);if(!r||"pending"!==r.status)return null;if(r.expiresAt<new Date)return r.status="expired",null;let a=this.addMember(r.organizationId,t,r.role);return r.status="accepted",r.acceptedAt=new Date,this.logAudit(r.organizationId,t,"invitation_accepted","invitation",e,{role:r.role}),a}hasPermission(e,t,r){let a=Array.from(this.members.values()).find(r=>r.userId===e&&r.organizationId===t&&"active"===r.status);return!!a&&!!a.permissions[r]}hasWorkspacePermission(e,t,r){let a=this.workspaces.get(t);if(!a)return!1;let s=Array.from(this.members.values()).find(t=>t.userId===e&&t.organizationId===a.organizationId&&"active"===t.status);if(!s)return!1;if(s.permissions[r])return!0;let i=s.workspaces.find(e=>e.workspaceId===t);return!!i&&!!i.permissions[r]}logAudit(e,t,r,a,s,i){let n=this.organizations.get(e);if(!n?.settings.security.auditLogging)return;let o={id:`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,organizationId:e,userId:t,action:r,resourceType:a,resourceId:s,details:i,timestamp:new Date};this.auditLogs.push(o),console.log("Audit Log:",o)}getDefaultOrganizationSettings(e){let t={free:{maxMembers:3,maxWorkspaces:1,maxProjectsPerWorkspace:5,maxStorageGB:1},starter:{maxMembers:10,maxWorkspaces:3,maxProjectsPerWorkspace:25,maxStorageGB:10},professional:{maxMembers:50,maxWorkspaces:10,maxProjectsPerWorkspace:100,maxStorageGB:100},enterprise:{maxMembers:500,maxWorkspaces:50,maxProjectsPerWorkspace:1e3,maxStorageGB:1e3}}[e];return{maxMembers:t.maxMembers,maxWorkspaces:t.maxWorkspaces,maxProjectsPerWorkspace:t.maxProjectsPerWorkspace,maxStorageGB:t.maxStorageGB,features:{collaboration:"free"!==e,brandKits:"free"!==e,apiAccess:"enterprise"===e,analytics:"free"!==e,customIntegrations:"enterprise"===e,prioritySupport:"enterprise"===e},security:{ssoEnabled:"enterprise"===e,twoFactorRequired:"enterprise"===e,dataRetentionDays:"enterprise"===e?2555:365,auditLogging:"free"!==e},billing:{autoRenew:!0}}}getRandomColor(){let e=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#6366f1"];return e[Math.floor(Math.random()*e.length)]}getOrganization(e){return this.organizations.get(e)||null}getOrganizationsForUser(e){return Array.from(this.members.values()).filter(t=>t.userId===e&&"active"===t.status).map(e=>e.organizationId).map(e=>this.organizations.get(e)).filter(Boolean)}getWorkspacesForOrganization(e){return Array.from(this.workspaces.values()).filter(t=>t.organizationId===e&&!t.isArchived)}getMembersForOrganization(e){return Array.from(this.members.values()).filter(t=>t.organizationId===e)}getUserPermissions(e,t){let r=Array.from(this.members.values()).find(r=>r.userId===e&&r.organizationId===t&&"active"===r.status);return r?r.permissions:null}getAuditLogs(e,t=100){return this.auditLogs.filter(t=>t.organizationId===e).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,t)}constructor(){this.organizations=new Map,this.workspaces=new Map,this.members=new Map,this.invitations=new Map,this.auditLogs=[]}}let s=a.getInstance()}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1216],()=>r(80846));module.exports=a})();