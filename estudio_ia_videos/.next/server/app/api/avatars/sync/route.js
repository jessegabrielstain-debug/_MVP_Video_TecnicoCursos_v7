"use strict";(()=>{var e={};e.id=6961,e.ids=[6961],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57147:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>f,patchFetch:()=>y,requestAsyncStorage:()=>v,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var r={};t.r(r),t.d(r,{GET:()=>d,POST:()=>m});var s=t(49303),n=t(88716),o=t(60670),i=t(87070);class c{static getInstance(){return this.instance||(this.instance=new c),this.instance}logEvent(e,a){console.log(`ðŸ“Š [${e}]`,a)}}class u{static getInstance(){return this.instance||(this.instance=new u),this.instance}async processAudio(e,a){await new Promise(e=>setTimeout(e,2e3));let t=Math.floor(5*(a.frameRate||30));return{jobId:`lipsync_${Date.now()}`,duration:5e3,frameRate:a.frameRate,visemeFrames:Array.from({length:t},(e,t)=>({time:t/(a.frameRate||30),viseme:"A",intensity:Math.random()})),phonemeSegments:[],blendShapeFrames:[],emotionFrames:[],breathingEvents:[],microExpressionEvents:[],qualityMetrics:{overallAccuracy:.95,lipSyncAccuracy:.93,emotionAccuracy:.87},stats:{processingTime:2e3,audioLength:5e3}}}}class l{static getInstance(){return this.instance||(this.instance=new l),this.instance}async getAvailableAvatars(){return[{id:"default-male",name:"Default Male Avatar",type:"male",blendShapes:["A","E","I","O","U"]},{id:"default-female",name:"Default Female Avatar",type:"female",blendShapes:["A","E","I","O","U"]}]}async loadAvatar(e){await new Promise(e=>setTimeout(e,500));let a=(await this.getAvailableAvatars()).find(a=>a.id===e);if(!a)throw Error(`Avatar ${e} not found`);return a}getRenderStats(){return{totalRenders:150,averageRenderTime:2500,successRate:.98,lastRender:new Date().toISOString()}}}async function m(e){let a=c.getInstance(),t=Date.now();try{let r,s;let{audioUrl:n,audioBuffer:o,avatarId:c="default-male",language:m="pt-BR",frameRate:d=30,enableEmotionDetection:p=!0,enableBreathingDetection:v=!0,enableMicroExpressions:g=!0,smoothingFactor:h=.8,qualityLevel:f="high",userId:y}=await e.json();if(!n&&!o)return i.NextResponse.json({error:"audioUrl ou audioBuffer \xe9 obrigat\xf3rio"},{status:400});a.logEvent("avatar_sync_request",{userId:y,avatarId:c,language:m,frameRate:d,qualityLevel:f});let E=u.getInstance(),A=l.getInstance();if(o)r=new Uint8Array(o).buffer;else{let e=await fetch(n);if(!e.ok)throw Error(`Erro ao baixar \xe1udio: ${e.statusText}`);r=await e.arrayBuffer()}let R=await E.processAudio(r,{sampleRate:44100,frameRate:d,language:m,enableEmotionDetection:p,enableBreathingDetection:v,enableMicroExpressions:g,smoothingFactor:h,qualityLevel:f});if(!(await A.getAvailableAvatars()).find(e=>e.id===c))return i.NextResponse.json({error:`Avatar ${c} n\xe3o encontrado`},{status:404});try{s=await A.loadAvatar(c)}catch(e){return console.error("Erro ao carregar avatar:",e),i.NextResponse.json({error:"Erro ao carregar avatar 3D"},{status:500})}return a.logEvent("avatar_sync_success",{userId:y,avatarId:c,duration:R.duration,processingTime:Date.now()-t,visemeFrames:R.visemeFrames.length,accuracy:R.qualityMetrics.overallAccuracy}),i.NextResponse.json({success:!0,data:{jobId:R.jobId,avatarId:c,duration:R.duration,frameRate:R.frameRate,visemeFrames:R.visemeFrames,phonemeSegments:R.phonemeSegments,blendShapeFrames:R.blendShapeFrames,emotionFrames:R.emotionFrames,breathingEvents:R.breathingEvents,microExpressionEvents:R.microExpressionEvents,qualityMetrics:R.qualityMetrics,avatar:{id:s.id,name:s.name,type:s.type,blendShapes:s.blendShapes},performance:{processingTime:Date.now()-t,stats:R.stats}}})}catch(e){return a.logEvent("avatar_sync_error",{error:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0,processingTime:Date.now()-t}),console.error("Erro na sincroniza\xe7\xe3o do avatar:",e),i.NextResponse.json({error:"Erro interno do servidor",message:e instanceof Error?e.message:"Unknown error",code:"AVATAR_SYNC_ERROR"},{status:500})}}async function d(e){try{let e=l.getInstance();u.getInstance();let a=await e.getAvailableAvatars(),t=e.getRenderStats();return i.NextResponse.json({success:!0,data:{availableAvatars:a,renderStats:t,supportedLanguages:["pt-BR","en-US","es-ES","fr-FR"],supportedFrameRates:[24,30,60],qualityLevels:["low","medium","high"],features:{emotionDetection:!0,breathingDetection:!0,microExpressions:!0,realTimeProcessing:!0}}})}catch(e){return console.error("Erro ao obter informa\xe7\xf5es dos avatares:",e),i.NextResponse.json({error:"Erro ao obter informa\xe7\xf5es",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/avatars/sync/route",pathname:"/api/avatars/sync",filename:"route",bundlePath:"app/api/avatars/sync/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\avatars\\sync\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:v,staticGenerationAsyncStorage:g,serverHooks:h}=p,f="/api/avatars/sync/route";function y(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[8948,5972],()=>t(57147));module.exports=r})();