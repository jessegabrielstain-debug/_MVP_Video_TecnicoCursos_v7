"use strict";(()=>{var e={};e.id=5798,e.ids=[5798],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},19801:e=>{e.exports=require("os")},16110:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>w,requestAsyncStorage:()=>d,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var a={};r.r(a),r.d(a,{GET:()=>h});var s=r(49303),n=r(88716),o=r(60670),i=r(87070),c=r(16482),l=r(78119),u=r(26815);async function h(e){try{let e=c.qI.getSystemMetrics();await u.w.getStats();let t=await u.w.healthCheck();c.qI.getSummary();let r={redis:{status:t.healthy?"healthy":"unhealthy",score:t.healthy?100:0,latency:t.latency||0},memory:{status:e.memory.percentage<80?"healthy":"warning",score:Math.max(0,100-e.memory.percentage),usage:e.memory.percentage}},a=Math.round((r.redis.score+r.memory.score)/2);return i.NextResponse.json({timestamp:new Date().toISOString(),status:a>=80?"healthy":a>=60?"warning":"critical",score:a,health:r,system:{uptime:process.uptime(),nodeVersion:process.version,platform:process.platform}})}catch(e){return l.kg.error("Dashboard generation failed",e instanceof Error?e:Error(String(e))),i.NextResponse.json({timestamp:new Date().toISOString(),status:"error",score:0,error:"Failed to generate dashboard data"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/monitoring/dashboard/route",pathname:"/api/monitoring/dashboard",filename:"route",bundlePath:"app/api/monitoring/dashboard/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\monitoring\\dashboard\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:g}=m,y="/api/monitoring/dashboard/route";function w(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},26815:(e,t,r)=>{r.d(t,{w:()=>s});class a{async connect(){return console.log("[Cache] Using in-memory fallback (Redis not configured)"),this.connected=!0,!0}async set(e,t,r){let a=r?Date.now()+1e3*r:void 0;this.cache.set(e,{value:t,expiresAt:a})}async get(e){let t=this.cache.get(e);return t?t.expiresAt&&Date.now()>t.expiresAt?(this.cache.delete(e),null):t.value:null}async del(e){return this.cache.delete(e)}async clear(){this.cache.clear()}async keys(e){let t=Array.from(this.cache.keys());if(!e)return t;let r=new RegExp(e.replace(/\*/g,".*"));return t.filter(e=>r.test(e))}async getStats(){let e=Date.now(),t=0;for(let[r,a]of this.cache.entries())a.expiresAt&&a.expiresAt<e&&(t+=1);return{connected:this.connected,keys:this.cache.size,expired:t}}async healthCheck(){let e=Date.now();return this.connected||await this.connect(),{healthy:this.connected,latency:Date.now()-e,timestamp:new Date().toISOString()}}constructor(){this.cache=new Map,this.connected=!1}}let s=new a},78119:(e,t,r)=>{var a;r.d(t,{cM:()=>n,kg:()=>o}),function(e){e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(a||(a={}));class s{constructor(e){this.context=e}debug(e,t){console.debug(`[${this.context}] ${e}`,t)}info(e,t){console.info(`[${this.context}] ${e}`,t)}warn(e,t){console.warn(`[${this.context}] ${e}`,t)}error(e,t,r){console.error(`[${this.context}] ${e}`,t,r)}security(e,t){console.warn(`[SECURITY][${this.context}] ${e}`,t)}apiRequest(e,t,r,a){this.info(`API Request: ${e} ${t}`,{duration:r,status:a})}}let n=new s("default"),o=n},16482:(e,t,r)=>{r.d(t,{WZ:()=>o,qI:()=>i});var a=r(19801),s=r.n(a);class n{record(e,t,r){this.metrics.push({name:e,value:t,timestamp:new Date,tags:r})}getMetrics(e){return e?this.metrics.filter(t=>t.name===e):[...this.metrics]}getSystemMetrics(){let e=process.memoryUsage(),t=e.heapTotal||1,r=s().loadavg?.()[0]??0;return{memory:{used:e.heapUsed,total:t,percentage:Number((e.heapUsed/t*100).toFixed(2))},cpu:{load:Number(r.toFixed(2)),cores:s().cpus().length,uptime:s().uptime()},requests:{total:this.metrics.filter(e=>e.name.startsWith("request_")).length,lastMinute:this.metrics.filter(e=>e.timestamp.getTime()>=Date.now()-6e4).length}}}getSummary(){let e=Object.values(this.metrics.reduce((e,t)=>{let r=e[t.name]??{name:t.name,count:0,average:0,lastValue:0};return r.count+=1,r.average+=t.value,r.lastValue=t.value,e[t.name]=r,e},{})).map(e=>({name:e.name,count:e.count,average:Number((e.average/e.count).toFixed(2)),lastValue:e.lastValue}));return{totalMetrics:this.metrics.length,lastUpdated:this.metrics.at(-1)?.timestamp??null,metrics:e}}clear(){this.metrics=[]}constructor(){this.metrics=[]}}let o=new n,i=o}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>r(16110));module.exports=a})();