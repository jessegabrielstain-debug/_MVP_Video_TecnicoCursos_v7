"use strict";(()=>{var e={};e.id=8416,e.ids=[8416],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},60980:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>b,patchFetch:()=>R,requestAsyncStorage:()=>v,routeModule:()=>h,serverHooks:()=>S,staticGenerationAsyncStorage:()=>f});var a={};s.r(a),s.d(a,{GET:()=>m,POST:()=>p,PUT:()=>d});var r=s(49303),n=s(88716),o=s(60670),i=s(87070);class c{static getInstance(){return this.instance||(this.instance=new c),this.instance}logEvent(e,t){console.log(`ðŸ“Š [${e}]`,t)}}class u{static getInstance(){return this.instance||(this.instance=new u),this.instance}getStats(){return{currentLoad:.3,successRate:.95,queueLength:5,totalJobs:150,completedJobs:142,failedJobs:3,averageProcessingTime:25e3}}getJobsByUser(e){return this.jobs.filter(t=>t.userId===e)}constructor(){this.jobs=[]}}class g{static getInstance(){return this.instance||(this.instance=new g),this.instance}getStats(){return{totalRequests:500,successfulRequests:485,failedRequests:15,averageResponseTime:2500,activeEngines:["elevenlabs","azure","google"],engineStats:{elevenlabs:{requests:200,success:195,avgTime:2200},azure:{requests:180,success:175,avgTime:2800},google:{requests:120,success:115,avgTime:2600}}}}}class l{static getInstance(){return this.instance||(this.instance=new l),this.instance}getRenderStats(){return{totalRenders:150,averageRenderTime:2500,successRate:.98,lastRender:new Date().toISOString()}}async getAvailableAvatars(){return[{id:"default-male",name:"Default Male Avatar",type:"male"},{id:"default-female",name:"Default Female Avatar",type:"female"}]}}async function m(e){try{let{searchParams:t}=new URL(e.url),s=t.get("type")||"all",a=t.get("timeRange")||"1h",r=t.get("userId");c.getInstance();let n=u.getInstance(),o=g.getInstance(),m=l.getInstance(),p={};switch(s){case"system":p={system:{uptime:process.uptime(),memory:process.memoryUsage(),cpu:process.cpuUsage(),timestamp:new Date().toISOString()}};break;case"pipeline":p={pipeline:n.getStats()};break;case"tts":p={tts:o.getStats()};break;case"avatar":p={avatar:{renderStats:m.getRenderStats(),availableAvatars:await m.getAvailableAvatars()}};break;case"performance":p={performance:{pipeline:n.getStats(),tts:o.getStats(),avatar:m.getRenderStats(),system:{uptime:process.uptime(),memory:process.memoryUsage(),cpu:process.cpuUsage()}}};break;case"user":if(!r)return i.NextResponse.json({error:"userId \xe9 obrigat\xf3rio para m\xe9tricas de usu\xe1rio"},{status:400});let d=n.getJobsByUser(r);p={user:{totalJobs:d.length,completedJobs:d.filter(e=>"completed"===e.status).length,failedJobs:d.filter(e=>"failed"===e.status).length,activeJobs:d.filter(e=>"processing"===e.status).length,queuedJobs:d.filter(e=>"queued"===e.status).length,averageProcessingTime:d.filter(e=>e.actualDuration).reduce((e,t)=>e+(t.actualDuration||0),0)/Math.max(1,d.filter(e=>e.actualDuration).length),recentJobs:d.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()).slice(0,10)}};break;case"alerts":let h=n.getStats(),v=[];h.currentLoad>.8&&v.push({id:"high_load",type:"warning",message:"Alta carga no pipeline",value:h.currentLoad,threshold:.8,timestamp:new Date().toISOString()}),h.successRate<.9&&v.push({id:"low_success_rate",type:"error",message:"Taxa de sucesso baixa",value:h.successRate,threshold:.9,timestamp:new Date().toISOString()}),h.queueLength>50&&v.push({id:"long_queue",type:"warning",message:"Fila muito longa",value:h.queueLength,threshold:50,timestamp:new Date().toISOString()}),p={alerts:v};break;default:p={system:{uptime:process.uptime(),memory:process.memoryUsage(),cpu:process.cpuUsage(),timestamp:new Date().toISOString()},pipeline:n.getStats(),tts:o.getStats(),avatar:{renderStats:m.getRenderStats(),availableAvatars:await m.getAvailableAvatars()}}}return i.NextResponse.json({success:!0,data:p,metadata:{type:s,timeRange:a,timestamp:new Date().toISOString()}})}catch(e){return console.error("Erro ao obter m\xe9tricas:",e),i.NextResponse.json({error:"Erro ao obter m\xe9tricas",message:e instanceof Error?e.message:String(e)},{status:500})}}async function p(e){try{let{event:t,data:s,userId:a}=await e.json();if(!t)return i.NextResponse.json({error:"event \xe9 obrigat\xf3rio"},{status:400});return c.getInstance().logEvent(t,{...s,userId:a,timestamp:new Date().toISOString(),source:"api"}),i.NextResponse.json({success:!0,message:"Evento registrado com sucesso",data:{event:t,timestamp:new Date().toISOString()}})}catch(e){return console.error("Erro ao registrar evento:",e),i.NextResponse.json({error:"Erro ao registrar evento",message:e instanceof Error?e.message:String(e)},{status:500})}}async function d(e){try{let{action:t,config:s}=await e.json();switch(c.getInstance(),t){case"configure":return s.alerts&&console.log("Configurando alertas:",s.alerts),s.thresholds&&console.log("Configurando thresholds:",s.thresholds),i.NextResponse.json({success:!0,message:"Configura\xe7\xe3o atualizada com sucesso",data:{config:s}});case"reset":return console.log("Reset de m\xe9tricas solicitado"),i.NextResponse.json({success:!0,message:"M\xe9tricas resetadas com sucesso"});default:return i.NextResponse.json({error:"A\xe7\xe3o n\xe3o reconhecida. Use: configure ou reset"},{status:400})}}catch(e){return console.error("Erro ao configurar monitoramento:",e),i.NextResponse.json({error:"Erro ao configurar monitoramento",message:e instanceof Error?e.message:String(e)},{status:500})}}let h=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/monitoring/metrics/route",pathname:"/api/monitoring/metrics",filename:"route",bundlePath:"app/api/monitoring/metrics/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\monitoring\\metrics\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:v,staticGenerationAsyncStorage:f,serverHooks:S}=h,b="/api/monitoring/metrics/route";function R(){return(0,o.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>s(60980));module.exports=a})();