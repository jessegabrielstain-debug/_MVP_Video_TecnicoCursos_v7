"use strict";(()=>{var e={};e.id=8873,e.ids=[8873],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},637176:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p});var o={};t.r(o),t.d(o,{GET:()=>c,POST:()=>u});var s=t(349303),n=t(88716),a=t(60670),i=t(387070);async function u(e){try{let{email:r,password:t,rememberMe:o}=await e.json();if(!r||!t)return i.NextResponse.json({error:"Email e senha s\xe3o obrigat\xf3rios"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return i.NextResponse.json({error:"Formato de email inv\xe1lido"},{status:400});let s=await Object(function(){var e=Error("Cannot find module '@/lib/auth/auth-service'");throw e.code="MODULE_NOT_FOUND",e}()).login(r.toLowerCase(),t,e),n=i.NextResponse.json({success:!0,user:{id:s.user.id,email:s.user.email,name:s.user.name,avatar:s.user.avatar,role:s.user.role,permissions:s.user.permissions,preferences:s.user.preferences},expiresAt:s.expiresAt});return Object(function(){var e=Error("Cannot find module '@/lib/auth/auth-middleware'");throw e.code="MODULE_NOT_FOUND",e}()).setAuthCookies(n,s.accessToken,s.refreshToken),console.log(`Login successful for user: ${r} at ${new Date().toISOString()}`),n}catch(o){console.error("Login error:",o);let r=o instanceof Error?o.message:"Erro interno do servidor",{email:t}=await e.json().catch(()=>({}));return t&&console.warn(`Failed login attempt for: ${t} at ${new Date().toISOString()}`),i.NextResponse.json({error:r},{status:401})}}async function c(e){try{let r=e.cookies.get("auth-token")?.value;if(!r)return i.NextResponse.json({authenticated:!1},{status:401});let t=await Object(function(){var e=Error("Cannot find module '@/lib/auth/auth-service'");throw e.code="MODULE_NOT_FOUND",e}()).getUserFromToken(r);if(!t)return i.NextResponse.json({authenticated:!1},{status:401});return i.NextResponse.json({authenticated:!0,user:{id:t.id,email:t.email,name:t.name,avatar:t.avatar,role:t.role,permissions:t.permissions,preferences:t.preferences}})}catch(e){return console.error("Auth check error:",e),i.NextResponse.json({authenticated:!1},{status:401})}}(function(){var e=Error("Cannot find module '@/lib/auth/auth-service'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/auth/auth-middleware'");throw e.code="MODULE_NOT_FOUND",e}();let d=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:h}=d,m="/api/auth/login/route";function f(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[8948,5972],()=>t(637176));module.exports=o})();