"use strict";(()=>{var e={};e.id=3483,e.ids=[3483],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},466697:(e,o,r)=>{r.r(o),r.d(o,{originalPathname:()=>v,patchFetch:()=>N,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var t={};r.r(t),r.d(t,{DELETE:()=>p,GET:()=>d,PATCH:()=>c,POST:()=>u});var a=r(349303),n=r(88716),s=r(60670),i=r(387070);async function u(e){try{let o=await e.formData(),r=o.get("file"),t=o.get("userId"),a=o.get("roomId"),n="true"===o.get("enableNotifications");if(!r)return i.NextResponse.json({error:"Nenhum arquivo fornecido"},{status:400});if(r.size>104857600)return i.NextResponse.json({error:"Arquivo muito grande. M\xe1ximo 100MB permitido."},{status:400});if(!["video/mp4","video/webm","video/quicktime","image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(r.type))return i.NextResponse.json({error:"Tipo de arquivo n\xe3o suportado"},{status:400});let s=Object(function(){var e=Error("Cannot find module '../../../lib/notifications/notification-manager'");throw e.code="MODULE_NOT_FOUND",e}()).getInstance();n&&t&&a&&(s.getRoom(a)||s.createRoom(a,`Sala de Upload - ${t}`),s.joinRoom(a,t));let u=Object(function(){var e=Error("Cannot find module '../../../lib/upload/upload-manager'");throw e.code="MODULE_NOT_FOUND",e}())(),d=await u.uploadFile(r,"/api/storage/upload",{enableNotifications:n,userId:t,roomId:a,chunkSize:5242880,maxRetries:3,enableCompression:!0,compressionQuality:.8,metadata:{originalName:r.name,uploadedBy:t,uploadedAt:new Date().toISOString(),mimeType:r.type,size:r.size}});return i.NextResponse.json({success:!0,data:d,message:"Upload conclu\xeddo com sucesso"})}catch(e){return console.error("Erro no upload:",e),i.NextResponse.json({error:"Erro interno do servidor",message:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function d(e){try{let{searchParams:o}=new URL(e.url),r=o.get("uploadId");if(!r)return i.NextResponse.json({error:"ID do upload \xe9 obrigat\xf3rio"},{status:400});let t=Object(function(){var e=Error("Cannot find module '../../../lib/upload/upload-manager'");throw e.code="MODULE_NOT_FOUND",e}())(),a=t.getUploadProgress(r),n=t.getActiveUploads();return i.NextResponse.json({success:!0,data:{progress:a,isActive:n.includes(r),activeUploads:n.length}})}catch(e){return console.error("Erro ao buscar progresso:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function c(e){try{let{searchParams:o}=new URL(e.url),r=o.get("uploadId"),t=o.get("action");if(!r||!t)return i.NextResponse.json({error:"ID do upload e a\xe7\xe3o s\xe3o obrigat\xf3rios"},{status:400});let a=Object(function(){var e=Error("Cannot find module '../../../lib/upload/upload-manager'");throw e.code="MODULE_NOT_FOUND",e}())(),n=!1;switch(t){case"pause":n=await a.pauseUpload(r);break;case"resume":n=await a.resumeUpload(r);break;case"cancel":n=await a.cancelUpload(r);break;default:return i.NextResponse.json({error:"A\xe7\xe3o inv\xe1lida. Use: pause, resume ou cancel"},{status:400})}if(!n)return i.NextResponse.json({error:"Upload n\xe3o encontrado ou a\xe7\xe3o n\xe3o p\xf4de ser executada"},{status:404});return i.NextResponse.json({success:!0,message:`Upload ${"resume"===t?"retomado":"pause"===t?"pausado":"cancelado"} com sucesso`,data:"object"==typeof n?n:{uploadId:r,action:t}})}catch(e){return console.error("Erro na a\xe7\xe3o do upload:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function p(e){try{let{searchParams:o}=new URL(e.url),r=o.get("uploadId");if(!r)return i.NextResponse.json({error:"ID do upload \xe9 obrigat\xf3rio"},{status:400});let t=Object(function(){var e=Error("Cannot find module '../../../lib/upload/upload-manager'");throw e.code="MODULE_NOT_FOUND",e}())();if(!await t.cancelUpload(r))return i.NextResponse.json({error:"Upload n\xe3o encontrado"},{status:404});return i.NextResponse.json({success:!0,message:"Upload cancelado e removido com sucesso"})}catch(e){return console.error("Erro ao deletar upload:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}(function(){var e=Error("Cannot find module '../../../lib/upload/upload-manager'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '../../../lib/notifications/notification-manager'");throw e.code="MODULE_NOT_FOUND",e}();let l=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/upload-with-notifications/route",pathname:"/api/upload-with-notifications",filename:"route",bundlePath:"app/api/upload-with-notifications/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\upload-with-notifications\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:g}=l,v="/api/upload-with-notifications/route";function N(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}}};var o=require("../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[8948,5972],()=>r(466697));module.exports=t})();