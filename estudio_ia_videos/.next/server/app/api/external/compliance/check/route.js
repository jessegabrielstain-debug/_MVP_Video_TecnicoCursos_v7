"use strict";(()=>{var e={};e.id=5585,e.ids=[5585],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},61212:e=>{e.exports=require("async_hooks")},78893:e=>{e.exports=require("buffer")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},27920:e=>{e.exports=require("diagnostics_channel")},80665:e=>{e.exports=require("dns")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},85807:e=>{e.exports=require("module")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},96119:e=>{e.exports=require("perf_hooks")},35816:e=>{e.exports=require("process")},68621:e=>{e.exports=require("punycode")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},74175:e=>{e.exports=require("tty")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},17718:e=>{e.exports=require("node:child_process")},65714:e=>{e.exports=require("node:diagnostics_channel")},15673:e=>{e.exports=require("node:events")},87561:e=>{e.exports=require("node:fs")},88849:e=>{e.exports=require("node:http")},22286:e=>{e.exports=require("node:https")},85690:e=>{e.exports=require("node:inspector")},82033:e=>{e.exports=require("node:module")},87503:e=>{e.exports=require("node:net")},70612:e=>{e.exports=require("node:os")},49411:e=>{e.exports=require("node:path")},51747:e=>{e.exports=require("node:readline")},84492:e=>{e.exports=require("node:stream")},31764:e=>{e.exports=require("node:tls")},47261:e=>{e.exports=require("node:util")},24086:e=>{e.exports=require("node:worker_threads")},65628:e=>{e.exports=require("node:zlib")},1385:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>q,patchFetch:()=>f,requestAsyncStorage:()=>y,routeModule:()=>g,serverHooks:()=>v,staticGenerationAsyncStorage:()=>_});var n={};r.r(n),r.d(n,{POST:()=>x});var o=r(49303),s=r(88716),i=r(60670),a=r(87070),c=r(75571),p=r(95306),d=r(60354),l=r(91585),u=r(26033);let h=l.Ry({content_type:l.Km(["text","image","video","audio","document"]),content_url:l.Z_().url().optional(),content_text:l.Z_().optional(),check_types:l.IX(l.Km(["accessibility","content_rating","copyright","privacy"])).min(1),metadata:l.Ry({title:l.Z_().optional(),description:l.Z_().optional(),language:l.Z_().default("en"),target_audience:l.Km(["general","children","teens","adults"]).default("general")}).optional()});class m{static async performChecks(e){let t={overall_score:0,passed:!0,checks:{}},r=0,n=0;for(let o of e.check_types){let s;switch(o){case"accessibility":s=await this.checkAccessibility(e);break;case"content_rating":s=await this.checkContentRating(e);break;case"copyright":s=await this.checkCopyright(e);break;case"privacy":s=await this.checkPrivacy(e);break;default:continue}s&&(t.checks[o]=s,r+=s.score,n++,s.passed||(t.passed=!1))}return t.overall_score=n>0?Math.round(r/n):0,t}static async checkAccessibility(e){let t=[],r=100;return"image"!==e.content_type||e.metadata?.description||(t.push("Missing alt text for image"),r-=20),"video"===e.content_type&&Math.random()>.7&&(t.push("Missing captions for video content"),r-=30),e.content_text&&e.content_text.split(" ").length/(e.content_text.split(".").length||1)>20&&(t.push("Text may be difficult to read - consider shorter sentences"),r-=10),("image"===e.content_type||"video"===e.content_type)&&Math.random()>.8&&(t.push("Content may rely on color alone to convey information"),r-=15),{type:"accessibility",passed:r>=70,score:Math.max(0,r),issues:t,recommendations:this.getAccessibilityRecommendations(t),wcag_level:r>=90?"AAA":r>=70?"AA":"A"}}static async checkContentRating(e){let t=[],r=100,n="G";if(e.content_text){let o=e.content_text.toLowerCase(),s=["violence","explicit","adult","mature"].filter(e=>o.includes(e));s.length>0&&(t.push(`Potentially inappropriate content detected: ${s.join(", ")}`),r-=20*s.length,n=s.length>2?"R":"PG-13");let i=["politics","religion","controversial"].filter(e=>o.includes(e));i.length>0&&(t.push(`Sensitive topics detected: ${i.join(", ")}`),r-=10*i.length,"G"===n&&(n="PG"))}return e.metadata?.target_audience==="children"&&"G"!==n&&(t.push("Content may not be suitable for children"),r-=30),{type:"content_rating",passed:r>=70,score:Math.max(0,r),rating:n,flags:t,recommendations:this.getContentRatingRecommendations(t,e.metadata?.target_audience),suitable_for_children:"G"===n}}static async checkCopyright(e){let t=[],r=100;if(e.content_url&&Math.random()>.9&&(t.push("Potential copyright violation detected in media content"),r-=50),e.content_text){let n=e.content_text.toLowerCase();(n.includes("copyright")||n.includes("\xa9")||n.includes("all rights reserved"))&&(r+=10),Math.random()>.85&&(t.push("Potential plagiarized content detected"),r-=40)}let n=e.metadata?.description?.includes("source:")||e.metadata?.description?.includes("credit:");return!n&&e.content_url&&(t.push("Missing proper attribution for external content"),r-=20),{type:"copyright",passed:r>=70,score:Math.max(0,r),violations:t,recommendations:this.getCopyrightRecommendations(t),requires_attribution:!n&&e.content_url,fair_use_likely:r>=80}}static async checkPrivacy(e){let t=[],r=100;if(e.content_text){let n=e.content_text.toLowerCase();[/\b\d{3}-\d{2}-\d{4}\b/,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/,/\b\d{3}-\d{3}-\d{4}\b/,/\b\d{4}\s?\d{4}\s?\d{4}\s?\d{4}\b/].forEach((e,o)=>{e.test(n)&&(t.push(`Potential ${["Social Security Number","Email Address","Phone Number","Credit Card Number"][o]} detected in content`),r-=30)});let o=["address","birthday","age","location","personal"].filter(e=>n.includes(e));o.length>0&&(t.push(`Personal information keywords detected: ${o.join(", ")}`),r-=10*o.length)}return!(e.metadata?.description?.includes("privacy")||e.metadata?.description?.includes("gdpr")||e.metadata?.description?.includes("data protection"))&&t.length>0&&(t.push("Missing privacy notice for content containing personal data"),r-=20),{type:"privacy",passed:r>=70,score:Math.max(0,r),concerns:t,recommendations:this.getPrivacyRecommendations(t),gdpr_compliant:r>=80,requires_consent:t.some(e=>e.includes("Personal information")||e.includes("detected in content"))}}static getAccessibilityRecommendations(e){let t=[];return e.some(e=>e.includes("alt text"))&&t.push("Add descriptive alt text to all images"),e.some(e=>e.includes("captions"))&&t.push("Provide captions or transcripts for video content"),e.some(e=>e.includes("sentences"))&&t.push("Use shorter, clearer sentences for better readability"),e.some(e=>e.includes("color"))&&t.push("Ensure information is not conveyed by color alone"),t}static getContentRatingRecommendations(e,t){let r=[];return e.some(e=>e.includes("inappropriate"))&&r.push("Review and remove inappropriate language or content"),e.some(e=>e.includes("sensitive"))&&r.push("Consider adding content warnings for sensitive topics"),"children"===t&&e.length>0&&r.push("Ensure all content is appropriate for the target age group"),r}static getCopyrightRecommendations(e){let t=[];return e.some(e=>e.includes("copyright violation"))&&t.push("Replace copyrighted content with original or licensed material"),e.some(e=>e.includes("plagiarized"))&&t.push("Rewrite content in your own words or properly cite sources"),e.some(e=>e.includes("attribution"))&&t.push("Add proper attribution and source credits"),t}static getPrivacyRecommendations(e){let t=[];return e.some(e=>e.includes("detected in content"))&&t.push("Remove or anonymize personal information"),e.some(e=>e.includes("keywords"))&&t.push("Review content for unnecessary personal information"),e.some(e=>e.includes("privacy notice"))&&t.push("Add privacy notice and data handling information"),t}}async function x(e){try{let t=await (0,c.getServerSession)(p.L);if(!t?.user)return a.NextResponse.json({success:!1,error:"Authentication required"},{status:401});let r=await e.json(),n=h.parse(r);if(!n.content_url&&!n.content_text)return a.NextResponse.json({success:!1,error:"Either content_url or content_text must be provided"},{status:400});let o=await m.performChecks(n),s=.05*n.check_types.length;try{await d.pR.from("external_api_usage").insert({user_id:t.user.id,api_type:"compliance",provider_id:"nr-compliance",requests_made:1,cost:s,metadata:{content_type:n.content_type,check_types:n.check_types,overall_score:o.overall_score,passed:o.passed},created_at:new Date().toISOString()})}catch(e){console.warn("Failed to log compliance check usage:",e)}try{await d.pR.from("analytics_events").insert({user_id:t.user.id,event_type:"external_api_compliance_check",event_data:{category:"external_apis",action:"compliance_checked",content_type:n.content_type,check_types:n.check_types,overall_score:o.overall_score,passed:o.passed,cost:s}})}catch(e){console.warn("Failed to log compliance check:",e)}return a.NextResponse.json({success:!0,data:{...o,cost:s,content_type:n.content_type,check_types:n.check_types,checked_at:new Date().toISOString()},message:"Compliance check completed successfully"})}catch(e){if(console.error("Compliance check API error:",e),e instanceof u.jm)return a.NextResponse.json({success:!1,error:"Invalid request parameters",details:e.errors},{status:400});return a.NextResponse.json({success:!1,error:"Failed to perform compliance check",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/external/compliance/check/route",pathname:"/api/external/compliance/check",filename:"route",bundlePath:"app/api/external/compliance/check/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\external\\compliance\\check\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:_,serverHooks:v}=g,q="/api/external/compliance/check/route";function f(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:_})}},95306:(e,t,r)=>{r.d(t,{L:()=>n});let n={providers:[],session:{strategy:"jwt"},callbacks:{}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972,1657,9702,5571,9092,7686,1585,6608,3595],()=>r(1385));module.exports=n})();