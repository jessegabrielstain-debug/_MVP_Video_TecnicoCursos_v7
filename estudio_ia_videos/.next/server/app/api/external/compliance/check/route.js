(()=>{var e={};e.id=5585,e.ids=[5585],e.modules={150673:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=150673,e.exports=t},636372:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=636372,e.exports=t},367696:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=367696,e.exports=t},768626:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=768626,e.exports=t},572934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},554580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},345869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},220399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},627790:e=>{"use strict";e.exports=require("assert")},978893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},532615:e=>{"use strict";e.exports=require("http")},735240:e=>{"use strict";e.exports=require("https")},768621:e=>{"use strict";e.exports=require("punycode")},986624:e=>{"use strict";e.exports=require("querystring")},276162:e=>{"use strict";e.exports=require("stream")},917360:e=>{"use strict";e.exports=require("url")},521764:e=>{"use strict";e.exports=require("util")},671568:e=>{"use strict";e.exports=require("zlib")},601385:(e,t,n)=>{"use strict";n.r(t),n.d(t,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>y,routeModule:()=>_,serverHooks:()=>v,staticGenerationAsyncStorage:()=>g});var r={};n.r(r),n.d(r,{POST:()=>m});var s=n(349303),o=n(88716),i=n(60670),a=n(387070),c=n(95715),l=n(577711),d=n(691585),p=n(326033);!function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}();let u=d.Ry({content_type:d.Km(["text","image","video","audio","document"]),content_url:d.Z_().url().optional(),content_text:d.Z_().optional(),check_types:d.IX(d.Km(["accessibility","content_rating","copyright","privacy"])).min(1),metadata:d.Ry({title:d.Z_().optional(),description:d.Z_().optional(),language:d.Z_().default("en"),target_audience:d.Km(["general","children","teens","adults"]).default("general")}).optional()});class h{static async performChecks(e){let t={overall_score:0,passed:!0,checks:{}},n=0,r=0;for(let s of e.check_types){let o;switch(s){case"accessibility":o=await this.checkAccessibility(e);break;case"content_rating":o=await this.checkContentRating(e);break;case"copyright":o=await this.checkCopyright(e);break;case"privacy":o=await this.checkPrivacy(e);break;default:continue}t.checks[s]=o,n+=o.score,r++,o.passed||(t.passed=!1)}return t.overall_score=r>0?Math.round(n/r):0,t}static async checkAccessibility(e){let t=[],n=100;return"image"!==e.content_type||e.metadata?.description||(t.push("Missing alt text for image"),n-=20),"video"===e.content_type&&Math.random()>.7&&(t.push("Missing captions for video content"),n-=30),e.content_text&&e.content_text.split(" ").length/(e.content_text.split(".").length||1)>20&&(t.push("Text may be difficult to read - consider shorter sentences"),n-=10),("image"===e.content_type||"video"===e.content_type)&&Math.random()>.8&&(t.push("Content may rely on color alone to convey information"),n-=15),{type:"accessibility",passed:n>=70,score:Math.max(0,n),issues:t,recommendations:this.getAccessibilityRecommendations(t),wcag_level:n>=90?"AAA":n>=70?"AA":"A"}}static async checkContentRating(e){let t=[],n=100,r="G";if(e.content_text){let s=e.content_text.toLowerCase(),o=["violence","explicit","adult","mature"].filter(e=>s.includes(e));o.length>0&&(t.push(`Potentially inappropriate content detected: ${o.join(", ")}`),n-=20*o.length,r=o.length>2?"R":"PG-13");let i=["politics","religion","controversial"].filter(e=>s.includes(e));i.length>0&&(t.push(`Sensitive topics detected: ${i.join(", ")}`),n-=10*i.length,"G"===r&&(r="PG"))}return e.metadata?.target_audience==="children"&&"G"!==r&&(t.push("Content may not be suitable for children"),n-=30),{type:"content_rating",passed:n>=70,score:Math.max(0,n),rating:r,flags:t,recommendations:this.getContentRatingRecommendations(t,e.metadata?.target_audience),suitable_for_children:"G"===r}}static async checkCopyright(e){let t=[],n=100;if(e.content_url&&Math.random()>.9&&(t.push("Potential copyright violation detected in media content"),n-=50),e.content_text){let r=e.content_text.toLowerCase();(r.includes("copyright")||r.includes("\xa9")||r.includes("all rights reserved"))&&(n+=10),Math.random()>.85&&(t.push("Potential plagiarized content detected"),n-=40)}let r=e.metadata?.description?.includes("source:")||e.metadata?.description?.includes("credit:");return!r&&e.content_url&&(t.push("Missing proper attribution for external content"),n-=20),{type:"copyright",passed:n>=70,score:Math.max(0,n),violations:t,recommendations:this.getCopyrightRecommendations(t),requires_attribution:!r&&e.content_url,fair_use_likely:n>=80}}static async checkPrivacy(e){let t=[],n=100;if(e.content_text){let r=e.content_text.toLowerCase();[/\b\d{3}-\d{2}-\d{4}\b/,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/,/\b\d{3}-\d{3}-\d{4}\b/,/\b\d{4}\s?\d{4}\s?\d{4}\s?\d{4}\b/].forEach((e,s)=>{e.test(r)&&(t.push(`Potential ${["Social Security Number","Email Address","Phone Number","Credit Card Number"][s]} detected in content`),n-=30)});let s=["address","birthday","age","location","personal"].filter(e=>r.includes(e));s.length>0&&(t.push(`Personal information keywords detected: ${s.join(", ")}`),n-=10*s.length)}return!(e.metadata?.description?.includes("privacy")||e.metadata?.description?.includes("gdpr")||e.metadata?.description?.includes("data protection"))&&t.length>0&&(t.push("Missing privacy notice for content containing personal data"),n-=20),{type:"privacy",passed:n>=70,score:Math.max(0,n),concerns:t,recommendations:this.getPrivacyRecommendations(t),gdpr_compliant:n>=80,requires_consent:t.some(e=>e.includes("Personal information")||e.includes("detected in content"))}}static getAccessibilityRecommendations(e){let t=[];return e.some(e=>e.includes("alt text"))&&t.push("Add descriptive alt text to all images"),e.some(e=>e.includes("captions"))&&t.push("Provide captions or transcripts for video content"),e.some(e=>e.includes("sentences"))&&t.push("Use shorter, clearer sentences for better readability"),e.some(e=>e.includes("color"))&&t.push("Ensure information is not conveyed by color alone"),t}static getContentRatingRecommendations(e,t){let n=[];return e.some(e=>e.includes("inappropriate"))&&n.push("Review and remove inappropriate language or content"),e.some(e=>e.includes("sensitive"))&&n.push("Consider adding content warnings for sensitive topics"),"children"===t&&e.length>0&&n.push("Ensure all content is appropriate for the target age group"),n}static getCopyrightRecommendations(e){let t=[];return e.some(e=>e.includes("copyright violation"))&&t.push("Replace copyrighted content with original or licensed material"),e.some(e=>e.includes("plagiarized"))&&t.push("Rewrite content in your own words or properly cite sources"),e.some(e=>e.includes("attribution"))&&t.push("Add proper attribution and source credits"),t}static getPrivacyRecommendations(e){let t=[];return e.some(e=>e.includes("detected in content"))&&t.push("Remove or anonymize personal information"),e.some(e=>e.includes("keywords"))&&t.push("Review content for unnecessary personal information"),e.some(e=>e.includes("privacy notice"))&&t.push("Add privacy notice and data handling information"),t}}async function m(e){try{let t=await (0,c.getServerSession)(Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}()));if(!t?.user)return a.NextResponse.json({success:!1,error:"Authentication required"},{status:401});let n=await e.json(),r=u.parse(n);if(!r.content_url&&!r.content_text)return a.NextResponse.json({success:!1,error:"Either content_url or content_text must be provided"},{status:400});let s=await h.performChecks(r),o=.05*r.check_types.length;try{await l.supabaseAdmin.from("external_api_usage").insert({user_id:t.user.id,api_type:"compliance",provider_id:"nr-compliance",requests_made:1,cost:o,metadata:{content_type:r.content_type,check_types:r.check_types,overall_score:s.overall_score,passed:s.passed},created_at:new Date().toISOString()})}catch(e){console.warn("Failed to log compliance check usage:",e)}try{await l.supabaseAdmin.from("analytics_events").insert({user_id:t.user.id,category:"external_apis",action:"compliance_checked",metadata:{content_type:r.content_type,check_types:r.check_types,overall_score:s.overall_score,passed:s.passed,cost:o,timestamp:new Date().toISOString()},created_at:new Date().toISOString()})}catch(e){console.warn("Failed to log compliance check:",e)}return a.NextResponse.json({success:!0,data:{...s,cost:o,content_type:r.content_type,check_types:r.check_types,checked_at:new Date().toISOString()},message:"Compliance check completed successfully"})}catch(e){if(console.error("Compliance check API error:",e),e instanceof p.jm)return a.NextResponse.json({success:!1,error:"Invalid request parameters",details:e.errors},{status:400});return a.NextResponse.json({success:!1,error:"Failed to perform compliance check",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let _=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/external/compliance/check/route",pathname:"/api/external/compliance/check",filename:"route",bundlePath:"app/api/external/compliance/check/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\external\\compliance\\check\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:v}=_,x="/api/external/compliance/check/route";function f(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:g})}},577711:(e,t,n)=>{"use strict";n.d(t,{OQ:()=>i});var r=n(366763);let s=process.env.NEXT_PUBLIC_SUPABASE_URL,o=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!s||!o)throw Error("Faltam vari\xe1veis de ambiente do Supabase. Verifique o arquivo .env");let i=(0,r.createClient)(s,o,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}}})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[8948,5972,5715,6763,1585],()=>n(601385));module.exports=r})();