"use strict";(()=>{var e={};e.id=6147,e.ids=[6147,3936],e.modules={21841:e=>{e.exports=require("@aws-sdk/client-s3")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},55315:e=>{e.exports=require("path")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},55425:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>S,patchFetch:()=>q,requestAsyncStorage:()=>C,routeModule:()=>y,serverHooks:()=>w,staticGenerationAsyncStorage:()=>b});var s={};r.r(s),r.d(s,{POST:()=>f,dynamic:()=>I,maxDuration:()=>v,runtime:()=>g});var o=r(49303),i=r(88716),a=r(60670),n=r(87070),p=r(13936),u=r(84770),c=r(55315),l=r.n(c),d=r(92048),m=r(21841);class h{async saveFile(e,t){let r=l().join(process.cwd(),"public","uploads");await d.promises.mkdir(r,{recursive:!0});let s=l().join(r,t);return await d.promises.mkdir(l().dirname(s),{recursive:!0}),await d.promises.writeFile(s,e),{url:`/uploads/${t}`.replace(/\\/g,"/")}}}class x{constructor(){this.region=process.env.AWS_REGION||"us-east-1",this.bucket=process.env.AWS_S3_BUCKET||"",this.publicBase=process.env.AWS_PUBLIC_BASE||"",this.client=new m.S3Client({region:this.region})}async saveFile(e,t,r="application/octet-stream"){if(!this.bucket)throw Error("AWS_S3_BUCKET not configured");return await this.client.send(new m.PutObjectCommand({Bucket:this.bucket,Key:t,Body:e,ContentType:r})),{url:this.publicBase?`${this.publicBase.replace(/\/$/,"")}/${t}`:`https://${this.bucket}.s3.${this.region}.amazonaws.com/${t}`}}}let v=60,I="force-dynamic",g="nodejs";async function f(e){try{let t=(0,p.getSupabaseForRequest)(e),{data:{user:r},error:s}=await t.auth.getUser();if(s||!r)return n.NextResponse.json({error:"Usu\xe1rio n\xe3o autenticado"},{status:401});let o=(await e.formData()).get("file");if(!o)return n.NextResponse.json({error:"Nenhum arquivo enviado"},{status:400});let i=o.name||"presentation.pptx",a=l().extname(i).toLowerCase();if(![".pptx",".ppt",".odp",".pdf"].includes(a))return n.NextResponse.json({error:"Formato n\xe3o suportado"},{status:415});let c=Buffer.from(await o.arrayBuffer()),d=`pptx/${Date.now()}-${i.normalize("NFKD").replace(/[^\w.\- ]/g,"_").replace(/\s+/g,"_")}`,m="s3"===(process.env.STORAGE_PROVIDER||"local").toLowerCase()?new x:new h;await m.saveFile(c,d,"application/vnd.openxmlformats-officedocument.presentationml.presentation");let v=(0,u.randomUUID)();return n.NextResponse.json({success:!0,job:{id:v,s3Key:d},message:"Upload conclu\xeddo"})}catch(e){return n.NextResponse.json({error:"Erro interno do servidor",details:String(e)},{status:500})}}let y=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/v1/pptx/upload-production/route",pathname:"/api/v1/pptx/upload-production",filename:"route",bundlePath:"app/api/v1/pptx/upload-production/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\v1\\pptx\\upload-production\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:C,staticGenerationAsyncStorage:b,serverHooks:w}=y,S="/api/v1/pptx/upload-production/route";function q(){return(0,a.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:b})}},13936:(e,t,r)=>{r.d(t,{e:()=>a,getSupabaseForRequest:()=>p,p:()=>n});var s=r(67721),o=r(61657),i=r(71615);let a=()=>{let e=(0,i.cookies)();return(0,s.createServerClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{cookies:{get:t=>e.get(t)?.value,set(t,r,s){try{e.set({name:t,value:r,...s})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})},n=(0,o.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});function p(e){let t=e.headers.get("authorization")||e.headers.get("Authorization");return t?(0,o.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{global:{headers:{Authorization:t}},auth:{persistSession:!1,autoRefreshToken:!1}}):a()}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,1657,9702],()=>r(55425));module.exports=s})();