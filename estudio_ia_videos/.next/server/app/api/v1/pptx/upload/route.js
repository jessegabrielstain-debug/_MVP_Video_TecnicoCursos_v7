"use strict";(()=>{var e={};e.id=4074,e.ids=[4074],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},452558:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>E,patchFetch:()=>N,requestAsyncStorage:()=>v,routeModule:()=>x,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var s={};o.r(s),o.d(s,{GET:()=>m,POST:()=>l,dynamic:()=>c,maxDuration:()=>u,runtime:()=>d});var t=o(349303),n=o(88716),a=o(60670),i=o(387070);!function(){var e=Error("Cannot find module '@/lib/pptx/pptx-real-processor'");throw e.code="MODULE_NOT_FOUND",e}();let u=60,c="force-dynamic",d="nodejs",p=new Map;async function l(e){let r=Date.now();try{if(console.log("\uD83D\uDCE4 Iniciando upload e processamento PPTX..."),!(e.headers.get("content-type")||"").includes("multipart/form-data"))return i.NextResponse.json({success:!1,message:"Content-Type deve ser multipart/form-data",error:"INVALID_CONTENT_TYPE"},{status:400});let o=(await e.formData()).get("file");if(!o)return i.NextResponse.json({success:!1,message:"Nenhum arquivo enviado",error:"NO_FILE"},{status:400});let s=await f(o);if(!s.isValid)return i.NextResponse.json({success:!1,message:s.error||"Arquivo inv\xe1lido",error:"INVALID_FILE"},{status:400});console.log(`ðŸ“„ Arquivo v\xe1lido: ${o.name} (${o.size} bytes)`);let t=await o.arrayBuffer(),n=Buffer.from(t),a=function(){let e=Date.now().toString(36),r=Math.random().toString(36).substring(2,15);return`pptx_${e}_${r}`}();console.log(`âš™ï¸ Iniciando processamento com ID: ${a}`);let u=await Object(function(){var e=Error("Cannot find module '@/lib/pptx/pptx-real-processor'");throw e.code="MODULE_NOT_FOUND",e}()).processBuffer(n,o.name);p.set(a,u),function(){if(p.size>10){let e=Array.from(p.keys()),r=e.slice(0,e.length-10);r.forEach(e=>{p.delete(e)}),console.log(`ðŸ§¹ Cache limpo: removidos ${r.length} resultados antigos`)}}();let c=Date.now()-r;console.log(`âœ… Processamento conclu\xeddo em ${c}ms`);let d={success:!0,message:u.success?`Arquivo processado com sucesso! ${u.slides.length} slides encontrados.`:`Erro no processamento: ${u.error}`,data:{processingId:a,fileName:o.name,fileSize:o.size,result:u.success?u:void 0}};if(!u.success)return i.NextResponse.json(d,{status:422});return i.NextResponse.json(d,{status:200})}catch(e){return console.error("âŒ Erro no upload/processamento:",e),i.NextResponse.json({success:!1,message:"Erro interno do servidor",error:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function m(e){try{let{searchParams:r}=new URL(e.url),o=r.get("id");if(!o)return i.NextResponse.json({success:!1,message:"ID de processamento \xe9 obrigat\xf3rio",error:"MISSING_ID"},{status:400});let s=p.get(o);if(!s)return i.NextResponse.json({success:!1,message:"Resultado n\xe3o encontrado ou expirado",error:"NOT_FOUND"},{status:404});return i.NextResponse.json({success:!0,message:"Resultado encontrado",data:{processingId:o,result:s}},{status:200})}catch(e){return console.error("âŒ Erro ao consultar resultado:",e),i.NextResponse.json({success:!1,message:"Erro interno do servidor",error:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function f(e){try{if(!e.name.toLowerCase().endsWith(".pptx"))return{isValid:!1,error:"Arquivo deve ter extens\xe3o .pptx"};if(e.size>52428800)return{isValid:!1,error:`Arquivo muito grande. M\xe1ximo permitido: 50MB`};if(e.size<1024)return{isValid:!1,error:"Arquivo muito pequeno ou corrompido"};let r=await e.arrayBuffer(),o=Buffer.from(r).subarray(0,4);if(!(80===o[0]&&75===o[1]&&3===o[2]&&4===o[3]))return{isValid:!1,error:"Arquivo n\xe3o \xe9 um PPTX v\xe1lido (cabe\xe7alho inv\xe1lido)"};return{isValid:!0}}catch(e){return{isValid:!1,error:`Erro na valida\xe7\xe3o: ${e instanceof Error?e.message:"Erro desconhecido"}`}}}let x=new t.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/v1/pptx/upload/route",pathname:"/api/v1/pptx/upload",filename:"route",bundlePath:"app/api/v1/pptx/upload/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\v1\\pptx\\upload\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:g,serverHooks:h}=x,E="/api/v1/pptx/upload/route";function N(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),s=r.X(0,[8948,5972],()=>o(452558));module.exports=s})();