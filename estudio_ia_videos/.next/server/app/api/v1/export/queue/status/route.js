"use strict";(()=>{var e={};e.id=5345,e.ids=[5345],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39931:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>g});var r={};s.r(r),s.d(r,{GET:()=>l});var o=s(49303),a=s(88716),n=s(60670),u=s(87070),i=s(88526);async function l(e){try{let e=(0,i.wF)(),t=e.getQueueStatus(),s=e.getStatistics();return u.NextResponse.json({success:!0,queue:t,statistics:{totalJobs:s.totalJobs,queueSize:s.queueSize,processing:s.processing,averageDuration:Math.round(s.averageDuration),maxConcurrent:s.maxConcurrent},timestamp:new Date().toISOString()})}catch(e){return console.error("[Export API] Error fetching queue status:",e),u.NextResponse.json({error:"Failed to fetch queue status",details:String(e)},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/v1/export/queue/status/route",pathname:"/api/v1/export/queue/status",filename:"route",bundlePath:"app/api/v1/export/queue/status/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\v1\\export\\queue\\status\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:d}=p,h="/api/v1/export/queue/status/route";function m(){return(0,n.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:g})}},88526:(e,t,s)=>{s.d(t,{wF:()=>a});class r{async addJob(e,t){let s=crypto.randomUUID();return console.log("[ExportQueue] Adding job:",s),this.jobs.set(s,{id:s,videoId:e,format:t,status:"pending",progress:0,createdAt:new Date}),s}async getJob(e){return this.jobs.get(e)||null}async updateProgress(e,t,s){let r=this.jobs.get(e);if(r){r.progress=t,s&&(r.status=s);let o=Array.from(this.jobs.values()).filter(e=>"processing"===e.status).length;this.maxConcurrent=Math.max(this.maxConcurrent,o),console.log("[ExportQueue] Updated job:",e,t)}}async completeJob(e,t){let s=this.jobs.get(e);s&&(s.status="completed",s.progress=100,s.outputPath=t,s.completedAt=new Date)}async failJob(e,t){let s=this.jobs.get(e);s&&(s.status="failed",s.error=t,s.completedAt=new Date)}async getQueueStatus(){let e=Array.from(this.jobs.values());return{total:e.length,pending:e.filter(e=>"pending"===e.status).length,processing:e.filter(e=>"processing"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,failed:e.filter(e=>"failed"===e.status).length}}async cancelJob(e){let t=this.jobs.get(e);return!!t&&("pending"===t.status||"processing"===t.status)&&(t.status="cancelled",t.completedAt=new Date,!0)}getStatistics(){let e=Array.from(this.jobs.values()),t=e.filter(e=>"completed"===e.status&&e.completedAt),s=t.length?t.reduce((e,t)=>e+(t.completedAt.getTime()-t.createdAt.getTime()||0),0)/t.length:0;return{totalJobs:e.length,queueSize:e.filter(e=>"pending"===e.status).length,processing:e.filter(e=>"processing"===e.status).length,averageDuration:s,maxConcurrent:this.maxConcurrent||Math.max(1,e.filter(e=>"processing"===e.status).length)}}constructor(){this.jobs=new Map,this.maxConcurrent=0}}let o=new r,a=()=>o}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,5972],()=>s(39931));module.exports=r})();