(()=>{var e={};e.id=3585,e.ids=[3585],e.modules={788751:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=788751,e.exports=t},318993:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=318993,e.exports=t},745773:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=745773,e.exports=t},991254:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=991254,e.exports=t},220399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},592048:e=>{"use strict";e.exports=require("fs")},532615:e=>{"use strict";e.exports=require("http")},735240:e=>{"use strict";e.exports=require("https")},555315:e=>{"use strict";e.exports=require("path")},768621:e=>{"use strict";e.exports=require("punycode")},276162:e=>{"use strict";e.exports=require("stream")},917360:e=>{"use strict";e.exports=require("url")},671568:e=>{"use strict";e.exports=require("zlib")},691789:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>E,patchFetch:()=>R,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h});var o={};r.r(o),r.d(o,{GET:()=>d});var s=r(349303),n=r(88716),i=r(60670),l=r(387070),a=r(895412),c=r(840594);let u=c.Ry({id:c.Z_().uuid()});var g=r(848588);async function d(e,t){try{var r;let o=(0,a.s)(e),{data:s,error:n}=await o.auth.getUser();if(n||!s.user)return l.NextResponse.json({code:"UNAUTHORIZED",message:"Usu\xe1rio n\xe3o autenticado"},{status:401});let i=(r=t.params,u.safeParse(r));if(!i.success)return l.NextResponse.json({code:"VALIDATION_ERROR",message:"Par\xe2metro inv\xe1lido",details:i.error.issues},{status:400});let{id:c}=i.data,{data:g,error:d}=await o.from("render_jobs").select("id,status,project_id,created_at,progress,user_id,render_settings,attempts,duration_ms").eq("id",c).single();if(d||!g)return l.NextResponse.json({code:"NOT_FOUND",message:"Job n\xe3o encontrado"},{status:404});if(g.user_id!==s.user.id)return l.NextResponse.json({code:"FORBIDDEN",message:"Sem permiss\xe3o"},{status:403});let{user_id:p,render_settings:m,...h}=g;return l.NextResponse.json({job:{...h,status:g.status,project_id:g.project_id,created_at:g.created_at,progress:g.progress,attempts:g.attempts,duration_ms:g.duration_ms??null,settings:m}})}catch(e){return g.k.error("video-jobs-id","unexpected-error",e),l.NextResponse.json({code:"UNEXPECTED",message:"Erro inesperado",details:e.message},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/v1/video-jobs/[id]/route",pathname:"/api/v1/video-jobs/[id]",filename:"route",bundlePath:"app/api/v1/video-jobs/[id]/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\v1\\video-jobs\\[id]\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:v}=p,E="/api/v1/video-jobs/[id]/route";function R(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}},848588:(e,t,r)=>{"use strict";r.d(t,{k:()=>a});var o=r(592048),s=r.n(o),n=r(555315),i=r.n(n);class l{constructor(){this.maxFileSize=10485760,this.maxFiles=5,this.logDir=i().join(process.cwd(),"..","logs"),s().existsSync(this.logDir)||s().mkdirSync(this.logDir,{recursive:!0}),this.currentLogFile=i().join(this.logDir,`app-${this.getDateString()}.log`)}static getInstance(){return l.instance||(l.instance=new l),l.instance}getDateString(){let e=new Date;return`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}`}getTimestamp(){return new Date().toISOString()}formatConsole(e){let t={DEBUG:"\x1b[36m",INFO:"\x1b[37m",WARN:"\x1b[33m",ERROR:"\x1b[31m",FATAL:"\x1b[35m",RESET:"\x1b[0m"},r=t[e.level],o={DEBUG:"\uD83D\uDD0D",INFO:"â„¹ï¸",WARN:"âš ï¸",ERROR:"âŒ",FATAL:"\uD83D\uDC80"}[e.level],s=`${r}[${e.timestamp}] ${o} ${e.level} [${e.component}] ${e.message}${t.RESET}`;return e.data&&(s+=`
${r}   Data: ${JSON.stringify(e.data,null,2)}${t.RESET}`),e.stack&&(s+=`
${r}   Stack: ${e.stack}${t.RESET}`),s}writeToFile(e){try{this.rotateIfNeeded();let t=JSON.stringify(e)+"\n";s().appendFileSync(this.currentLogFile,t,"utf-8")}catch(e){console.error("Erro ao escrever log:",e)}}rotateIfNeeded(){try{if(s().existsSync(this.currentLogFile)&&s().statSync(this.currentLogFile).size>=this.maxFileSize){let e=Date.now(),t=this.currentLogFile.replace(".log",`-${e}.log`);s().renameSync(this.currentLogFile,t),this.cleanOldLogs()}}catch(e){console.error("Erro ao rotacionar logs:",e)}}cleanOldLogs(){try{let e=s().readdirSync(this.logDir).filter(e=>e.endsWith(".log")).map(e=>({name:e,path:i().join(this.logDir,e),time:s().statSync(i().join(this.logDir,e)).mtime.getTime()})).sort((e,t)=>t.time-e.time);e.length>this.maxFiles&&e.slice(this.maxFiles).forEach(e=>{s().unlinkSync(e.path)})}catch(e){console.error("Erro ao limpar logs antigos:",e)}}log(e,t,r,o,s){let n={timestamp:this.getTimestamp(),level:e,component:t,message:r,data:o};s&&(n.stack=s.stack),console.log(this.formatConsole(n)),this.writeToFile(n)}debug(e,t,r){this.log("DEBUG",e,t,r)}info(e,t,r){this.log("INFO",e,t,r)}warn(e,t,r){this.log("WARN",e,t,r)}error(e,t,r,o){this.log("ERROR",e,t,o,r)}fatal(e,t,r,o){this.log("FATAL",e,t,o,r)}analyzeLogs(e){let t=e||this.currentLogFile;if(!s().existsSync(t))throw Error(`Arquivo de log n\xe3o encontrado: ${t}`);let r=s().readFileSync(t,"utf-8").split("\n").filter(e=>e.trim()).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>null!==e),o={totalLogs:r.length,byLevel:{DEBUG:r.filter(e=>"DEBUG"===e.level).length,INFO:r.filter(e=>"INFO"===e.level).length,WARN:r.filter(e=>"WARN"===e.level).length,ERROR:r.filter(e=>"ERROR"===e.level).length,FATAL:r.filter(e=>"FATAL"===e.level).length},byComponent:{},errors:r.filter(e=>"ERROR"===e.level||"FATAL"===e.level),warnings:r.filter(e=>"WARN"===e.level),timeRange:{start:r[0]?.timestamp||"",end:r[r.length-1]?.timestamp||""}};return r.forEach(e=>{o.byComponent[e.component]||(o.byComponent[e.component]=0),o.byComponent[e.component]++}),o}searchLogs(e,t,r,o){let n=o||this.currentLogFile;return s().existsSync(n)?s().readFileSync(n,"utf-8").split("\n").filter(e=>e.trim()).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>null!==e).filter(o=>(!t||o.level===t)&&(!r||o.component===r)&&(!e||JSON.stringify(o).toLowerCase().includes(e.toLowerCase()))):[]}printAnalysis(e){console.log("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"),console.log("â•‘                    \uD83D\uDCCA AN\xc1LISE DE LOGS                            â•‘"),console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n"),console.log(`ðŸ“‹ Total de Logs: ${e.totalLogs}`),console.log(`â° Per\xedodo: ${e.timeRange.start} â†’ ${e.timeRange.end}
`),console.log("\uD83D\uDCCA Por N\xedvel:"),console.log(`   ðŸ” DEBUG: ${e.byLevel.DEBUG}`),console.log(`   â„¹ï¸  INFO:  ${e.byLevel.INFO}`),console.log(`   âš ï¸  WARN:  ${e.byLevel.WARN}`),console.log(`   âŒ ERROR: ${e.byLevel.ERROR}`),console.log(`   ðŸ’€ FATAL: ${e.byLevel.FATAL}
`),console.log("\uD83D\uDCE6 Por Componente:"),Object.entries(e.byComponent).sort(([,e],[,t])=>t-e).forEach(([e,t])=>{console.log(`   - ${e}: ${t}`)}),e.errors.length>0&&(console.log(`
âŒ Erros Recentes (${e.errors.length}):`),e.errors.slice(-5).forEach(e=>{console.log(`   [${e.timestamp}] ${e.component}: ${e.message}`)})),e.warnings.length>0&&(console.log(`
âš ï¸  Avisos Recentes (${e.warnings.length}):`),e.warnings.slice(-5).forEach(e=>{console.log(`   [${e.timestamp}] ${e.component}: ${e.message}`)})),console.log("\n")}getLogFiles(){return s().readdirSync(this.logDir).filter(e=>e.endsWith(".log")).map(e=>i().join(this.logDir,e))}clearLogs(){let e=this.getLogFiles();e.forEach(e=>s().unlinkSync(e)),console.log(`âœ… ${e.length} arquivos de log removidos`)}}let a=l.getInstance()},895412:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var o=r(868355);function s(e){let t=process.env.NEXT_PUBLIC_SUPABASE_URL||process.env.SUPABASE_URL||"",r=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||process.env.SUPABASE_ANON_KEY||"",s=(e.headers.get("authorization")||e.headers.get("Authorization"))??"",n={};return s&&(n.Authorization=s),(0,o.createClient)(t,r,{global:{headers:n},auth:{persistSession:!1,autoRefreshToken:!0}})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[8948,5972,8355,3105],()=>r(691789));module.exports=o})();