"use strict";(()=>{var e={};e.id=8007,e.ids=[8007],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},867863:(e,o,r)=>{r.r(o),r.d(o,{originalPathname:()=>b,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>v,staticGenerationAsyncStorage:()=>j});var t={};r.r(t),r.d(t,{DELETE:()=>p,GET:()=>c,POST:()=>u,dynamic:()=>d});var s=r(349303),a=r(88716),n=r(60670),i=r(387070);(function(){var e=Error("Cannot find module '@/lib/video-export-real'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/prisma'");throw e.code="MODULE_NOT_FOUND",e}();let d="force-dynamic";async function u(e){try{let{projectId:o,options:r}=await e.json();if(!o)return i.NextResponse.json({error:"Project ID \xe9 obrigat\xf3rio"},{status:400});let t=function(e){let o={format:e?.format||l.format,quality:e?.quality||l.quality,fps:[24,30,60].includes(e?.fps??NaN)?e?.fps:l.fps,codec:e?.codec||l.codec,includeAudio:"boolean"==typeof e?.includeAudio?e?.includeAudio:l.includeAudio,bitrate:function(e){if(null!=e){if("number"==typeof e&&isFinite(e)&&e>0)return`${Math.round(e)}k`;if("string"==typeof e){let o=e.trim().toLowerCase();if(/^\d+$/.test(o))return`${o}k`;if(/^\d+(k|m|kbps|mbps)$/.test(o))return o.replace("kbps","k").replace("mbps","m")}}}(e?.bitrate),preset:e?.preset};if("webm"===o.format&&!["vp9","av1"].includes(o.codec))return i.NextResponse.json({error:"Formato webm requer codec vp9 ou av1"},{status:400});if(("mp4"===o.format||"mov"===o.format)&&!["h264","h265"].includes(o.codec))return i.NextResponse.json({error:`${o.format} requer codec h264 ou h265`},{status:400});if("4k"===o.quality&&!["h265","vp9","av1"].includes(o.codec))return i.NextResponse.json({error:"4K requer codec h265, vp9 ou av1"},{status:400});if(o.preset){let e=o.preset;if(["h264","h265"].includes(o.codec)){if(!["ultrafast","superfast","veryfast","faster","fast","medium","slow","slower","veryslow"].includes(e))return i.NextResponse.json({error:`Preset inv\xe1lido para ${o.codec}`},{status:400})}else if(["vp9","av1"].includes(o.codec)&&!["good","best"].includes(e))return i.NextResponse.json({error:`Preset inv\xe1lido para ${o.codec}`},{status:400})}else["vp9","av1"].includes(o.codec)?o.preset="good":["h264","h265"].includes(o.codec)&&(o.preset="4k"===o.quality?"slow":l.preset);return o}(r);if(t instanceof i.NextResponse)return t;console.log("\uD83C\uDFAC Iniciando exporta\xe7\xe3o de v\xeddeo para projeto:",o);let s=await Object(function(){var e=Error("Cannot find module '@/lib/video-export-real'");throw e.code="MODULE_NOT_FOUND",e}())(o,t);if(!s.success)return i.NextResponse.json({error:s.error||"Erro na exporta\xe7\xe3o"},{status:500});return i.NextResponse.json({success:!0,jobId:s.jobId,message:"Exporta\xe7\xe3o de v\xeddeo iniciada! Use o jobId para verificar o progresso.",status:"queued",options:t})}catch(e){return console.error("❌ Erro na API de exporta\xe7\xe3o de v\xeddeo:",e),i.NextResponse.json({error:"Erro na exporta\xe7\xe3o de v\xeddeo",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function c(e){try{let{searchParams:o}=new URL(e.url),r=o.get("jobId"),t=o.get("projectId"),s=o.get("status"),a=Math.min(parseInt(o.get("limit")||"20",10)||20,100),n=parseInt(o.get("offset")||"0",10)||0;if(!r){if(t){let e={projectId:t};s&&["queued","processing","completed","error"].includes(s)&&(e.status=s);let o=await Object(function(){var e=Error("Cannot find module '@/lib/prisma'");throw e.code="MODULE_NOT_FOUND",e}()).videoExport.count({where:e}),r=await Object(function(){var e=Error("Cannot find module '@/lib/prisma'");throw e.code="MODULE_NOT_FOUND",e}()).videoExport.findMany({where:e,orderBy:{createdAt:"desc"},take:a,skip:n});return i.NextResponse.json({success:!0,history:r.map(e=>({id:e.id,status:e.status,progress:e.progress,outputUrl:e.videoUrl,error:e.errorMessage,createdAt:e.createdAt,updatedAt:e.updatedAt})),page:{total:o,offset:n,limit:a,count:r.length,hasNext:n+r.length<o}})}return i.NextResponse.json({message:"API de Exporta\xe7\xe3o de V\xeddeo Real",usage:{"POST /export-real":"Iniciar exporta\xe7\xe3o { projectId, options }","GET /export-real?jobId=":"Verificar status do job","GET /export-real?projectId=":"Listar jobs recentes do projeto","GET /export-real?projectId=&status=&limit=&offset=":"Hist\xf3rico com filtros e pagina\xe7\xe3o"},supportedFormats:["mp4","webm","mov"],supportedQualities:["sd","hd","fhd","4k"],supportedCodecs:["h264","h265","vp9","av1"],defaults:l},{status:200})}let d=await Object(function(){var e=Error("Cannot find module '@/lib/video-export-real'");throw e.code="MODULE_NOT_FOUND",e}())(r);if(!d.job)return i.NextResponse.json({error:d.error||"Job n\xe3o encontrado"},{status:404});return i.NextResponse.json({success:!0,job:{id:d.job.id,projectId:d.job.projectId,status:d.job.status,progress:d.job.progress,outputUrl:d.job.outputUrl,error:d.job.error,startedAt:d.job.startedAt,completedAt:d.job.completedAt,metadata:d.job.metadata},message:`Status do job: ${d.job.status} (${d.job.progress}%)`})}catch(e){return console.error("❌ Erro ao verificar status do job:",e),i.NextResponse.json({error:"Erro ao verificar status",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function p(e){try{let{searchParams:o}=new URL(e.url),r=o.get("jobId");if(!r)return i.NextResponse.json({error:"Job ID \xe9 obrigat\xf3rio"},{status:400});return console.log("\uD83D\uDED1 Cancelando job de exporta\xe7\xe3o:",r),i.NextResponse.json({success:!0,message:`Job ${r} cancelado`,jobId:r})}catch(e){return console.error("❌ Erro ao cancelar job:",e),i.NextResponse.json({error:"Erro ao cancelar job",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}let l={format:"mp4",quality:"hd",fps:30,codec:"h264",includeAudio:!0,preset:"medium"},f=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/v1/video/export-real/route",pathname:"/api/v1/video/export-real",filename:"route",bundlePath:"app/api/v1/video/export-real/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\v1\\video\\export-real\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:j,serverHooks:v}=f,b="/api/v1/video/export-real/route";function x(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:j})}}};var o=require("../../../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[8948,5972],()=>r(867863));module.exports=t})();