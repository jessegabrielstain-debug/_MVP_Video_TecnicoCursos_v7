"use strict";(()=>{var e={};e.id=7952,e.ids=[7952],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},10308:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>j,requestAsyncStorage:()=>x,routeModule:()=>f,serverHooks:()=>C,staticGenerationAsyncStorage:()=>w});var a={};r.r(a),r.d(a,{POST:()=>m});var s=r(49303),o=r(88716),n=r(60670),u=r(87070),i=r(92048),p=r(84770),d=r(55315),l=r.n(d);let c=l().join(process.cwd(),"uploads","temp"),h=l().join(process.cwd(),"uploads","metadata");async function k(){try{await i.promises.mkdir(c,{recursive:!0}),await i.promises.mkdir(h,{recursive:!0})}catch(e){console.error("Error creating directories:",e)}}async function g(e){let t=(0,p.createHash)("sha256");return t.update(e),t.digest("hex")}async function m(e){await k();try{let t;let r=await e.formData(),a=r.get("uploadId"),s=parseInt(r.get("chunkIndex")),o=r.get("chunkHash"),n=parseInt(r.get("totalChunks")),p=r.get("chunk");if(!a||void 0===s||!o||!p)return u.NextResponse.json({error:"Missing required fields"},{status:400});let d=Buffer.from(await p.arrayBuffer());if(await g(d)!==o)return u.NextResponse.json({error:"Chunk integrity check failed"},{status:400});let k=l().join(c,`${a}_chunk_${s}`);await i.promises.writeFile(k,d);let m=l().join(h,`${a}.json`);try{let e=await i.promises.readFile(m,"utf-8");t=JSON.parse(e)}catch{t={uploadId:a,filename:`upload_${a}`,totalSize:0,totalChunks:n,uploadedChunks:[],createdAt:new Date().toISOString(),lastUpdated:new Date().toISOString()}}return t.uploadedChunks.includes(s)||(t.uploadedChunks.push(s),t.uploadedChunks.sort((e,t)=>e-t)),t.lastUpdated=new Date().toISOString(),await i.promises.writeFile(m,JSON.stringify(t,null,2)),u.NextResponse.json({success:!0,chunkIndex:s,uploadedChunks:t.uploadedChunks.length,totalChunks:t.totalChunks,progress:t.uploadedChunks.length/t.totalChunks*100})}catch(e){return console.error("Chunk upload error:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/upload/chunk/route",pathname:"/api/upload/chunk",filename:"route",bundlePath:"app/api/upload/chunk/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\upload\\chunk\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:x,staticGenerationAsyncStorage:w,serverHooks:C}=f,v="/api/upload/chunk/route";function j(){return(0,n.patchFetch)({serverHooks:C,staticGenerationAsyncStorage:w})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>r(10308));module.exports=a})();