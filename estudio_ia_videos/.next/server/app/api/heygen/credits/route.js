"use strict";(()=>{var e={};e.id=9361,e.ids=[9361],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},82521:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>_});var a={};r.r(a),r.d(a,{GET:()=>c,dynamic:()=>d});var i=r(49303),o=r(88716),s=r(60670),n=r(87070),u=r(72721);let d="force-dynamic";async function c(e){try{let e=await u.N.getQuota();if(e.error)return n.NextResponse.json({error:e.error},{status:500});return n.NextResponse.json({remaining:e.remaining_quota,used:e.used_quota,resetDate:e.quota_reset_date})}catch(e){return console.error("Error fetching HeyGen quota:",e),n.NextResponse.json({error:"Failed to fetch quota"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/heygen/credits/route",pathname:"/api/heygen/credits",filename:"route",bundlePath:"app/api/heygen/credits/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\heygen\\credits\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:_,serverHooks:h}=p,g="/api/heygen/credits/route";function v(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:_})}},72721:(e,t,r)=>{r.d(t,{N:()=>o});var a=r(61657);class i{constructor(){this.apiKey=process.env.HEYGEN_API_KEY||"";let e=process.env.SUPABASE_SERVICE_ROLE_KEY;this.supabase=(0,a.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",e)}static getInstance(){return i.instance||(i.instance=new i),i.instance}async request(e,t="GET",r){if(!this.apiKey)throw Error("HeyGen API Key not configured");let a=await fetch(`https://api.heygen.com/v2/${e}`,{method:t,headers:{"X-Api-Key":this.apiKey,"Content-Type":"application/json"},body:r?JSON.stringify(r):void 0});if(!a.ok){let e=await a.text();throw Error(`HeyGen API Error: ${a.status} - ${e}`)}return await a.json()}async listAvatars(){try{return(await this.request("avatars")).data.avatars.map(e=>({avatar_id:e.avatar_id,name:e.name,gender:e.gender,preview_image_url:e.preview_image_url,preview_video_url:e.preview_video_url}))}catch(e){return console.error("Failed to list HeyGen avatars:",e),[]}}async listVoices(){try{return(await this.request("voices")).data.voices}catch(e){return console.error("Failed to list HeyGen voices:",e),[]}}async generateVideo(e){console.log("\uD83C\uDFAC Starting HeyGen video generation...");let t=await this.request("video/generate","POST",e);if(!t.data||!t.data.video_id)throw Error("Failed to get video_id from HeyGen response");return t.data.video_id}async checkStatus(e){let t=await this.request(`video_status.get?video_id=${e}`),r=t.data.status,a={video_id:e,status:"completed"===r?"completed":"failed"===r?"failed":"processing"===r?"processing":"pending"};return"completed"===r?(a.video_url=t.data.video_url,a.thumbnail_url=t.data.thumbnail_url):"failed"===r&&(a.error=t.data.error?.message||"Unknown error"),a}async getQuota(){try{let e=await this.request("user/remaining_quota");return{remaining_quota:e.data.remaining_quota??0,used_quota:e.data.used_quota??0,quota_reset_date:e.data.quota_reset_date}}catch(e){return console.error("Failed to get HeyGen quota:",e),{remaining_quota:0,used_quota:0,error:e instanceof Error?e.message:"Unknown error"}}}}let o=new i}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,1657],()=>r(82521));module.exports=a})();