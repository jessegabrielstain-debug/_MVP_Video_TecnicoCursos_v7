"use strict";(()=>{var e={};e.id=7507,e.ids=[7507],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},17702:e=>{e.exports=require("events")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},16497:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>P,requestAsyncStorage:()=>v,routeModule:()=>h,serverHooks:()=>b,staticGenerationAsyncStorage:()=>w});var i={};r.r(i),r.d(i,{POST:()=>m,dynamic:()=>c,runtime:()=>d});var o=r(49303),a=r(88716),n=r(60670),s=r(87070),l=r(89190),p=r.n(l);let u=require("sharp");var f=r.n(u);!function(){var e=Error("Cannot find module '@/lib/pptx/pptx-processor-real'");throw e.code="MODULE_NOT_FOUND",e}();let d="nodejs",c="force-dynamic";async function m(e){try{let t=(await e.formData()).get("file");if(!(t instanceof File))return s.NextResponse.json({error:"Arquivo PPTX n\xe3o enviado."},{status:400});if(!t.name.toLowerCase().endsWith(".pptx")&&!t.name.toLowerCase().endsWith(".ppt"))return s.NextResponse.json({error:"Formato inv\xe1lido. Envie um arquivo .pptx ou .ppt."},{status:400});if(0===t.size)return s.NextResponse.json({error:"Arquivo vazio recebido."},{status:400});if(t.size>314572800)return s.NextResponse.json({error:"Arquivo acima do limite de 300MB."},{status:413});let r=await t.arrayBuffer(),i=Buffer.from(r),[o,a]=await Promise.all([Object(function(){var e=Error("Cannot find module '@/lib/pptx/pptx-processor-real'");throw e.code="MODULE_NOT_FOUND",e}()).extract(i),p().loadAsync(i)]);if(!o.success)return s.NextResponse.json({error:o.error||"Falha ao extrair informa\xe7\xf5es do PPTX."},{status:422});let n=[];for(let e of o.slides){let t=[];for(let r of e.images.slice(0,2)){let e=r.startsWith("ppt/")?r:`ppt/${r.replace(/^\.?\/?/,"")}`,i=a.file(e);if(!i)continue;let o=await i.async("arraybuffer");t.push(Buffer.from(o))}let r=await x(e,t);n.push({slideNumber:e.slideNumber,title:e.title,content:e.content,notes:e.notes,hasImages:t.length>0,hasAnimations:!!e.animations?.length,estimatedDuration:e.duration,thumbnail:`data:image/png;base64,${r.toString("base64")}`})}return s.NextResponse.json({metadata:o.metadata,stats:o.extractionStats,timeline:o.timeline,slides:n})}catch(e){return console.error("❌ Erro ao gerar preview do PPTX:",e),s.NextResponse.json({error:"Erro interno ao gerar preview do PPTX."},{status:500})}}async function x(e,t){if(t.length>0)try{return await f()(t[0]).resize(640,360,{fit:"cover",position:"center"}).png().toBuffer()}catch(e){console.warn("⚠️ Falha ao gerar thumbnail a partir de imagem real:",e)}let r=function(e){let t=[["#f97316","#fb7185"],["#6366f1","#22d3ee"],["#0ea5e9","#22c55e"],["#8b5cf6","#ec4899"],["#14b8a6","#8b5cf6"],["#f59e0b","#ef4444"]];return t[(e-1)%t.length]}(e.slideNumber),i=g(e.title||`Slide ${e.slideNumber}`),o=g(function(e,t){var r;let i=[e,t].find(e=>e&&e.trim().length>0);return i?(r=(i.split(/\r?\n/).find(e=>e.trim().length>0)||i).trim()).length<=80?r:`${r.substring(0,79)}…`:""}(e.content,e.notes)),a=`
    <svg width="640" height="360" viewBox="0 0 640 360" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="${r[0]}" />
          <stop offset="100%" stop-color="${r[1]}" />
        </linearGradient>
      </defs>
      <rect width="640" height="360" rx="20" fill="url(#bg)" />
      <rect x="24" y="24" width="592" height="312" rx="18" fill="rgba(255,255,255,0.12)" />
      <text x="50%" y="170" font-family="'Inter', Arial, sans-serif" font-size="32" fill="#FFFFFF" font-weight="700" text-anchor="middle">
        ${i}
      </text>
      ${o?`
        <text x="50%" y="220" font-family="'Inter', Arial, sans-serif" font-size="20" fill="rgba(255,255,255,0.82)" text-anchor="middle">
          ${o}
        </text>
      `:""}
      <text x="32" y="320" font-family="'Inter', Arial, sans-serif" font-size="16" fill="rgba(255,255,255,0.65)">
        ${e.duration}s • ${e.textBlocks} blocos de texto${e.images.length?` • ${e.images.length} imagens`:""}
      </text>
    </svg>
  `;return await f()(Buffer.from(a)).png().toBuffer()}function g(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}let h=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/pptx/preview/route",pathname:"/api/pptx/preview",filename:"route",bundlePath:"app/api/pptx/preview/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\pptx\\preview\\route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:v,staticGenerationAsyncStorage:w,serverHooks:b}=h,y="/api/pptx/preview/route";function P(){return(0,n.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:w})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[1216],()=>r(16497));module.exports=i})();