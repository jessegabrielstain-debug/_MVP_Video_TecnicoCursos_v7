"use strict";(()=>{var e={};e.id=6078,e.ids=[6078],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},925883:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>b});var o={};a.r(o),a.d(o,{GET:()=>u,POST:()=>d});var r=a(349303),s=a(88716),i=a(60670),n=a(387070);async function d(e){try{let t;let{type:a,data:o,options:r}=await e.json();if(!a||!o)return n.NextResponse.json({error:"Tipo e dados s\xe3o obrigat\xf3rios"},{status:400});console.log(`[PPTX Generate API] Generating presentation type: ${a}`);let s=Object(function(){var e=Error("Cannot find module '@/lib/pptx/pptx-generator'");throw e.code="MODULE_NOT_FOUND",e}())(r||{});switch(a){case"from-data":t=await s.generateFromData(o);break;case"from-template":if(!o.templateId||!o.variables)return n.NextResponse.json({error:"Template ID e vari\xe1veis s\xe3o obrigat\xf3rios"},{status:400});t=await s.generateFromTemplate(o.templateId,o.variables);break;case"training-course":t=await c(s,o);break;case"safety-presentation":t=await p(s,o);break;case"quick-slides":t=await l(s,o);break;default:return n.NextResponse.json({error:`Tipo de gera\xe7\xe3o n\xe3o suportado: ${a}`},{status:400})}let i=new Headers;return i.set("Content-Type","application/vnd.openxmlformats-officedocument.presentationml.presentation"),i.set("Content-Disposition",`attachment; filename="${o.title||"apresentacao"}.pptx"`),i.set("Content-Length",t.length.toString()),console.log(`[PPTX Generate API] Generated presentation successfully (${t.length} bytes)`),new n.NextResponse(t,{status:200,headers:i})}catch(e){return console.error("[PPTX Generate API] Generation error:",e),n.NextResponse.json({error:"Erro na gera\xe7\xe3o da apresenta\xe7\xe3o",details:e.message},{status:500})}}async function c(e,t){let a={title:t.title||"Curso de Treinamento",slides:[{type:"title",title:t.title||"Curso de Treinamento",subtitle:t.subtitle||"Treinamento Corporativo",notes:"Slide de abertura do curso"},{type:"content",title:"Objetivos do Treinamento",content:t.objectives||["Compreender os conceitos fundamentais","Aplicar as melhores pr\xe1ticas","Desenvolver habilidades pr\xe1ticas","Certificar conhecimentos adquiridos"],notes:"Definir claramente os objetivos de aprendizagem"},...(t.modules||[]).map((e,t)=>({type:"content",title:`M\xf3dulo ${t+1}: ${e.title}`,content:e.topics||[],notes:e.notes||`Conte\xfado do m\xf3dulo ${t+1}`})),{type:"content",title:"Conclus\xe3o",content:["Principais pontos abordados","Aplica\xe7\xe3o pr\xe1tica","Pr\xf3ximos passos","Recursos adicionais"],notes:"Resumir os pontos principais e orientar pr\xf3ximos passos"}]};return await e.generateFromData(a)}async function p(e,t){let a={title:t.title||"Treinamento de Seguran\xe7a do Trabalho",slides:[{type:"title",title:t.title||"Seguran\xe7a do Trabalho",subtitle:"Preven\xe7\xe3o de Acidentes e Prote\xe7\xe3o da Vida",notes:"Apresenta\xe7\xe3o focada em seguran\xe7a ocupacional"},{type:"content",title:"Por que a Seguran\xe7a \xe9 Importante?",content:["Preserva\xe7\xe3o da vida e integridade f\xedsica","Redu\xe7\xe3o de custos com acidentes","Cumprimento de normas regulamentadoras","Melhoria do ambiente de trabalho","Responsabilidade social da empresa"],notes:"Estabelecer a import\xe2ncia fundamental da seguran\xe7a"},{type:"content",title:"Principais Riscos no Ambiente de Trabalho",content:t.risks||["Riscos f\xedsicos (ru\xeddo, calor, frio)","Riscos qu\xedmicos (gases, vapores, poeiras)","Riscos biol\xf3gicos (v\xedrus, bact\xe9rias)","Riscos ergon\xf4micos (postura, repetitividade)","Riscos de acidentes (m\xe1quinas, ferramentas)"],notes:"Identificar os principais tipos de riscos ocupacionais"},{type:"content",title:"Equipamentos de Prote\xe7\xe3o Individual (EPIs)",content:["Capacete de seguran\xe7a","\xd3culos de prote\xe7\xe3o","Protetores auriculares","M\xe1scaras e respiradores","Luvas de prote\xe7\xe3o","Cal\xe7ados de seguran\xe7a","Cintos de seguran\xe7a"],notes:"Apresentar os principais EPIs e suas aplica\xe7\xf5es"},{type:"content",title:"Procedimentos de Emerg\xeancia",content:["Identifica\xe7\xe3o de situa\xe7\xf5es de emerg\xeancia","Rotas de fuga e pontos de encontro","Uso de extintores e mangueiras","Primeiros socorros b\xe1sicos","Comunica\xe7\xe3o de emerg\xeancias","Evacua\xe7\xe3o ordenada"],notes:"Definir procedimentos claros para situa\xe7\xf5es de emerg\xeancia"},{type:"comparison",title:"Responsabilidades na Seguran\xe7a",leftColumn:{title:"Empresa",content:["Fornecer EPIs adequados","Treinar funcion\xe1rios","Manter ambiente seguro","Cumprir normas legais","Investigar acidentes"]},rightColumn:{title:"Funcion\xe1rio",content:["Usar EPIs corretamente","Seguir procedimentos","Reportar riscos","Participar de treinamentos","Cuidar da pr\xf3pria seguran\xe7a"]},notes:"Esclarecer as responsabilidades de cada parte"},{type:"content",title:"Compromisso com a Seguran\xe7a",content:["Seguran\xe7a \xe9 responsabilidade de todos","Preven\xe7\xe3o \xe9 sempre melhor que corre\xe7\xe3o","Reportar situa\xe7\xf5es de risco","Participar ativamente dos treinamentos","Cuidar de si e dos colegas"],notes:"Refor\xe7ar o compromisso coletivo com a seguran\xe7a"}]};return await e.generateFromData(a)}async function l(e,t){let a={title:t.title||"Apresenta\xe7\xe3o R\xe1pida",slides:Array.isArray(t.slides)?t.slides.map((e,t)=>({type:e.type||"content",title:e.title||`Slide ${t+1}`,content:e.content||"",image:e.image,notes:e.notes})):[]};return await e.generateFromData(a)}async function u(e){try{return n.NextResponse.json({templates:[{id:"training-course",name:"Curso de Treinamento",description:"Template para cursos corporativos com m\xf3dulos estruturados",category:"Educa\xe7\xe3o",variables:[{name:"title",type:"text",required:!0,description:"T\xedtulo do curso"},{name:"subtitle",type:"text",required:!1,description:"Subt\xedtulo opcional"},{name:"objectives",type:"list",required:!1,description:"Lista de objetivos"},{name:"modules",type:"list",required:!0,description:"M\xf3dulos do curso"}]},{id:"safety-presentation",name:"Seguran\xe7a do Trabalho",description:"Apresenta\xe7\xe3o completa sobre seguran\xe7a ocupacional",category:"Seguran\xe7a",variables:[{name:"title",type:"text",required:!1,description:"T\xedtulo personalizado"},{name:"risks",type:"list",required:!1,description:"Riscos espec\xedficos"}]},{id:"quick-slides",name:"Slides R\xe1pidos",description:"Gera\xe7\xe3o r\xe1pida de slides com conte\xfado personalizado",category:"Geral",variables:[{name:"title",type:"text",required:!0,description:"T\xedtulo da apresenta\xe7\xe3o"},{name:"slides",type:"list",required:!0,description:"Lista de slides"}]}]})}catch(e){return console.error("[PPTX Generate API] Template list error:",e),n.NextResponse.json({error:"Erro ao obter templates"},{status:500})}}!function(){var e=Error("Cannot find module '@/lib/pptx/pptx-generator'");throw e.code="MODULE_NOT_FOUND",e}();let m=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/pptx/generate/route",pathname:"/api/pptx/generate",filename:"route",bundlePath:"app/api/pptx/generate/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\pptx\\generate\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:b,serverHooks:f}=m,v="/api/pptx/generate/route";function x(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:b})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),o=t.X(0,[8948,5972],()=>a(925883));module.exports=o})();