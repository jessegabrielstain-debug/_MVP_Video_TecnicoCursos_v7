"use strict";(()=>{var e={};e.id=4253,e.ids=[4253],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},592048:e=>{e.exports=require("fs")},520629:e=>{e.exports=require("fs/promises")},555315:e=>{e.exports=require("path")},122154:(e,o,t)=>{t.r(o),t.d(o,{originalPathname:()=>x,patchFetch:()=>w,requestAsyncStorage:()=>v,routeModule:()=>g,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h});var a={};t.r(a),t.d(a,{POST:()=>l});var r=t(349303),i=t(88716),s=t(60670),n=t(387070),d=t(520629),u=t(555315),c=t(592048);let p={"NR-06":{keywords:["epi","equipamento","prote\xe7\xe3o","individual","capacete","luva","bota","\xf3culos"],suggestions:["Adicionar demonstra\xe7\xe3o pr\xe1tica do uso correto de EPIs","Incluir cen\xe1rio 3D de canteiro de obras","Implementar quiz sobre tipos de EPIs por atividade","Usar avatar demonstrando coloca\xe7\xe3o de equipamentos"]},"NR-10":{keywords:["el\xe9trica","eletricidade","voltagem","tens\xe3o","circuito","instala\xe7\xe3o","energia"],suggestions:["Incluir simula\xe7\xe3o 3D de riscos el\xe9tricos","Adicionar cen\xe1rios de acidentes e preven\xe7\xe3o","Implementar demonstra\xe7\xe3o de procedimentos de seguran\xe7a","Usar efeitos visuais para mostrar campos el\xe9tricos"]},"NR-12":{keywords:["m\xe1quina","equipamento","prote\xe7\xe3o","dispositivo","opera\xe7\xe3o","manuten\xe7\xe3o"],suggestions:["Demonstra\xe7\xe3o 3D de dispositivos de seguran\xe7a","Cen\xe1rios pr\xe1ticos de opera\xe7\xe3o segura","Quiz interativo sobre procedimentos","Avatar demonstrando t\xe9cnicas corretas"]},"NR-17":{keywords:["ergonomia","postura","movimento","repetitivo","mobili\xe1rio","conforto"],suggestions:["Demonstra\xe7\xe3o de posturas corretas e incorretas","Simula\xe7\xe3o 3D de ambiente ergon\xf4mico","Exerc\xedcios interativos de alongamento","An\xe1lise comparativa de posi\xe7\xf5es"]},"NR-35":{keywords:["altura","andaime","cinto","queda","prote\xe7\xe3o","coletiva","individual"],suggestions:["Cen\xe1rio 3D imersivo de trabalho em altura","Demonstra\xe7\xe3o de uso de equipamentos","Simula\xe7\xe3o de procedimentos de resgate","Quiz sobre an\xe1lise de riscos"]}};async function l(e){try{let o=(await e.formData()).get("file");if(!o)return n.NextResponse.json({error:"Arquivo n\xe3o encontrado"},{status:400});let t=(0,u.join)(process.cwd(),"temp");(0,c.existsSync)(t)||await (0,d.mkdir)(t,{recursive:!0});let a=await o.arrayBuffer(),r=Buffer.from(a),i=`temp_${Date.now().toString(36)+Math.random().toString(36).substr(2)}_${o.name}`,s=(0,u.join)(t,i);await (0,d.writeFile)(s,r);try{let e=await m(o.name,r);return await (0,d.unlink)(s),n.NextResponse.json(e)}catch(e){try{await (0,d.unlink)(s)}catch{}throw e}}catch(e){return console.error("Erro na an\xe1lise PPTX:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function m(e,o){await new Promise(e=>setTimeout(e,1e3));let t=Math.floor(25*Math.random())+15,a=e.toLowerCase(),r="NR-06",i=.7;for(let[e,o]of Object.entries(p)){let t=o.keywords.filter(e=>a.includes(e)).length;if(t>0){let a=t/o.keywords.length;a>i&&(r=e,i=a)}}let s=Math.floor(30*i+70),n=t>30?"Avan\xe7ado":t>20?"Intermedi\xe1rio":"B\xe1sico";return{slides:t,duration:35*t,content:Array.from({length:t},(e,o)=>({title:`Slide ${o+1}: ${function(){let e=["Introdu\xe7\xe3o \xe0 Seguran\xe7a","Conceitos Fundamentais","Identifica\xe7\xe3o de Riscos","Procedimentos de Seguran\xe7a","Equipamentos de Prote\xe7\xe3o","Casos Pr\xe1ticos","Legisla\xe7\xe3o Aplic\xe1vel","Boas Pr\xe1ticas","Preven\xe7\xe3o de Acidentes","Responsabilidades"];return e[Math.floor(Math.random()*e.length)]}()}`,content:"Conte\xfado educativo detalhado sobre normas de seguran\xe7a...",notes:"Notas do palestrante para narra\xe7\xe3o e explica\xe7\xf5es adicionais.",images:Math.floor(4*Math.random())})),recommendations:{nr:r,compliance:s,suggestions:p[r]?.suggestions||[]},estimatedVideoTime:Math.ceil(1.8*t),complexity:n}}let g=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/pptx/enhanced-analysis/route",pathname:"/api/pptx/enhanced-analysis",filename:"route",bundlePath:"app/api/pptx/enhanced-analysis/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\pptx\\enhanced-analysis\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:v,staticGenerationAsyncStorage:h,serverHooks:f}=g,x="/api/pptx/enhanced-analysis/route";function w(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}}};var o=require("../../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),a=o.X(0,[8948,5972],()=>t(122154));module.exports=a})();