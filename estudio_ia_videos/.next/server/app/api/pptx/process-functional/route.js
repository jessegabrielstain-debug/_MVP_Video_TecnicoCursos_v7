"use strict";(()=>{var e={};e.id=6279,e.ids=[6279],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},592048:e=>{e.exports=require("fs")},520629:e=>{e.exports=require("fs/promises")},555315:e=>{e.exports=require("path")},580937:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>x,serverHooks:()=>f,staticGenerationAsyncStorage:()=>P});var s={};o.r(s),o.d(s,{GET:()=>m,POST:()=>c});var r=o(349303),a=o(88716),n=o(60670),i=o(387070),u=o(520629),d=o(592048),p=o(555315),l=o.n(p);async function c(e){try{let{fileId:t,fileName:o}=await e.json();if(!t||!o)return i.NextResponse.json({error:"ID do arquivo e nome s\xe3o obrigat\xf3rios"},{status:400});let s=l().join(process.cwd(),"uploads","pptx"),r=l().join(s,o);if(!(0,d.existsSync)(r))return i.NextResponse.json({error:"Arquivo n\xe3o encontrado"},{status:404});let a=await (0,u.readFile)(r),n=new File([a],o,{type:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}),p=Object(function(){var e=Error("Cannot find module '@/lib/pptx/PPTXParser'");throw e.code="MODULE_NOT_FOUND",e}())(),c=await p.parseFile(n),m=p.convertToTimelineData(c),x={id:t,document:{title:c.title,author:c.author,slideCount:c.slideCount,totalDuration:c.totalDuration,createdDate:c.createdDate,theme:c.theme},slides:c.slides.map(e=>({id:e.id,slideNumber:e.slideNumber,title:e.title,content:e.content,duration:e.duration,imageCount:e.images.length,shapeCount:e.shapes.length,animationCount:e.animations.length})),timeline:m,statistics:{totalSlides:c.slideCount,totalDuration:c.totalDuration,averageSlideDuration:c.totalDuration/c.slideCount,totalWords:c.slides.reduce((e,t)=>e+t.content.join(" ").split(/\s+/).length,0),totalImages:c.slides.reduce((e,t)=>e+t.images.length,0),totalShapes:c.slides.reduce((e,t)=>e+t.shapes.length,0)},processedAt:new Date().toISOString()};return i.NextResponse.json({success:!0,message:"PPTX processado com sucesso",data:x})}catch(e){return console.error("Erro no processamento PPTX:",e),i.NextResponse.json({error:"Erro ao processar PPTX",details:e.message,stack:void 0},{status:500})}}async function m(){return i.NextResponse.json({message:"API de Processamento PPTX",description:"Processa arquivos PPTX e extrai conte\xfado para timeline",usage:{method:"POST",body:{fileId:"ID do arquivo",fileName:"Nome do arquivo salvo"}},features:["Extra\xe7\xe3o de slides e conte\xfado","An\xe1lise de texto e imagens","Gera\xe7\xe3o de timeline autom\xe1tica","C\xe1lculo de dura\xe7\xe3o estimada","Extra\xe7\xe3o de metadados"]})}!function(){var e=Error("Cannot find module '@/lib/pptx/PPTXParser'");throw e.code="MODULE_NOT_FOUND",e}();let x=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/pptx/process-functional/route",pathname:"/api/pptx/process-functional",filename:"route",bundlePath:"app/api/pptx/process-functional/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\pptx\\process-functional\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:P,serverHooks:f}=x,g="/api/pptx/process-functional/route";function v(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:P})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),s=t.X(0,[8948,5972],()=>o(580937));module.exports=s})();