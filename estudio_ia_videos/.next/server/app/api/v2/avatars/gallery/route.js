(()=>{var e={};e.id=6377,e.ids=[6377],e.modules={150673:e=>{function a(e){var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}a.keys=()=>[],a.resolve=a,a.id=150673,e.exports=a},636372:e=>{function a(e){var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}a.keys=()=>[],a.resolve=a,a.id=636372,e.exports=a},367696:e=>{function a(e){var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}a.keys=()=>[],a.resolve=a,a.id=367696,e.exports=a},768626:e=>{function a(e){var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}a.keys=()=>[],a.resolve=a,a.id=768626,e.exports=a},220399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},532615:e=>{"use strict";e.exports=require("http")},735240:e=>{"use strict";e.exports=require("https")},768621:e=>{"use strict";e.exports=require("punycode")},276162:e=>{"use strict";e.exports=require("stream")},917360:e=>{"use strict";e.exports=require("url")},671568:e=>{"use strict";e.exports=require("zlib")},45264:(e,a,t)=>{"use strict";t.r(a),t.d(a,{originalPathname:()=>_,patchFetch:()=>y,requestAsyncStorage:()=>v,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{GET:()=>u,POST:()=>d});var r=t(349303),i=t(88716),o=t(60670),n=t(387070),l=t(806251),c=t(577711);async function u(e){try{let{searchParams:a}=new URL(e.url),t=a.get("category"),s=a.get("quality"),r=a.get("language"),i=a.get("search"),o=parseInt(a.get("page")||"1"),u=parseInt(a.get("limit")||"20");console.log("\uD83C\uDFAD API v2: Buscando galeria de avatares..."),console.log(`ðŸ“‚ Categoria: ${t||"todas"}`),console.log(`âœ¨ Qualidade: ${s||"todas"}`),console.log(`ðŸŒ Idioma: ${r||"todos"}`);let d=c.supabaseClient.from("avatar_models").select(`
        *,
        avatar_stats:avatar_stats(*)
      `).eq("is_active",!0);t&&"all"!==t&&(d=d.eq("type",t)),s&&"all"!==s&&(d=d.eq("quality",s)),r&&"all"!==r&&(d=d.contains("supported_languages",[r])),i&&(d=d.or(`name.ilike.%${i}%,display_name.ilike.%${i}%,description.ilike.%${i}%`));let p=(o-1)*u;d=(d=d.range(p,p+u-1)).order("quality",{ascending:!1}).order("usage_count",{ascending:!1});let{data:v,error:m,count:g}=await d;if(m)throw Error(`Erro ao buscar avatares: ${m.message}`);let _=await l.N.getPipelineStats(),{data:y}=await c.supabaseClient.from("avatar_models").select("type").eq("is_active",!0).not("type","is",null),{data:f}=await c.supabaseClient.from("avatar_models").select("quality").eq("is_active",!0).not("quality","is",null),h=[...new Set(y?.map(e=>e.type)||[])],E=[...new Set(f?.map(e=>e.quality)||[])],x={success:!0,data:{avatars:(v||[]).map(e=>({id:e.id,name:e.name,displayName:e.display_name,description:e.description,category:e.type,gender:e.gender,quality:e.quality,features:{audio2FaceCompatible:e.audio2face_compatible,realTimeLipSync:e.real_time_lipsync,rayTracing:e.ray_tracing_support,lipSyncAccuracy:e.lipsync_accuracy||95},preview:{thumbnail:e.thumbnail_url||`/api/v2/avatars/${e.id}/thumbnail.jpg`,model3D:e.model_url||`/api/v2/avatars/${e.id}/preview.gltf`,animation:e.preview_video_url||`/api/v2/avatars/${e.id}/idle.mp4`},assets:{modelFile:e.model_file_path,textureFiles:e.texture_files,rigFile:e.rig_file_path,animationSets:e.animation_sets,blendShapes:e.blend_shapes_file},supportedLanguages:e.supported_languages||["pt-BR"],usageCount:e.usage_count||0,rating:e.rating||5,createdAt:e.created_at,updatedAt:e.updated_at})),pagination:{page:o,limit:u,total:g||0,totalPages:Math.ceil((g||0)/u),hasNext:p+u<(g||0),hasPrev:o>1},filters:{categories:h,qualities:E,supportedLanguages:["pt-BR","en-US","es-ES"],applied:{category:t||"all",quality:s||"all",language:r||"all",search:i||""}},stats:{..._,totalDisplayed:v?.length||0,totalAvailable:g||0},metadata:{version:"2.0.0",audio2FaceEnabled:_.audio2FaceStatus,supportedQualities:E,supportedLanguages:["pt-BR","en-US","es-ES"],renderingEngine:"Unreal Engine 5 + Audio2Face"}}};return n.NextResponse.json(x)}catch(e){return console.error("âŒ Erro na API v2 Gallery:",e),n.NextResponse.json({success:!1,error:{message:"Erro ao carregar galeria de avatares",details:e instanceof Error?e.message:"Erro desconhecido",code:"GALLERY_ERROR"}},{status:500})}}async function d(e){try{let{avatarId:a,action:t,data:s}=await e.json();switch(console.log(`ðŸŽ­ API v2: A\xe7\xe3o na galeria - ${t} para avatar ${a}`),t){case"preview":let{data:r,error:i}=await c.supabaseClient.from("avatar_models").select("*").eq("id",a).eq("is_active",!0).single();if(i||!r)return n.NextResponse.json({success:!1,error:{message:"Avatar n\xe3o encontrado",code:"AVATAR_NOT_FOUND"}},{status:404});return n.NextResponse.json({success:!0,data:{avatar:{id:r.id,name:r.name,displayName:r.display_name,description:r.description,preview:{thumbnail:r.thumbnail_url||`/api/v2/avatars/${r.id}/thumbnail.jpg`,model3D:r.model_url||`/api/v2/avatars/${r.id}/preview.gltf`,animation:r.preview_video_url||`/api/v2/avatars/${r.id}/idle.mp4`},features:{audio2FaceCompatible:r.audio2face_compatible,realTimeLipSync:r.real_time_lipsync,rayTracing:r.ray_tracing_support,lipSyncAccuracy:r.lipsync_accuracy||95},assets:{modelFile:r.model_file_path,textureFiles:r.texture_files,rigFile:r.rig_file_path,animationSets:r.animation_sets,blendShapes:r.blend_shapes_file}}}});case"test_lipsync":let{text:o,audioFile:u,voiceProfileId:d}=s;if(!o)return n.NextResponse.json({success:!1,error:{message:"Texto \xe9 obrigat\xf3rio para teste de lip-sync",code:"MISSING_TEXT"}},{status:400});let{data:p}=await c.supabaseClient.from("avatar_models").select("id, name, audio2face_compatible").eq("id",a).eq("is_active",!0).single();if(!p)return n.NextResponse.json({success:!1,error:{message:"Avatar n\xe3o encontrado",code:"AVATAR_NOT_FOUND"}},{status:404});let v=`test_${a}_${Date.now()}`;try{let e=await l.N.generateHyperRealisticLipSync(a,u||"/audio/test-sample.wav",o,{language:"pt-BR",quality:"high"});return n.NextResponse.json({success:!0,data:{testJobId:v,lipSync:{accuracy:e.accuracy,processingTime:e.processingTime,audio2FaceEnabled:e.audio2FaceEnabled,dataPoints:e.lipSyncData?.length||0,preview:`/api/v2/avatars/${a}/lipsync-test.mp4`,blendShapes:e.lipSyncData?.slice(0,10)},avatar:{id:p.id,name:p.name,audio2FaceCompatible:p.audio2face_compatible}}})}catch(e){return console.error("Erro no teste de lip-sync:",e),n.NextResponse.json({success:!1,error:{message:"Erro ao testar lip-sync",code:"LIPSYNC_TEST_ERROR",details:e instanceof Error?e.message:"Erro desconhecido"}},{status:500})}case"favorite":let{userId:m,isFavorite:g}=s;if(!m)return n.NextResponse.json({success:!1,error:{message:"ID do usu\xe1rio \xe9 obrigat\xf3rio",code:"MISSING_USER_ID"}},{status:400});return n.NextResponse.json({success:!0,data:{avatarId:a,userId:m,isFavorite:!g,message:g?"Avatar removido dos favoritos":"Avatar adicionado aos favoritos"}});default:return n.NextResponse.json({success:!1,error:{message:"A\xe7\xe3o n\xe3o suportada",code:"UNSUPPORTED_ACTION"}},{status:400})}}catch(e){return console.error("âŒ Erro na a\xe7\xe3o da galeria:",e),n.NextResponse.json({success:!1,error:{message:"Erro ao executar a\xe7\xe3o na galeria",details:e instanceof Error?e.message:"Erro desconhecido",code:"GALLERY_ACTION_ERROR"}},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/v2/avatars/gallery/route",pathname:"/api/v2/avatars/gallery",filename:"route",bundlePath:"app/api/v2/avatars/gallery/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\v2\\avatars\\gallery\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:m,serverHooks:g}=p,_="/api/v2/avatars/gallery/route";function y(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},806251:(e,a,t)=>{"use strict";t.d(a,{N:()=>s});let s={renderAvatar:async e=>(console.log("Mocked avatar3DPipeline.renderAvatar called"),e)?{success:!0,videoUrl:"http://example.com/mock-video.mp4"}:{success:!1,error:"Invalid avatar config"},customizeAvatar:async(e,a)=>(console.log("Mocked avatar3DPipeline.customizeAvatar called"),{success:!0,avatarData:{id:e,...a}})}},577711:(e,a,t)=>{"use strict";t.d(a,{OQ:()=>o});var s=t(366763);let r=process.env.NEXT_PUBLIC_SUPABASE_URL,i=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!r||!i)throw Error("Faltam vari\xe1veis de ambiente do Supabase. Verifique o arquivo .env");let o=(0,s.createClient)(r,i,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}}})}};var a=require("../../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8948,5972,6763],()=>t(45264));module.exports=s})();