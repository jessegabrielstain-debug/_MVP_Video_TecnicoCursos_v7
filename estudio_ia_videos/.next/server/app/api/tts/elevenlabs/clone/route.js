"use strict";(()=>{var e={};e.id=817,e.ids=[817],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},67077:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>v,patchFetch:()=>g,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var r={};s.r(r),s.d(r,{POST:()=>l});var a=s(49303),o=s(88716),i=s(60670),n=s(87070),c=s(91630);async function l(e){try{let t=await e.formData(),s=t.get("name"),r=t.get("description"),a=t.getAll("files");if(!s||!r)return n.NextResponse.json({success:!1,error:"Nome e descri\xe7\xe3o s\xe3o obrigat\xf3rios"},{status:400});if(0===a.length)return n.NextResponse.json({success:!1,error:"Pelo menos um arquivo de \xe1udio \xe9 necess\xe1rio"},{status:400});for(let e of a){if(!e.type.startsWith("audio/"))return n.NextResponse.json({success:!1,error:`Arquivo ${e.name} n\xe3o \xe9 um arquivo de \xe1udio v\xe1lido`},{status:400});if(e.size>26214400)return n.NextResponse.json({success:!1,error:`Arquivo ${e.name} \xe9 muito grande. M\xe1ximo 25MB.`},{status:400})}let o=c.ZP.getInstance(),i=await o.cloneVoice(s,r,a);return n.NextResponse.json({success:!0,voice_id:i.voice_id,message:"Voz clonada com sucesso"})}catch(e){return console.error("Erro ao clonar voz:",e),n.NextResponse.json({success:!1,error:"Erro ao clonar voz",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/tts/elevenlabs/clone/route",pathname:"/api/tts/elevenlabs/clone",filename:"route",bundlePath:"app/api/tts/elevenlabs/clone/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\tts\\elevenlabs\\clone\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:h}=u,v="/api/tts/elevenlabs/clone/route";function g(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}},91630:(e,t,s)=>{s.d(t,{O_:()=>n,ZP:()=>c});var r=s(61657),a=s(84770),o=s.n(a);class i{constructor(e={}){this.apiKey=e.apiKey||process.env.ELEVENLABS_API_KEY||"";let t=process.env.SUPABASE_SERVICE_ROLE_KEY;this.supabase=(0,r.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",t)}static getInstance(){return i.instance||(i.instance=new i),i.instance}async generateSpeech(e){if(!this.apiKey)throw Error("ElevenLabs API Key not configured");let t=e.voiceId||e.voice_id||"21m00Tcm4TlvDq8ikWAM",s=e.modelId||e.model_id||"eleven_multilingual_v2",r=e.voice_settings||{stability:.5,similarity_boost:.75},a=o().createHash("md5").update(`${t}-${e.text}-${JSON.stringify(r)}`).digest("hex"),i=`tts/${a}.mp3`,{data:n}=await this.supabase.storage.from("assets").download(i);if(n)return console.log(`ðŸŽ¤ TTS Cache Hit: ${i}`),await n.arrayBuffer();console.log(`ðŸŽ¤ Generating TTS for: "${e.text.substring(0,20)}..."`);let c=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${t}`,{method:"POST",headers:{Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":this.apiKey},body:JSON.stringify({text:e.text,model_id:s,voice_settings:r})});if(!c.ok){let e=await c.text();throw Error(`ElevenLabs API Error: ${c.status} - ${e}`)}let l=await c.arrayBuffer(),{error:u}=await this.supabase.storage.from("assets").upload(i,l,{contentType:"audio/mpeg",upsert:!0});return u&&console.warn("âš ï¸ Failed to cache TTS audio:",u.message),l}async listVoices(){if(!this.apiKey)return[];let e=await fetch("https://api.elevenlabs.io/v1/voices",{headers:{"xi-api-key":this.apiKey}});return e.ok?(await e.json()).voices:[]}async getVoices(){return(await this.listVoices()).map(e=>({id:e.voice_id,name:e.name,category:e.category,description:e.description,labels:e.labels,preview_url:e.preview_url,settings:e.settings,language:e.labels?.language||"unknown",gender:e.labels?.gender||"unknown",accent:e.labels?.accent||"unknown"}))}async getUserInfo(){if(!this.apiKey)return null;let e=await fetch("https://api.elevenlabs.io/v1/user",{headers:{"xi-api-key":this.apiKey}});if(!e.ok)throw Error(`Failed to fetch user info: ${e.statusText}`);return await e.json()}async cloneVoice(e,t,s){if(!this.apiKey)throw Error("ElevenLabs API Key not configured");let r=new FormData;r.append("name",e),t&&r.append("description",t),s.forEach(e=>{r.append("files",e)});let a=await fetch("https://api.elevenlabs.io/v1/voices/add",{method:"POST",headers:{"xi-api-key":this.apiKey},body:r});if(!a.ok){let e=await a.text();throw Error(`ElevenLabs API Error: ${a.status} - ${e}`)}return await a.json()}}let n=new i,c=i}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,5972,1657],()=>s(67077));module.exports=r})();