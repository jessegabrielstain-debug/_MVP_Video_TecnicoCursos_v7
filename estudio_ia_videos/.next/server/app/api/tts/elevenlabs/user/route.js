"use strict";(()=>{var e={};e.id=7930,e.ids=[7930],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},39063:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>v,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var r={};s.r(r),s.d(r,{GET:()=>u});var a=s(49303),i=s(88716),o=s(60670),n=s(87070),p=s(91630);async function u(){try{let e=p.ZP.getInstance(),t=await e.getUserInfo();return n.NextResponse.json({success:!0,user:t})}catch(e){return console.error("Erro ao buscar informa\xe7\xf5es do usu\xe1rio:",e),n.NextResponse.json({success:!1,error:"Erro ao buscar informa\xe7\xf5es do usu\xe1rio",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/tts/elevenlabs/user/route",pathname:"/api/tts/elevenlabs/user",filename:"route",bundlePath:"app/api/tts/elevenlabs/user/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\tts\\elevenlabs\\user\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:h}=c,v="/api/tts/elevenlabs/user/route";function g(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}},91630:(e,t,s)=>{s.d(t,{O_:()=>n,ZP:()=>p});var r=s(61657),a=s(84770),i=s.n(a);class o{constructor(e={}){this.apiKey=e.apiKey||process.env.ELEVENLABS_API_KEY||"";let t=process.env.SUPABASE_SERVICE_ROLE_KEY;this.supabase=(0,r.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",t)}static getInstance(){return o.instance||(o.instance=new o),o.instance}async generateSpeech(e){if(!this.apiKey)throw Error("ElevenLabs API Key not configured");let t=e.voiceId||e.voice_id||"21m00Tcm4TlvDq8ikWAM",s=e.modelId||e.model_id||"eleven_multilingual_v2",r=e.voice_settings||{stability:.5,similarity_boost:.75},a=i().createHash("md5").update(`${t}-${e.text}-${JSON.stringify(r)}`).digest("hex"),o=`tts/${a}.mp3`,{data:n}=await this.supabase.storage.from("assets").download(o);if(n)return console.log(`ðŸŽ¤ TTS Cache Hit: ${o}`),await n.arrayBuffer();console.log(`ðŸŽ¤ Generating TTS for: "${e.text.substring(0,20)}..."`);let p=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${t}`,{method:"POST",headers:{Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":this.apiKey},body:JSON.stringify({text:e.text,model_id:s,voice_settings:r})});if(!p.ok){let e=await p.text();throw Error(`ElevenLabs API Error: ${p.status} - ${e}`)}let u=await p.arrayBuffer(),{error:c}=await this.supabase.storage.from("assets").upload(o,u,{contentType:"audio/mpeg",upsert:!0});return c&&console.warn("âš ï¸ Failed to cache TTS audio:",c.message),u}async listVoices(){if(!this.apiKey)return[];let e=await fetch("https://api.elevenlabs.io/v1/voices",{headers:{"xi-api-key":this.apiKey}});return e.ok?(await e.json()).voices:[]}async getVoices(){return(await this.listVoices()).map(e=>({id:e.voice_id,name:e.name,category:e.category,description:e.description,labels:e.labels,preview_url:e.preview_url,settings:e.settings,language:e.labels?.language||"unknown",gender:e.labels?.gender||"unknown",accent:e.labels?.accent||"unknown"}))}async getUserInfo(){if(!this.apiKey)return null;let e=await fetch("https://api.elevenlabs.io/v1/user",{headers:{"xi-api-key":this.apiKey}});if(!e.ok)throw Error(`Failed to fetch user info: ${e.statusText}`);return await e.json()}async cloneVoice(e,t,s){if(!this.apiKey)throw Error("ElevenLabs API Key not configured");let r=new FormData;r.append("name",e),t&&r.append("description",t),s.forEach(e=>{r.append("files",e)});let a=await fetch("https://api.elevenlabs.io/v1/voices/add",{method:"POST",headers:{"xi-api-key":this.apiKey},body:r});if(!a.ok){let e=await a.text();throw Error(`ElevenLabs API Error: ${a.status} - ${e}`)}return await a.json()}}let n=new o,p=o}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,5972,1657],()=>s(39063));module.exports=r})();