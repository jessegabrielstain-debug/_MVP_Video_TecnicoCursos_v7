"use strict";(()=>{var e={};e.id=5082,e.ids=[5082],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29557:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>b,patchFetch:()=>S,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>h,staticGenerationAsyncStorage:()=>v});var n={};t.r(n),t.d(n,{GET:()=>d,POST:()=>c});var r=t(49303),s=t(88716),o=t(60670),i=t(87070);!function(){var e=Error("Cannot find module 'elevenlabs'");throw e.code="MODULE_NOT_FOUND",e}();let l={"pt-BR":[{id:"elevenlabs-pt-BR-female-1",name:"Ana (Portuguese BR)",language:"pt-BR",gender:"female",accent:"Brazilian",provider:"elevenlabs"},{id:"elevenlabs-pt-BR-male-1",name:"Carlos (Portuguese BR)",language:"pt-BR",gender:"male",accent:"Brazilian",provider:"elevenlabs"},{id:"openai-pt-BR-female-1",name:"Maria (Portuguese BR)",language:"pt-BR",gender:"female",accent:"Brazilian",provider:"openai"}],"en-US":[{id:"elevenlabs-en-US-female-1",name:"Rachel (American)",language:"en-US",gender:"female",accent:"American",provider:"elevenlabs"},{id:"elevenlabs-en-US-male-1",name:"Drew (American)",language:"en-US",gender:"male",accent:"American",provider:"elevenlabs"},{id:"openai-en-US-female-1",name:"Alloy (American)",language:"en-US",gender:"female",accent:"American",provider:"openai"},{id:"openai-en-US-male-1",name:"Echo (American)",language:"en-US",gender:"male",accent:"American",provider:"openai"}],"es-ES":[{id:"elevenlabs-es-ES-female-1",name:"Carmen (Spanish ES)",language:"es-ES",gender:"female",accent:"Castilian",provider:"elevenlabs"},{id:"elevenlabs-es-ES-male-1",name:"Antonio (Spanish ES)",language:"es-ES",gender:"male",accent:"Castilian",provider:"elevenlabs"}],"es-MX":[{id:"elevenlabs-es-MX-female-1",name:"Sofia (Spanish MX)",language:"es-MX",gender:"female",accent:"Mexican",provider:"elevenlabs"}]};class p{constructor(){this.elevenlabs=null;let e=process.env.ELEVENLABS_API_KEY;e&&(this.elevenlabs=Object(function(){var e=Error("Cannot find module 'elevenlabs'");throw e.code="MODULE_NOT_FOUND",e}())({apiKey:e}))}getVoicesForLanguage(e){return l[e]||[]}getSupportedLanguages(){return[{code:"pt-BR",name:"Portuguese (Brazil)",nativeName:"Portugu\xeas (Brasil)"},{code:"en-US",name:"English (US)",nativeName:"English (United States)"},{code:"es-ES",name:"Spanish (Spain)",nativeName:"Espa\xf1ol (Espa\xf1a)"},{code:"es-MX",name:"Spanish (Mexico)",nativeName:"Espa\xf1ol (M\xe9xico)"}]}async generateWithElevenLabs(e,a){if(!this.elevenlabs)throw Error("ElevenLabs API key not configured");try{let t=this.mapVoiceIdToElevenLabs(a.voice),n=await this.elevenlabs.generate({voice:t,text:e,model_id:"eleven_monolingual_v1",voice_settings:{stability:a.stability||.5,similarity_boost:a.similarity_boost||.5,style:a.style||0,use_speaker_boost:a.use_speaker_boost||!0}}),r=await n.arrayBuffer(),s=new Blob([r],{type:"audio/mpeg"});return{audioUrl:URL.createObjectURL(s),duration:this.estimateDuration(e,a.speed),size:s.size,format:"mp3"}}catch(e){throw console.error("ElevenLabs TTS error:",e),Error("Failed to generate speech with ElevenLabs")}}async generateWithOpenAI(e,a){let t=process.env.OPENAI_API_KEY;if(!t)throw Error("OpenAI API key not configured");try{let n=await fetch("https://api.openai.com/v1/audio/speech",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({model:"tts-1",input:e,voice:this.mapVoiceIdToOpenAI(a.voice),response_format:"mp3",speed:a.speed})});if(!n.ok)throw Error(`OpenAI API error: ${n.status}`);let r=await n.blob();return{audioUrl:URL.createObjectURL(r),duration:this.estimateDuration(e,a.speed),size:r.size,format:"mp3"}}catch(e){throw console.error("OpenAI TTS error:",e),Error("Failed to generate speech with OpenAI")}}async generateSpeech(e){let{text:a,config:t}=e;if(!a||0===a.trim().length)throw Error("Text is required for TTS");if(a.length>4e3)throw Error("Text is too long. Maximum 4000 characters.");try{if("elevenlabs"===t.provider)return await this.generateWithElevenLabs(a,t);if("openai"===t.provider)return await this.generateWithOpenAI(a,t);throw Error("Unsupported TTS provider")}catch(e){if("elevenlabs"===t.provider&&process.env.OPENAI_API_KEY)return console.log("Falling back to OpenAI TTS"),await this.generateWithOpenAI(a,t);if("openai"===t.provider&&this.elevenlabs)return console.log("Falling back to ElevenLabs TTS"),await this.generateWithElevenLabs(a,t);throw e}}mapVoiceIdToElevenLabs(e){return({"elevenlabs-pt-BR-female-1":"21m00Tcm4TlvDq8ikWAM","elevenlabs-pt-BR-male-1":"29vD33N1CtxCmqQRPOHJ","elevenlabs-en-US-female-1":"EXAVITQu4vr4xnSDxMaL","elevenlabs-en-US-male-1":"pNInz6obpgDQGcFmaJgB","elevenlabs-es-ES-female-1":"pqdYRXsn6ZVCb3X9sLbR","elevenlabs-es-ES-male-1":"Xb7hH8MSUJpSbSDYk0k2","elevenlabs-es-MX-female-1":"Xb7hH8MSUJpSbSDYk0k2"})[e]||"EXAVITQu4vr4xnSDxMaL"}mapVoiceIdToOpenAI(e){return({"openai-pt-BR-female-1":"nova","openai-en-US-female-1":"alloy","openai-en-US-male-1":"echo"})[e]||"alloy"}estimateDuration(e,a=1){return e.split(/\s+/).length/150*60/a}async getVoiceSample(e){return null}validateConfig(e){let a=[];return e.voice||a.push("Voice is required"),e.language||a.push("Language is required"),(e.speed<.5||e.speed>2)&&a.push("Speed must be between 0.5 and 2.0"),(e.pitch<-50||e.pitch>50)&&a.push("Pitch must be between -50 and 50"),(e.volume<0||e.volume>1)&&a.push("Volume must be between 0.0 and 1.0"),{valid:0===a.length,errors:a}}}let u=new p;async function c(e){try{let{text:a,config:t,projectId:n}=await e.json();if(!a||!t)return i.NextResponse.json({error:"Text and config are required"},{status:400});let r=u.validateConfig(t);if(!r.valid)return i.NextResponse.json({error:"Invalid TTS configuration",details:r.errors},{status:400});let s=await u.generateSpeech({text:a,config:t,projectId:n});return i.NextResponse.json({success:!0,data:s})}catch(e){if(console.error("TTS generation error:",e),e.message?.includes("API key"))return i.NextResponse.json({error:"TTS service not configured. Please contact support."},{status:503});if(e.message?.includes("rate limit"))return i.NextResponse.json({error:"TTS rate limit exceeded. Please try again later."},{status:429});if(e.message?.includes("quota"))return i.NextResponse.json({error:"TTS quota exceeded. Please upgrade your plan."},{status:402});return i.NextResponse.json({error:"Failed to generate speech",details:e.message},{status:500})}}async function d(e){try{let{searchParams:a}=new URL(e.url),t=a.get("language");if(!t)return i.NextResponse.json({error:"Language parameter is required"},{status:400});let n=u.getVoicesForLanguage(t),r=u.getSupportedLanguages();return i.NextResponse.json({success:!0,data:{voices:n,supportedLanguages:r}})}catch(e){return console.error("TTS voices fetch error:",e),i.NextResponse.json({error:"Failed to fetch voices"},{status:500})}}let g=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/tts/generate/route",pathname:"/api/tts/generate",filename:"route",bundlePath:"app/api/tts/generate/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\tts\\generate\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:h}=g,b="/api/tts/generate/route";function S(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:v})}}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),n=a.X(0,[1216],()=>t(29557));module.exports=n})();