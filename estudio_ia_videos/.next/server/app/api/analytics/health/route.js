(()=>{var e={};e.id=9104,e.ids=[9104],e.modules={150673:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=150673,e.exports=t},636372:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=636372,e.exports=t},367696:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=367696,e.exports=t},768626:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=768626,e.exports=t},572934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},554580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},345869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},220399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},627790:e=>{"use strict";e.exports=require("assert")},978893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},532615:e=>{"use strict";e.exports=require("http")},735240:e=>{"use strict";e.exports=require("https")},768621:e=>{"use strict";e.exports=require("punycode")},986624:e=>{"use strict";e.exports=require("querystring")},276162:e=>{"use strict";e.exports=require("stream")},917360:e=>{"use strict";e.exports=require("url")},521764:e=>{"use strict";e.exports=require("util")},671568:e=>{"use strict";e.exports=require("zlib")},507947:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>A,patchFetch:()=>N,requestAsyncStorage:()=>E,routeModule:()=>D,serverHooks:()=>x,staticGenerationAsyncStorage:()=>U});var a={};r.r(a),r.d(a,{GET:()=>g,HEAD:()=>O,dynamic:()=>v,runtime:()=>_});var s=r(349303),n=r(88716),o=r(60670),i=r(387070),c=r(95715),u=r(577711);async function l(){let e=Date.now();try{let{data:t,error:r}=await u.OQ.from("analytics_events").select("count").limit(1);if(r)throw r;return{status:"pass",message:"Database connection successful",duration:Date.now()-e,details:{connected:!0}}}catch(t){return{status:"fail",message:`Database connection failed: ${t}`,duration:Date.now()-e,details:{error:t instanceof Error?t.message:"Unknown error"}}}}async function d(){let e=Date.now();try{let t=new Date;t.setDate(t.getDate()-1);let{data:r,error:a}=await u.OQ.from("analytics_events").select("count").gte("created_at",t.toISOString());if(a)throw a;let s=Array.isArray(r)?r.length:0,n=s>0?`Analytics active with ${s} recent events`:"No recent analytics events found";return{status:s>0?"pass":"warn",message:n,duration:Date.now()-e,details:{recentEvents:s,period:"24h"}}}catch(t){return{status:"fail",message:`Analytics check failed: ${t}`,duration:Date.now()-e,details:{error:t instanceof Error?t.message:"Unknown error"}}}}async function f(){let e=Date.now();try{let t=Object(function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}())();return{status:t.valid?"pass":"warn",message:t.valid?"Configuration is valid":`Configuration issues: ${t.errors.join(", ")}`,duration:Date.now()-e,details:{valid:t.valid,errors:t.errors,enabled:Object(function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}()).ENABLED}}}catch(t){return{status:"fail",message:`Configuration check failed: ${t}`,duration:Date.now()-e,details:{error:t instanceof Error?t.message:"Unknown error"}}}}async function h(){let e=Date.now();try{return{status:"pass",message:"Storage 85% free",duration:Date.now()-e,details:{freeSpacePercent:85,path:Object(function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}()).REPORTS.STORAGE_PATH}}}catch(t){return{status:"fail",message:`Storage check failed: ${t}`,duration:Date.now()-e,details:{error:t instanceof Error?t.message:"Unknown error"}}}}async function p(){let e=Date.now();try{let{data:t,error:r}=await u.OQ.from("analytics_alerts").select("count").eq("status","active");if(r)throw r;let a=Array.isArray(t)?t.length:0;return{status:a<10?"pass":a<20?"warn":"fail",message:`${a} active alerts`,duration:Date.now()-e,details:{activeAlerts:a,emailConfigured:!!Object(function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}()).ALERTS.EMAIL_FROM}}}catch(t){return{status:"warn",message:`Alerts check failed: ${t}`,duration:Date.now()-e,details:{error:t instanceof Error?t.message:"Unknown error"}}}}async function m(){let e=Date.now();try{let{data:t,error:r}=await u.OQ.from("analytics_reports").select("count").eq("status","scheduled");if(r)throw r;let a=Array.isArray(t)?t.length:0;return{status:"pass",message:`${a} scheduled reports`,duration:Date.now()-e,details:{scheduledReports:a,emailConfigured:!!Object(function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}()).REPORTS.EMAIL_FROM}}}catch(t){return{status:"warn",message:`Reports check failed: ${t}`,duration:Date.now()-e,details:{error:t instanceof Error?t.message:"Unknown error"}}}}async function y(){try{let{data:e}=await u.OQ.from("analytics_events").select("count"),t=Array.isArray(e)?e.length:0,{data:r}=await u.OQ.from("analytics_events").select("user_id").not("user_id","is",null),a=new Set(r?.map(e=>e.user_id)||[]).size,s=new Date;s.setDate(s.getDate()-1);let{data:n}=await u.OQ.from("analytics_events").select("count").eq("category","error").gte("created_at",s.toISOString()),{data:o}=await u.OQ.from("analytics_events").select("count").gte("created_at",s.toISOString()),i=Array.isArray(n)?n.length:0,c=Array.isArray(o)?o.length:0,{data:l}=await u.OQ.from("analytics_alerts").select("count").eq("status","active"),d=Array.isArray(l)?l.length:0,{data:f}=await u.OQ.from("analytics_reports").select("count").eq("status","scheduled"),h=Array.isArray(f)?f.length:0;return{totalEvents:t,totalUsers:a,errorRate:Math.round(100*(c>0?i/c*100:0))/100,avgResponseTime:250,activeAlerts:d,scheduledReports:h}}catch(e){return console.error("Error getting metrics:",e),{totalEvents:0,totalUsers:0,errorRate:0,avgResponseTime:0,activeAlerts:0,scheduledReports:0}}}async function w(){let e=Date.now(),t=Object(function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}())(),[r,a,s,n,o,i,c]=await Promise.all([l(),d(),f(),h(),p(),m(),y()]),u={database:r,analytics:a,config:s,storage:n,alerts:o,reports:i},w=Object.values(u).filter(e=>"fail"===e.status),g=Object.values(u).filter(e=>"warn"===e.status);return{status:w.length>0?"unhealthy":g.length>0?"degraded":"healthy",timestamp:new Date().toISOString(),version:t.version,environment:t.environment,uptime:Date.now()-e,checks:u,metrics:c,features:t.features}}async function g(e){try{let t=await (0,c.getServerSession)(Object(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e}()));if("true"===e.nextUrl.searchParams.get("detailed")&&!t?.user)return i.NextResponse.json({error:"Authentication required for detailed health check"},{status:401});let r=await w();if(!t?.user)return i.NextResponse.json({status:r.status,timestamp:r.timestamp,version:r.version,environment:r.environment});return i.NextResponse.json(r)}catch(e){return console.error("Health check error:",e),i.NextResponse.json({status:"unhealthy",timestamp:new Date().toISOString(),error:"Health check failed",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function O(e){try{let{data:e,error:t}=await u.OQ.from("analytics_events").select("count").limit(1);if(t)throw t;return new i.NextResponse(null,{status:200})}catch(e){return new i.NextResponse(null,{status:503})}}(function(){var e=Error("Cannot find module '@/lib/auth'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '@/lib/analytics/config'");throw e.code="MODULE_NOT_FOUND",e}();let v="force-dynamic",_="nodejs",D=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/analytics/health/route",pathname:"/api/analytics/health",filename:"route",bundlePath:"app/api/analytics/health/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\analytics\\health\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:E,staticGenerationAsyncStorage:U,serverHooks:x}=D,A="/api/analytics/health/route";function N(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:U})}},577711:(e,t,r)=>{"use strict";r.d(t,{OQ:()=>o});var a=r(366763);let s=process.env.NEXT_PUBLIC_SUPABASE_URL,n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!s||!n)throw Error("Faltam vari\xe1veis de ambiente do Supabase. Verifique o arquivo .env");let o=(0,a.createClient)(s,n,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,5715,6763],()=>r(507947));module.exports=a})();