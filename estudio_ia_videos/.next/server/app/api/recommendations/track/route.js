"use strict";(()=>{var e={};e.id=838,e.ids=[838],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},10898:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{POST:()=>d});var n=r(49303),o=r(88716),i=r(60670),s=r(87070),c=r(97234);async function d(e){try{let{userId:t,recommendationId:r,itemId:a,action:n}=await e.json();if(!t||!r||!a||!n)return s.NextResponse.json({error:"Missing required fields: userId, recommendationId, itemId, action"},{status:400});let o=["view","click","dismiss","apply"];if(!o.includes(n))return s.NextResponse.json({error:`Invalid action. Must be one of: ${o.join(", ")}`},{status:400});return await c.U.trackInteraction(t,a,"click"===n||"apply"===n?"use":"dismiss"===n?"skip":"view"),s.NextResponse.json({success:!0,message:"Interaction tracked successfully"})}catch(e){return console.error("Track interaction error:",e),s.NextResponse.json({error:e instanceof Error?e.message:"Failed to track interaction"},{status:500})}}let u=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/recommendations/track/route",pathname:"/api/recommendations/track",filename:"route",bundlePath:"app/api/recommendations/track/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\recommendations\\track\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:l,serverHooks:m}=u,v="/api/recommendations/track/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},97234:(e,t,r)=>{r.d(t,{U:()=>o});var a=r(8261);class n{async getRecommendations(e,t,r=10){console.log(`[Recommendations] Getting for user ${e}`);let n=[];try{(await a._.nrTemplate.findMany({take:5,orderBy:{updatedAt:"desc"}})).forEach(e=>{n.push({id:e.id,type:"template",title:e.title,description:e.description||`Template for ${e.nrNumber}`,relevanceScore:.8,metadata:{nrNumber:e.nrNumber,duration:e.durationSeconds}})}),(await a._.course.findMany({take:3,orderBy:{createdAt:"desc"}})).forEach(e=>{n.push({id:e.id,type:"course",title:e.title,description:e.description||"",relevanceScore:.7,metadata:{authorId:e.authorId}})})}catch(e){console.error("Error fetching recommendations:",e)}return n.slice(0,r)}async trackInteraction(e,t,r){try{await a._.analyticsEvent.create({data:{userId:e,eventType:"recommendation_interaction",eventData:{itemId:t,interactionType:r,timestamp:new Date().toISOString()}}})}catch(e){console.error("Error tracking interaction:",e)}}}let o=new n},8261:(e,t,r)=>{r.d(t,{_:()=>n});var a=r(53524);let n=global.prisma||new a.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>r(10898));module.exports=a})();