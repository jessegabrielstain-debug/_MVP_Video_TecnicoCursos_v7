"use strict";(()=>{var e={};e.id=6903,e.ids=[6903],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},54979:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{GET:()=>m,POST:()=>d});var n=r(49303),o=r(88716),i=r(60670),s=r(87070),c=r(97234);async function d(e){try{let{userId:t,types:r,limit:a}=await e.json();if(!t)return s.NextResponse.json({error:"Missing required field: userId"},{status:400});let n=await c.U.getRecommendations(t,r?{filterTypes:r}:void 0,a||10),o=r?n.filter(e=>r.includes(e.type)):n;return s.NextResponse.json({success:!0,recommendations:o.map(e=>({id:e.id,type:e.type,title:e.title,description:e.description,relevanceScore:e.relevanceScore,metadata:e.metadata}))})}catch(e){return console.error("Generate recommendations error:",e),s.NextResponse.json({error:e instanceof Error?e.message:"Failed to generate recommendations"},{status:500})}}async function m(e){try{let t=e.nextUrl.searchParams,r=t.get("userId"),a=t.get("limit");if(!r)return s.NextResponse.json({error:"Missing userId parameter"},{status:400});let n=await c.U.getRecommendations(r,void 0,a?parseInt(a,10):10);return s.NextResponse.json({success:!0,recommendations:n.map(e=>({id:e.id,type:e.type,title:e.title,description:e.description,relevanceScore:e.relevanceScore,metadata:e.metadata}))})}catch(e){return console.error("Get recommendations error:",e),s.NextResponse.json({error:e instanceof Error?e.message:"Failed to get recommendations"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/recommendations/generate/route",pathname:"/api/recommendations/generate",filename:"route",bundlePath:"app/api/recommendations/generate/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\recommendations\\generate\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:u,staticGenerationAsyncStorage:l,serverHooks:g}=p,v="/api/recommendations/generate/route";function y(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},97234:(e,t,r)=>{r.d(t,{U:()=>o});var a=r(8261);class n{async getRecommendations(e,t,r=10){console.log(`[Recommendations] Getting for user ${e}`);let n=[];try{(await a._.nrTemplate.findMany({take:5,orderBy:{updatedAt:"desc"}})).forEach(e=>{n.push({id:e.id,type:"template",title:e.title,description:e.description||`Template for ${e.nrNumber}`,relevanceScore:.8,metadata:{nrNumber:e.nrNumber,duration:e.durationSeconds}})}),(await a._.course.findMany({take:3,orderBy:{createdAt:"desc"}})).forEach(e=>{n.push({id:e.id,type:"course",title:e.title,description:e.description||"",relevanceScore:.7,metadata:{authorId:e.authorId}})})}catch(e){console.error("Error fetching recommendations:",e)}return n.slice(0,r)}async trackInteraction(e,t,r){try{await a._.analyticsEvent.create({data:{userId:e,eventType:"recommendation_interaction",eventData:{itemId:t,interactionType:r,timestamp:new Date().toISOString()}}})}catch(e){console.error("Error tracking interaction:",e)}}}let o=new n},8261:(e,t,r)=>{r.d(t,{_:()=>n});var a=r(53524);let n=global.prisma||new a.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>r(54979));module.exports=a})();