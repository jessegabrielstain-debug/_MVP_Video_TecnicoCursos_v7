"use strict";(()=>{var e={};e.id=4458,e.ids=[4458],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},61212:e=>{e.exports=require("async_hooks")},78893:e=>{e.exports=require("buffer")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},27920:e=>{e.exports=require("diagnostics_channel")},80665:e=>{e.exports=require("dns")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},85807:e=>{e.exports=require("module")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},96119:e=>{e.exports=require("perf_hooks")},35816:e=>{e.exports=require("process")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},74175:e=>{e.exports=require("tty")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},17718:e=>{e.exports=require("node:child_process")},65714:e=>{e.exports=require("node:diagnostics_channel")},15673:e=>{e.exports=require("node:events")},87561:e=>{e.exports=require("node:fs")},88849:e=>{e.exports=require("node:http")},22286:e=>{e.exports=require("node:https")},85690:e=>{e.exports=require("node:inspector")},82033:e=>{e.exports=require("node:module")},87503:e=>{e.exports=require("node:net")},70612:e=>{e.exports=require("node:os")},49411:e=>{e.exports=require("node:path")},51747:e=>{e.exports=require("node:readline")},84492:e=>{e.exports=require("node:stream")},31764:e=>{e.exports=require("node:tls")},47261:e=>{e.exports=require("node:util")},24086:e=>{e.exports=require("node:worker_threads")},65628:e=>{e.exports=require("node:zlib")},12552:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>q,requestAsyncStorage:()=>g,routeModule:()=>f,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v});var i={};r.r(i),r.d(i,{DELETE:()=>m,GET:()=>h,POST:()=>d,PUT:()=>c,dynamic:()=>p});var s=r(49303),n=r(88716),a=r(60670),o=r(87070),u=r(13936),l=r(60354);let p="force-dynamic";async function h(e){try{let t=(0,u.getSupabaseForRequest)(e),{data:{user:r}}=await t.auth.getUser(),{searchParams:i}=new URL(e.url),s=i.get("category"),n=i.get("search"),a=parseInt(i.get("limit")||"50"),p=parseInt(i.get("offset")||"0"),h=l.pR.from("nr_templates").select("*");s&&(h=h.eq("nr_number",s)),n&&(h=h.ilike("title",`%${n}%`));let{data:d,error:c}=await h;if(c)throw c;let m=(d||[]).map(e=>({id:e.id,name:e.title,description:e.description||"",category:e.nr_number,thumbnail:`https://trae-api-us.mchost.guru/api/ide/v1/text_to_image?prompt=${encodeURIComponent(e.title+" safety training")}&image_size=square`,preview:"",tags:[e.nr_number,"NR","Safety"],isFavorite:!1,isCustom:!1,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at||Date.now()),author:"Sistema",version:"1.0",downloads:0,rating:0,content:{slides:[],assets:[],animations:[],interactions:[],settings:{duration:e.duration_seconds||600,resolution:{width:1920,height:1080},frameRate:30,renderSettings:{quality:"medium",format:"mp4"}},compliance:{nrCategory:e.nr_number,requirements:[],checkpoints:[],certifications:[]},performance:{renderTime:0,fileSize:0,complexity:"medium"}},metadata:{difficulty:"intermediate",estimatedDuration:e.duration_seconds?e.duration_seconds/60:10,targetAudience:[],learningObjectives:[],prerequisites:[],language:"pt-BR",accessibility:{screenReader:!0,highContrast:!1,keyboardNavigation:!0,closedCaptions:!0,audioDescription:!1,signLanguage:!1},compliance:{nrCategories:[e.nr_number],lastAudit:new Date,auditScore:100,certifications:[],status:"compliant",requirements:[`Requisito base da ${e.nr_number}`,"Conformidade t\xe9cnica verificada"]},performance:{renderTime:0,fileSize:0,complexity:"medium"}}})),f=[];if(r){let e=t.from("projects").select("*").eq("user_id",r.id).eq("is_template",!0);n&&(e=e.ilike("name",`%${n}%`));let{data:i,error:s}=await e;!s&&i&&(f=i.map(e=>{let t=e.metadata||{};return{id:e.id,name:e.name,description:e.description||"",category:t.category||"Custom",thumbnail:`https://trae-api-us.mchost.guru/api/ide/v1/text_to_image?prompt=${encodeURIComponent(e.name)}&image_size=square`,preview:"",tags:t.tags||["Custom"],isFavorite:!1,isCustom:!0,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at),author:r.email||"User",version:e.current_version||"1.0",downloads:0,rating:0,content:{slides:[],assets:[],animations:[],interactions:[],settings:{duration:0,resolution:{width:1920,height:1080},frameRate:30,renderSettings:{quality:"medium",format:"mp4"}},compliance:{nrCategory:"Custom",requirements:[],checkpoints:[],certifications:[]},performance:{renderTime:0,fileSize:0,complexity:"medium"}},metadata:{difficulty:t.difficulty||"intermediate",estimatedDuration:0,targetAudience:[],learningObjectives:[],prerequisites:[],language:"pt-BR",accessibility:{screenReader:!0,highContrast:!1,keyboardNavigation:!0,closedCaptions:!0,audioDescription:!1,signLanguage:!1},compliance:{nrCategories:[],lastAudit:new Date,auditScore:0,certifications:[],status:"pending",requirements:[]},performance:{renderTime:0,fileSize:0,complexity:"medium"}}}}))}let g=[...m,...f].slice(p,p+a);return o.NextResponse.json(g)}catch(e){return console.error("Error fetching templates:",e),o.NextResponse.json({error:"Failed to fetch templates"},{status:500})}}async function d(e){try{let t=(0,u.getSupabaseForRequest)(e),{data:{user:r}}=await t.auth.getUser();if(!r)return o.NextResponse.json({error:"Unauthorized"},{status:401});let i=await e.json(),{data:s,error:n}=await t.from("projects").insert({name:i.name,description:i.description,type:"custom",status:"completed",user_id:r.id,is_template:!0,metadata:{category:i.category,tags:i.tags,difficulty:i.metadata?.difficulty}}).select().single();if(n)throw n;return o.NextResponse.json(s,{status:201})}catch(e){return console.error("Error creating template:",e),o.NextResponse.json({error:"Failed to create template"},{status:500})}}async function c(e){try{let t=(0,u.getSupabaseForRequest)(e),{data:{user:r}}=await t.auth.getUser();if(!r)return o.NextResponse.json({error:"Unauthorized"},{status:401});let{id:i,...s}=await e.json();if(!i)return o.NextResponse.json({error:"Template ID is required"},{status:400});let{data:n,error:a}=await t.from("projects").select("user_id, is_template, metadata").eq("id",i).single();if(a||!n)return o.NextResponse.json({error:"Template not found"},{status:404});if(n.user_id!==r.id)return o.NextResponse.json({error:"Forbidden"},{status:403});if(!n.is_template)return o.NextResponse.json({error:"Project is not a template"},{status:400});let l=n.metadata||{},{data:p,error:h}=await t.from("projects").update({name:s.name,description:s.description,metadata:{...l,category:s.category,tags:s.tags,difficulty:s.metadata?.difficulty},updated_at:new Date().toISOString()}).eq("id",i).select().single();if(h)throw h;return o.NextResponse.json(p)}catch(e){return console.error("Error updating template:",e),o.NextResponse.json({error:"Failed to update template"},{status:500})}}async function m(e){try{let t=(0,u.getSupabaseForRequest)(e),{data:{user:r}}=await t.auth.getUser();if(!r)return o.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:i}=new URL(e.url),s=i.get("id");if(!s)return o.NextResponse.json({error:"Template ID is required"},{status:400});let{data:n,error:a}=await t.from("projects").select("user_id, is_template").eq("id",s).single();if(a||!n)return o.NextResponse.json({error:"Template not found"},{status:404});if(n.user_id!==r.id)return o.NextResponse.json({error:"Forbidden"},{status:403});if(!n.is_template)return o.NextResponse.json({error:"Project is not a template"},{status:400});let{error:l}=await t.from("projects").delete().eq("id",s);if(l)throw l;return o.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting template:",e),o.NextResponse.json({error:"Failed to delete template"},{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/templates/route",pathname:"/api/templates",filename:"route",bundlePath:"app/api/templates/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\templates\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:x}=f,y="/api/templates/route";function q(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:v})}},83988:e=>{e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},10949:(e,t,r)=>{function i(e){var t=this;if(t instanceof i||(t=new i),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(arguments.length>0)for(var r=0,s=arguments.length;r<s;r++)t.push(arguments[r]);return t}function s(e,t,r,i){if(!(this instanceof s))return new s(e,t,r,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=i,i.Node=s,i.create=i,i.prototype.removeNode=function(e){if(e.list!==this)throw Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},i.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},i.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},i.prototype.push=function(){for(var e,t=0,r=arguments.length;t<r;t++)e=arguments[t],this.tail=new s(e,this.tail,null,this),this.head||(this.head=this.tail),this.length++;return this.length},i.prototype.unshift=function(){for(var e,t=0,r=arguments.length;t<r;t++)e=arguments[t],this.head=new s(e,null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},i.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},i.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},i.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,i=0;null!==r;i++)e.call(t,r.value,i,this),r=r.next},i.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,i=this.length-1;null!==r;i--)e.call(t,r.value,i,this),r=r.prev},i.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},i.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},i.prototype.map=function(e,t){t=t||this;for(var r=new i,s=this.head;null!==s;)r.push(e.call(t,s.value,this)),s=s.next;return r},i.prototype.mapReverse=function(e,t){t=t||this;for(var r=new i,s=this.tail;null!==s;)r.push(e.call(t,s.value,this)),s=s.prev;return r},i.prototype.reduce=function(e,t){var r,i=this.head;if(arguments.length>1)r=t;else if(this.head)i=this.head.next,r=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var s=0;null!==i;s++)r=e(r,i.value,s),i=i.next;return r},i.prototype.reduceReverse=function(e,t){var r,i=this.tail;if(arguments.length>1)r=t;else if(this.tail)i=this.tail.prev,r=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;null!==i;s--)r=e(r,i.value,s),i=i.prev;return r},i.prototype.toArray=function(){for(var e=Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},i.prototype.toArrayReverse=function(){for(var e=Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},i.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new i;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var s=0,n=this.head;null!==n&&s<e;s++)n=n.next;for(;null!==n&&s<t;s++,n=n.next)r.push(n.value);return r},i.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new i;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var s=this.length,n=this.tail;null!==n&&s>t;s--)n=n.prev;for(;null!==n&&s>e;s--,n=n.prev)r.push(n.value);return r},i.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,n=this.head;null!==n&&i<e;i++)n=n.next;for(var a=[],i=0;n&&i<t;i++)a.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(var i=0;i<r.length;i++)n=function(e,t,r){var i=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}(this,n,r[i]);return a},i.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var i=r.prev;r.prev=r.next,r.next=i}return this.head=t,this.tail=e,this};try{r(83988)(i)}catch(e){}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,5972,1657,9702,9092,7686,6608,3595],()=>r(12552));module.exports=i})();