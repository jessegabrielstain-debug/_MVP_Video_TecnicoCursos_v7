"use strict";(()=>{var e={};e.id=8718,e.ids=[8718],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},34614:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>p});var o=r(49303),i=r(88716),a=r(60670),n=r(87070),u=r(75571),g=r(95306),d=r(81232),l=r(20856);async function p(e,{params:t}){try{let r=await (0,u.getServerSession)(g.L);if(!r?.user?.id)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let s=await (0,d.IV)(r.user.id,t.orgId);if(!s)return n.NextResponse.json({error:"Organiza\xe7\xe3o n\xe3o encontrada"},{status:404});if(!(0,d.Fs)(s.role,"org:manage"))return n.NextResponse.json({error:"Sem permiss\xe3o"},{status:403});let{searchParams:o}=new URL(e.url),i=o.get("userId")||void 0,a=o.get("action")||void 0,p=o.get("resource")||void 0,c=o.get("startDate")?new Date(o.get("startDate")):void 0,m=o.get("endDate")?new Date(o.get("endDate")):void 0,x=parseInt(o.get("limit")||"100"),f=parseInt(o.get("offset")||"0"),h=await (0,l.FA)({organizationId:t.orgId,userId:i,action:a,resource:p,startDate:c,endDate:m,limit:x,offset:f});return n.NextResponse.json(h)}catch(e){return console.error("Erro ao buscar audit logs:",e),n.NextResponse.json({error:"Erro ao buscar logs"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/org/[orgId]/audit-logs/route",pathname:"/api/org/[orgId]/audit-logs",filename:"route",bundlePath:"app/api/org/[orgId]/audit-logs/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\org\\[orgId]\\audit-logs\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:f}=c,h="/api/org/[orgId]/audit-logs/route";function v(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:x})}},95306:(e,t,r)=>{r.d(t,{L:()=>s});let s={providers:[],session:{strategy:"jwt"},callbacks:{}}},20856:(e,t,r)=>{r.d(t,{FA:()=>i});class s{log(e){let t={...e,id:crypto.randomUUID(),timestamp:new Date};this.logs.push(t),this.logs.length>this.maxLogs&&(this.logs=this.logs.slice(-this.maxLogs))}async getLogs(e){let t=[...this.logs];if(e){e.userId&&(t=t.filter(t=>t.userId===e.userId));let r=e.orgId||e.organizationId;r&&(t=t.filter(e=>e.orgId===r||e.organizationId===r)),e.action&&(t=t.filter(t=>t.action===e.action)),e.resource&&(t=t.filter(t=>t.resource===e.resource)),e.startDate&&(t=t.filter(t=>t.timestamp>=e.startDate)),e.endDate&&(t=t.filter(t=>t.timestamp<=e.endDate))}t.sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime());let r=t.length;return e?.offset!==void 0&&e?.limit!==void 0?t=t.slice(e.offset,e.offset+e.limit):e?.limit!==void 0&&(t=t.slice(0,e.limit)),{logs:t,total:r}}clear(){this.logs=[]}constructor(){this.logs=[],this.maxLogs=1e4}}let o=new s,i=e=>o.getLogs(e)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,5571,1519],()=>r(34614));module.exports=s})();