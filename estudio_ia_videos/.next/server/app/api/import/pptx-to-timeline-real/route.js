"use strict";(()=>{var e={};e.id=7134,e.ids=[7134,3936],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},97675:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var i={};r.r(i),r.d(i,{POST:()=>l});var o=r(49303),s=r(88716),a=r(60670),n=r(87070),p=r(13936);async function l(e){try{let t=(0,p.getSupabaseForRequest)(e),{data:{user:r}}=await t.auth.getUser();if(!r)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{projectId:i}=await e.json();if(!i)return n.NextResponse.json({error:"Project ID is required"},{status:400});let{data:o,error:s}=await t.from("projects").select("name").eq("id",i).single();if(s)return console.error("Error fetching project:",s),n.NextResponse.json({error:"Error fetching project details"},{status:500});let{data:a,error:l}=await t.from("slides").select("*").eq("project_id",i).order("order_index",{ascending:!0});if(l)return console.error("Error fetching slides:",l),n.NextResponse.json({error:"Error fetching slides"},{status:500});if(!a||0===a.length)return n.NextResponse.json({error:"No slides found for this project"},{status:404});let u=5*a.length,d=a.map((e,t)=>({id:`slide-${e.id}`,type:"image",name:e.title||`Slide ${e.order_index+1}`,duration:e.duration||5,startTime:t*(e.duration||5),layer:0,visible:!0,locked:!1,properties:{src:e.background_image||"/placeholder.png",opacity:1,x:0,y:0,scale:1,rotation:0}})),c=a.filter(e=>e.title).map((e,t)=>({id:`text-${e.id}`,type:"text",name:`Title ${e.order_index+1}`,duration:e.duration||5,startTime:t*(e.duration||5),layer:1,visible:!0,locked:!1,properties:{content:e.title,fontSize:48,color:"#ffffff",x:0,y:-200,opacity:1,scale:1,rotation:0}})),m={id:i,name:o?.name||"Imported Project",duration:u,fps:30,width:1920,height:1080,currentTime:0,isPlaying:!1,zoom:1,tracks:[{id:"track-video",name:"Slides PPTX",type:"video",visible:!0,locked:!1,elements:d},{id:"track-text",name:"Titles",type:"overlay",visible:!0,locked:!1,elements:c},{id:"track-audio",name:"Audio",type:"audio",visible:!0,locked:!1,elements:[]}]},{error:h}=await t.from("projects").update({metadata:{timeline:m},render_settings:{duration:u,fps:30,width:1920,height:1080}}).eq("id",i);if(h)return console.error("Error updating project:",h),n.NextResponse.json({error:"Error updating project"},{status:500});return n.NextResponse.json({success:!0,message:"Slides imported to timeline successfully",timeline:m})}catch(e){return console.error("Error importing PPTX:",e),n.NextResponse.json({error:"Internal Server Error"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/import/pptx-to-timeline-real/route",pathname:"/api/import/pptx-to-timeline-real",filename:"route",bundlePath:"app/api/import/pptx-to-timeline-real/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\import\\pptx-to-timeline-real\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:m}=u,h="/api/import/pptx-to-timeline-real/route";function x(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},13936:(e,t,r)=>{r.d(t,{e:()=>a,getSupabaseForRequest:()=>p,p:()=>n});var i=r(67721),o=r(61657),s=r(71615);let a=()=>{let e=(0,s.cookies)();return(0,i.createServerClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{cookies:{get:t=>e.get(t)?.value,set(t,r,i){try{e.set({name:t,value:r,...i})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})},n=(0,o.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});function p(e){let t=e.headers.get("authorization")||e.headers.get("Authorization");return t?(0,o.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{global:{headers:{Authorization:t}},auth:{persistSession:!1,autoRefreshToken:!1}}):a()}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,5972,1657,9702],()=>r(97675));module.exports=i})();