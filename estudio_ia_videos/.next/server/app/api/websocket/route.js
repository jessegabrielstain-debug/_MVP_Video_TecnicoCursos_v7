"use strict";(()=>{var e={};e.id=455,e.ids=[455],e.modules={220399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},430517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},532615:e=>{e.exports=require("http")},917360:e=>{e.exports=require("url")},185635:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>j,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>S,staticGenerationAsyncStorage:()=>R});var t={};r.r(t),r.d(t,{DELETE:()=>b,GET:()=>k,POST:()=>m});var o=r(349303),n=r(88716),c=r(60670),a=r(532615),u=r(917360);let i=require("next/dist/lib/import-next-warning");var l=r.n(i);!function(){var e=Error("Cannot find module '@/lib/notifications/websocket-server'");throw e.code="MODULE_NOT_FOUND",e}();let p=process.env.HOSTNAME||"localhost",d=parseInt(process.env.PORT||"3000",10),g=null,v=null;async function k(e){try{if(g&&v)return Response.json({success:!0,message:"WebSocket server already running",port:d,stats:v.getServerStats()});let e=l()({dev:!1,hostname:p,port:d}),s=e.getRequestHandler();return await e.prepare(),g=(0,a.createServer)(async(e,r)=>{try{let t=(0,u.parse)(e.url,!0);await s(e,r,t)}catch(s){console.error("Error occurred handling",e.url,s),r.statusCode=500,r.end("Internal server error")}}),v=Object(function(){var e=Error("Cannot find module '@/lib/notifications/websocket-server'");throw e.code="MODULE_NOT_FOUND",e}())(g),g.listen(d,()=>{console.log(`> Ready on http://${p}:${d}`),console.log("> WebSocket server initialized")}),Response.json({success:!0,message:"WebSocket server started successfully",port:d,hostname:p})}catch(e){return console.error("Error starting WebSocket server:",e),Response.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function m(e){try{let{action:s,data:r}=await e.json();if(!v)return Response.json({success:!1,error:"WebSocket server not initialized"},{status:400});switch(s){case"broadcast_alert":return v.broadcastSystemAlert(r.message,r.priority||"medium"),Response.json({success:!0,message:"Alert broadcasted"});case"kick_user":let t=v.kickUser(r.userId,r.reason);return Response.json({success:t,message:t?"User kicked":"User not found"});case"get_stats":let o=v.getServerStats();return Response.json({success:!0,stats:o});case"get_users":let n=v.getConnectedUsers();return Response.json({success:!0,users:n});case"get_room_users":let c=v.getRoomUsers(r.roomId);return Response.json({success:!0,users:c});default:return Response.json({success:!1,error:"Invalid action"},{status:400})}}catch(e){return console.error("Error handling WebSocket API request:",e),Response.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function b(e){try{if(!g||!v)return Response.json({success:!1,error:"WebSocket server not running"},{status:400});return v.destroy(),v=null,g.close(()=>{console.log("WebSocket server stopped")}),g=null,Response.json({success:!0,message:"WebSocket server stopped successfully"})}catch(e){return console.error("Error stopping WebSocket server:",e),Response.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/websocket/route",pathname:"/api/websocket",filename:"route",bundlePath:"app/api/websocket/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\api\\websocket\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:h,staticGenerationAsyncStorage:R,serverHooks:S}=f,j="/api/websocket/route";function w(){return(0,c.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:R})}},349303:(e,s,r)=>{e.exports=r(430517)}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[8948],()=>r(185635));module.exports=t})();