exports.id=3595,exports.ids=[3595,3936,4665],exports.modules={14464:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=14464,e.exports=t},8541:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=8541,e.exports=t},4665:e=>{function t(e){return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=4665,e.exports=t},12308:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=12308,e.exports=t},60354:(e,t,o)=>{"use strict";o.d(t,{fU:()=>c.e,sR:()=>c.getSupabaseForRequest,kg:()=>s.kg,OQ:()=>a.OQ,pR:()=>c.p}),o(62197);var s=o(8803),r=o(26608);function i(e,t){console.error("Sentry n\xe3o inicializado:",e)}function l(e,t="info"){console.log(`[${t}] ${e}`)}o(77686),process.env.SENTRY_DSN;class n{constructor(){this.queues=new Map,this.queueEvents=new Map,this.alertThresholds={waitingJobs:100,failedJobs:10,activeJobsStuck:5},this.startPolling()}registerQueue(e,t){this.queues.set(e,t);let o=new r.Ji(e,{connection:t.opts.connection});this.queueEvents.set(e,o),this.setupQueueEventListeners(e,o),console.log(`âœ… BullMQ metrics registrado para fila: ${e}`)}setupQueueEventListeners(e,t){t.on("completed",({jobId:t,returnvalue:o})=>{console.log(`âœ… [${e}] Job ${t} completado`),l(`Job completado: ${t}`,"info")}),t.on("failed",({jobId:t,failedReason:o})=>{console.error(`âŒ [${e}] Job ${t} falhou:`,o),i(Error(o||"Job failed"),{queueName:e,jobId:t}),this.checkFailedJobsThreshold(e)}),t.on("stalled",({jobId:t})=>{console.warn(`âš ï¸ [${e}] Job ${t} travado`),l(`Job travado: ${t}`,"warning")}),t.on("progress",({jobId:t,data:o})=>{console.log(`ðŸ“Š [${e}] Job ${t} progresso: ${JSON.stringify(o)}`)})}async collectMetrics(){let e=[];for(let[t,o]of this.queues)try{let s=await o.getJobCounts(),r=await o.isPaused(),i={queueName:t,waiting:s.waiting||0,active:s.active||0,completed:s.completed||0,failed:s.failed||0,delayed:s.delayed||0,paused:r,timestamp:new Date};e.push(i),this.checkThresholds(i)}catch(e){console.error(`Erro ao coletar m\xe9tricas da fila ${t}:`,e),i(e,{queueName:t})}return e}checkThresholds(e){e.waiting>this.alertThresholds.waitingJobs&&(l(`ALERTA: Fila ${e.queueName} com ${e.waiting} jobs esperando`,"warning"),console.warn(`âš ï¸ Threshold de waiting jobs excedido: ${e.queueName}`)),e.failed>this.alertThresholds.failedJobs&&(l(`ALERTA: Fila ${e.queueName} com ${e.failed} jobs falhados`,"error"),console.error(`âŒ Threshold de failed jobs excedido: ${e.queueName}`)),e.paused&&(l(`ALERTA: Fila ${e.queueName} est\xe1 pausada`,"warning"),console.warn(`â¸ï¸ Fila pausada: ${e.queueName}`))}async checkFailedJobsThreshold(e){let t=this.queues.get(e);if(!t)return;let o=await t.getJobCounts();o.failed&&o.failed>this.alertThresholds.failedJobs&&l(`CR\xcdTICO: ${o.failed} jobs falhados na fila ${e}`,"error")}startPolling(e=3e4){this.metricsInterval&&clearInterval(this.metricsInterval),this.metricsInterval=setInterval(async()=>{console.log("\uD83D\uDCCA BullMQ Metrics:",JSON.stringify(await this.collectMetrics(),null,2))},e)}stopMetricsCollection(){for(let[e,t]of(this.metricsInterval&&(clearInterval(this.metricsInterval),this.metricsInterval=void 0),this.queueEvents))t.close(),console.log(`ðŸ”Œ QueueEvents fechado: ${e}`)}async getQueueMetrics(e){let t=this.queues.get(e);if(!t)return null;let o=await t.getJobCounts(),s=await t.isPaused();return{queueName:e,waiting:o.waiting||0,active:o.active||0,completed:o.completed||0,failed:o.failed||0,delayed:o.delayed||0,paused:s,timestamp:new Date}}async getActiveJobs(e){let t=this.queues.get(e);if(!t)return[];let o=await t.getJobs(["active"]),s=Date.now();return o.map(t=>({jobId:t.id||"unknown",queueName:e,status:"active",attempts:t.attemptsMade,progress:t.progress||0,timestamp:new Date(t.timestamp),duration:t.processedOn?s-t.processedOn:void 0}))}async cleanupOldJobs(e,t=6048e5){let o=this.queues.get(e);if(o)try{await o.clean(t,100,"completed"),await o.clean(t,100,"failed"),console.log(`ðŸ§¹ Cleanup executado na fila ${e}`)}catch(t){console.error(`Erro ao fazer cleanup da fila ${e}:`,t),i(t,{queueName:e})}}}new n;var a=o(77711),c=o(13936)},8803:(e,t,o)=>{"use strict";o.d(t,{kg:()=>a});var s=o(92048),r=o.n(s),i=o(55315),l=o.n(i);class n{constructor(){this.maxFileSize=10485760,this.maxFiles=5,this.logDir=l().join(process.cwd(),"logs"),r().existsSync(this.logDir)||r().mkdirSync(this.logDir,{recursive:!0}),this.currentLogFile=l().join(this.logDir,`app-${this.getDateString()}.log`)}static getInstance(){return n.instance||(n.instance=new n),n.instance}getDateString(){let e=new Date;return`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}`}getTimestamp(){return new Date().toISOString()}formatConsole(e){let t={DEBUG:"\x1b[36m",INFO:"\x1b[37m",WARN:"\x1b[33m",ERROR:"\x1b[31m",FATAL:"\x1b[35m",RESET:"\x1b[0m"},o=t[e.level],s={DEBUG:"\uD83D\uDD0D",INFO:"â„¹ï¸",WARN:"âš ï¸",ERROR:"âŒ",FATAL:"\uD83D\uDC80"}[e.level],r=`${o}[${e.timestamp}] ${s} ${e.level} [${e.component}] ${e.message}${t.RESET}`;return e.data&&(r+=`
${o}   Data: ${JSON.stringify(e.data,null,2)}${t.RESET}`),e.stack&&(r+=`
${o}   Stack: ${e.stack}${t.RESET}`),r}writeToFile(e){try{this.rotateIfNeeded();let t=JSON.stringify(e)+"\n";r().appendFileSync(this.currentLogFile,t,"utf-8")}catch(e){console.error("Erro ao escrever log:",e)}}rotateIfNeeded(){try{if(r().existsSync(this.currentLogFile)&&r().statSync(this.currentLogFile).size>=this.maxFileSize){let e=Date.now(),t=this.currentLogFile.replace(".log",`-${e}.log`);r().renameSync(this.currentLogFile,t),this.cleanOldLogs()}}catch(e){console.error("Erro ao rotacionar logs:",e)}}cleanOldLogs(){try{let e=r().readdirSync(this.logDir).filter(e=>e.endsWith(".log")).map(e=>({name:e,path:l().join(this.logDir,e),time:r().statSync(l().join(this.logDir,e)).mtime.getTime()})).sort((e,t)=>t.time-e.time);e.length>this.maxFiles&&e.slice(this.maxFiles).forEach(e=>{r().unlinkSync(e.path)})}catch(e){console.error("Erro ao limpar logs antigos:",e)}}log(e,t,o,s,r){let i={timestamp:this.getTimestamp(),level:e,component:t,message:o,data:s};r&&(i.stack=r.stack),this.writeToFile(i)}debug(e,t,o){this.log("DEBUG",e,t,o)}info(e,t,o){this.log("INFO",e,t,o)}warn(e,t,o){this.log("WARN",e,t,o)}error(e,t,o,s){this.log("ERROR",e,t,s,o)}fatal(e,t,o,s){this.log("FATAL",e,t,s,o)}analyzeLogs(e){let t=e||this.currentLogFile;if(!r().existsSync(t))throw Error(`Arquivo de log n\xe3o encontrado: ${t}`);let o=r().readFileSync(t,"utf-8").split("\n").filter(e=>e.trim()).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>null!==e),s={totalLogs:o.length,byLevel:{DEBUG:o.filter(e=>"DEBUG"===e.level).length,INFO:o.filter(e=>"INFO"===e.level).length,WARN:o.filter(e=>"WARN"===e.level).length,ERROR:o.filter(e=>"ERROR"===e.level).length,FATAL:o.filter(e=>"FATAL"===e.level).length},byComponent:{},errors:o.filter(e=>"ERROR"===e.level||"FATAL"===e.level),warnings:o.filter(e=>"WARN"===e.level),timeRange:{start:o[0]?.timestamp||"",end:o[o.length-1]?.timestamp||""}};return o.forEach(e=>{s.byComponent[e.component]||(s.byComponent[e.component]=0),s.byComponent[e.component]++}),s}searchLogs(e,t,o,s){let i=s||this.currentLogFile;return r().existsSync(i)?r().readFileSync(i,"utf-8").split("\n").filter(e=>e.trim()).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>null!==e).filter(s=>(!t||s.level===t)&&(!o||s.component===o)&&(!e||JSON.stringify(s).toLowerCase().includes(e.toLowerCase()))):[]}printAnalysis(e){console.log("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"),console.log("â•‘                    \uD83D\uDCCA AN\xc1LISE DE LOGS                            â•‘"),console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n"),console.log(`ðŸ“‹ Total de Logs: ${e.totalLogs}`),console.log(`â° Per\xedodo: ${e.timeRange.start} â†’ ${e.timeRange.end}
`),console.log("\uD83D\uDCCA Por N\xedvel:"),console.log(`   ðŸ” DEBUG: ${e.byLevel.DEBUG}`),console.log(`   â„¹ï¸  INFO:  ${e.byLevel.INFO}`),console.log(`   âš ï¸  WARN:  ${e.byLevel.WARN}`),console.log(`   âŒ ERROR: ${e.byLevel.ERROR}`),console.log(`   ðŸ’€ FATAL: ${e.byLevel.FATAL}
`),console.log("\uD83D\uDCE6 Por Componente:"),Object.entries(e.byComponent).sort(([,e],[,t])=>t-e).forEach(([e,t])=>{console.log(`   - ${e}: ${t}`)}),e.errors.length>0&&(console.log(`
âŒ Erros Recentes (${e.errors.length}):`),e.errors.slice(-5).forEach(e=>{console.log(`   [${e.timestamp}] ${e.component}: ${e.message}`)})),e.warnings.length>0&&(console.log(`
âš ï¸  Avisos Recentes (${e.warnings.length}):`),e.warnings.slice(-5).forEach(e=>{console.log(`   [${e.timestamp}] ${e.component}: ${e.message}`)})),console.log("\n")}getLogFiles(){return r().readdirSync(this.logDir).filter(e=>e.endsWith(".log")).map(e=>l().join(this.logDir,e))}clearLogs(){let e=this.getLogFiles();e.forEach(e=>r().unlinkSync(e)),console.log(`âœ… ${e.length} arquivos de log removidos`)}}let a=n.getInstance()},3003:(e,t,o)=>{"use strict";o.d(t,{W:()=>l});var s=o(67721),r=o(97824);let i=null;function l(){if(i)return i;let{url:e,anonKey:t}=(0,r.o)();return i=(0,s.createBrowserClient)(e,t)}},77711:(e,t,o)=>{"use strict";o.d(t,{OQ:()=>s});let s=(0,o(3003).W)()},97824:(e,t,o)=>{"use strict";o.d(t,{o:()=>r});let s=null;function r(){if(s)return s;let e="https://ofhzrdiadxigrvmrhaiz.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ";if(!e||!t)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables");return s={url:e,anonKey:t}}},13936:(e,t,o)=>{"use strict";o.d(t,{e:()=>l,getSupabaseForRequest:()=>a,p:()=>n});var s=o(67721),r=o(61657),i=o(71615);let l=()=>{let e=(0,i.cookies)();return(0,s.createServerClient)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{cookies:{get:t=>e.get(t)?.value,set(t,o,s){try{e.set({name:t,value:o,...s})}catch(e){}},remove(t,o){try{e.set({name:t,value:"",...o})}catch(e){}}}})},n=(0,r.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});function a(e){let t=e.headers.get("authorization")||e.headers.get("Authorization");return t?(0,r.eI)("https://ofhzrdiadxigrvmrhaiz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9maHpyZGlhZHhpZ3J2bXJoYWl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3MTE3NjEsImV4cCI6MjA3NTI4Nzc2MX0.u-F5m9lvYc1lx9aA-MoTZqCAa83QHGVk8uTh-_KPfCQ",{global:{headers:{Authorization:t}},auth:{persistSession:!1,autoRefreshToken:!1}}):l()}}};