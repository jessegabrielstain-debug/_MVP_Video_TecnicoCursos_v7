"use strict";exports.id=8536,exports.ids=[8536],exports.modules={8803:(e,o,t)=>{t.d(o,{kg:()=>l});var r=t(92048),a=t.n(r),n=t(55315),i=t.n(n);class s{constructor(){this.maxFileSize=10485760,this.maxFiles=5,this.logDir=i().join(process.cwd(),"logs"),a().existsSync(this.logDir)||a().mkdirSync(this.logDir,{recursive:!0}),this.currentLogFile=i().join(this.logDir,`app-${this.getDateString()}.log`)}static getInstance(){return s.instance||(s.instance=new s),s.instance}getDateString(){let e=new Date;return`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}`}getTimestamp(){return new Date().toISOString()}formatConsole(e){let o={DEBUG:"\x1b[36m",INFO:"\x1b[37m",WARN:"\x1b[33m",ERROR:"\x1b[31m",FATAL:"\x1b[35m",RESET:"\x1b[0m"},t=o[e.level],r={DEBUG:"\uD83D\uDD0D",INFO:"â„¹ï¸",WARN:"âš ï¸",ERROR:"âŒ",FATAL:"\uD83D\uDC80"}[e.level],a=`${t}[${e.timestamp}] ${r} ${e.level} [${e.component}] ${e.message}${o.RESET}`;return e.data&&(a+=`
${t}   Data: ${JSON.stringify(e.data,null,2)}${o.RESET}`),e.stack&&(a+=`
${t}   Stack: ${e.stack}${o.RESET}`),a}writeToFile(e){try{this.rotateIfNeeded();let o=JSON.stringify(e)+"\n";a().appendFileSync(this.currentLogFile,o,"utf-8")}catch(e){console.error("Erro ao escrever log:",e)}}rotateIfNeeded(){try{if(a().existsSync(this.currentLogFile)&&a().statSync(this.currentLogFile).size>=this.maxFileSize){let e=Date.now(),o=this.currentLogFile.replace(".log",`-${e}.log`);a().renameSync(this.currentLogFile,o),this.cleanOldLogs()}}catch(e){console.error("Erro ao rotacionar logs:",e)}}cleanOldLogs(){try{let e=a().readdirSync(this.logDir).filter(e=>e.endsWith(".log")).map(e=>({name:e,path:i().join(this.logDir,e),time:a().statSync(i().join(this.logDir,e)).mtime.getTime()})).sort((e,o)=>o.time-e.time);e.length>this.maxFiles&&e.slice(this.maxFiles).forEach(e=>{a().unlinkSync(e.path)})}catch(e){console.error("Erro ao limpar logs antigos:",e)}}log(e,o,t,r,a){let n={timestamp:this.getTimestamp(),level:e,component:o,message:t,data:r};a&&(n.stack=a.stack),this.writeToFile(n)}debug(e,o,t){this.log("DEBUG",e,o,t)}info(e,o,t){this.log("INFO",e,o,t)}warn(e,o,t){this.log("WARN",e,o,t)}error(e,o,t,r){this.log("ERROR",e,o,r,t)}fatal(e,o,t,r){this.log("FATAL",e,o,r,t)}analyzeLogs(e){let o=e||this.currentLogFile;if(!a().existsSync(o))throw Error(`Arquivo de log n\xe3o encontrado: ${o}`);let t=a().readFileSync(o,"utf-8").split("\n").filter(e=>e.trim()).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>null!==e),r={totalLogs:t.length,byLevel:{DEBUG:t.filter(e=>"DEBUG"===e.level).length,INFO:t.filter(e=>"INFO"===e.level).length,WARN:t.filter(e=>"WARN"===e.level).length,ERROR:t.filter(e=>"ERROR"===e.level).length,FATAL:t.filter(e=>"FATAL"===e.level).length},byComponent:{},errors:t.filter(e=>"ERROR"===e.level||"FATAL"===e.level),warnings:t.filter(e=>"WARN"===e.level),timeRange:{start:t[0]?.timestamp||"",end:t[t.length-1]?.timestamp||""}};return t.forEach(e=>{r.byComponent[e.component]||(r.byComponent[e.component]=0),r.byComponent[e.component]++}),r}searchLogs(e,o,t,r){let n=r||this.currentLogFile;return a().existsSync(n)?a().readFileSync(n,"utf-8").split("\n").filter(e=>e.trim()).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>null!==e).filter(r=>(!o||r.level===o)&&(!t||r.component===t)&&(!e||JSON.stringify(r).toLowerCase().includes(e.toLowerCase()))):[]}printAnalysis(e){console.log("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"),console.log("â•‘                    \uD83D\uDCCA AN\xc1LISE DE LOGS                            â•‘"),console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n"),console.log(`ðŸ“‹ Total de Logs: ${e.totalLogs}`),console.log(`â° Per\xedodo: ${e.timeRange.start} â†’ ${e.timeRange.end}
`),console.log("\uD83D\uDCCA Por N\xedvel:"),console.log(`   ðŸ” DEBUG: ${e.byLevel.DEBUG}`),console.log(`   â„¹ï¸  INFO:  ${e.byLevel.INFO}`),console.log(`   âš ï¸  WARN:  ${e.byLevel.WARN}`),console.log(`   âŒ ERROR: ${e.byLevel.ERROR}`),console.log(`   ðŸ’€ FATAL: ${e.byLevel.FATAL}
`),console.log("\uD83D\uDCE6 Por Componente:"),Object.entries(e.byComponent).sort(([,e],[,o])=>o-e).forEach(([e,o])=>{console.log(`   - ${e}: ${o}`)}),e.errors.length>0&&(console.log(`
âŒ Erros Recentes (${e.errors.length}):`),e.errors.slice(-5).forEach(e=>{console.log(`   [${e.timestamp}] ${e.component}: ${e.message}`)})),e.warnings.length>0&&(console.log(`
âš ï¸  Avisos Recentes (${e.warnings.length}):`),e.warnings.slice(-5).forEach(e=>{console.log(`   [${e.timestamp}] ${e.component}: ${e.message}`)})),console.log("\n")}getLogFiles(){return a().readdirSync(this.logDir).filter(e=>e.endsWith(".log")).map(e=>i().join(this.logDir,e))}clearLogs(){let e=this.getLogFiles();e.forEach(e=>a().unlinkSync(e)),console.log(`âœ… ${e.length} arquivos de log removidos`)}}let l=s.getInstance()},78536:(e,o,t)=>{t.d(o,{tG:()=>p,$e:()=>f,Hh:()=>u,$4:()=>d,vc:()=>R,Ie:()=>g});var r=t(61657),a=t(8803);let n=[{nr_number:"NR-01",title:"Disposi\xe7\xf5es Gerais e Gerenciamento de Riscos Ocupacionais",description:"Estabelece disposi\xe7\xf5es gerais, campo de aplica\xe7\xe3o, termos e defini\xe7\xf5es comuns \xe0s Normas Regulamentadoras.",slide_count:8,duration_seconds:480,template_config:{primary_color:"#2563EB",secondary_color:"#3B82F6",font_family:"Inter",topics:["Disposi\xe7\xf5es Gerais","Campo de Aplica\xe7\xe3o","Termos e Defini\xe7\xf5es","Direitos e Deveres","GRO","Equipamentos","Capacita\xe7\xe3o","Documenta\xe7\xe3o"]}},{nr_number:"NR-05",title:"Comiss\xe3o Interna de Preven\xe7\xe3o de Acidentes (CIPA)",description:"Define as diretrizes para a constitui\xe7\xe3o e funcionamento da CIPA.",slide_count:7,duration_seconds:420,template_config:{primary_color:"#06B6D4",secondary_color:"#0891B2",font_family:"Inter",topics:["Constitui\xe7\xe3o","Atribui\xe7\xf5es","Processo Eleitoral","Treinamento","Reuni\xf5es","SIPAT","Documenta\xe7\xe3o"]}},{nr_number:"NR-06",title:"Equipamentos de Prote\xe7\xe3o Individual (EPI)",description:"Estabelece as regras sobre fornecimento, uso e manuten\xe7\xe3o de EPIs.",slide_count:10,duration_seconds:600,template_config:{primary_color:"#10B981",secondary_color:"#059669",font_family:"Inter",topics:["Obriga\xe7\xf5es do Empregador","Obriga\xe7\xf5es do Empregado","CA","Fornecimento","Treinamento","Higieniza\xe7\xe3o","Tipos de EPI","Fiscaliza\xe7\xe3o","Penalidades","Documenta\xe7\xe3o"]}},{nr_number:"NR-07",title:"Programa de Controle M\xe9dico de Sa\xfade Ocupacional (PCMSO)",description:"Define as diretrizes para elabora\xe7\xe3o e implementa\xe7\xe3o do PCMSO.",slide_count:9,duration_seconds:540,template_config:{primary_color:"#8B5CF6",secondary_color:"#7C3AED",font_family:"Inter",topics:["Objetivos","Responsabilidades","Exames","ASO","Riscos","Afastamentos","Prontu\xe1rios","Relat\xf3rios","Integra\xe7\xe3o"]}},{nr_number:"NR-09",title:"Avalia\xe7\xe3o e Controle das Expos\xe7\xf5es Ocupacionais",description:"Define os requisitos para avalia\xe7\xe3o e controle de agentes nocivos.",slide_count:11,duration_seconds:660,template_config:{primary_color:"#F97316",secondary_color:"#EA580C",font_family:"Inter",topics:["Reconhecimento","Avalia\xe7\xe3o","Agentes F\xedsicos","Agentes Qu\xedmicos","Agentes Biol\xf3gicos","Limites de Exposi\xe7\xe3o","Medidas de Controle","Monitoramento","Registros","Integra\xe7\xe3o GRO","Documenta\xe7\xe3o"]}},{nr_number:"NR-10",title:"Seguran\xe7a em Instala\xe7\xf5es e Servi\xe7os em Eletricidade",description:"Estabelece as condi\xe7\xf5es m\xednimas para seguran\xe7a em eletricidade.",slide_count:13,duration_seconds:780,template_config:{primary_color:"#EAB308",secondary_color:"#CA8A04",font_family:"Inter",topics:["Medidas de Controle","Prontu\xe1rio","Projetos","Procedimentos","Equipamentos","Treinamento B\xe1sico","Treinamento SEP","Habilita\xe7\xe3o","Desenergiza\xe7\xe3o","Aterramento","Sinaliza\xe7\xf5es","Trabalho em Altura","EPI"]}},{nr_number:"NR-12",title:"Seguran\xe7a no Trabalho em M\xe1quinas e Equipamentos",description:"Define as medidas de prote\xe7\xe3o para m\xe1quinas e equipamentos.",slide_count:12,duration_seconds:720,template_config:{primary_color:"#DC2626",secondary_color:"#B91C1C",font_family:"Inter",topics:["Arranjo F\xedsico","Prote\xe7\xf5es","Dispositivos de Seguran\xe7a","Opera\xe7\xe3o","Manuten\xe7\xe3o","Inspe\xe7\xe3o","Capacita\xe7\xe3o","Manual","Sinaliza\xe7\xe3o","Anexo I","Anexo XII","Documenta\xe7\xe3o"]}},{nr_number:"NR-17",title:"Ergonomia",description:"Estabelece par\xe2metros para adapta\xe7\xe3o das condi\xe7\xf5es de trabalho.",slide_count:8,duration_seconds:480,template_config:{primary_color:"#14B8A6",secondary_color:"#0D9488",font_family:"Inter",topics:["An\xe1lise Ergon\xf4mica","Mobili\xe1rio","Ilumina\xe7\xe3o","Organiza\xe7\xe3o","Transporte de Cargas","Condi\xe7\xf5es Ambientais","Trabalho com Computadores","Documenta\xe7\xe3o"]}},{nr_number:"NR-18",title:"Condi\xe7\xf5es de Seguran\xe7a e Sa\xfade no Trabalho na Ind\xfastria da Constru\xe7\xe3o",description:"Define as diretrizes de seguran\xe7a para constru\xe7\xe3o civil.",slide_count:14,duration_seconds:840,template_config:{primary_color:"#F59E0B",secondary_color:"#D97706",font_family:"Inter",topics:["PCMAT","SESMT","CIPA","\xc1reas de Viv\xeancia","Escava\xe7\xf5es","Andaimes","Plataformas","Guindastes","Transporte Vertical","Prote\xe7\xe3o Contra Quedas","M\xe1quinas","Equipamentos","Treinamento","Documenta\xe7\xe3o"]}},{nr_number:"NR-35",title:"Trabalho em Altura",description:"Estabelece os requisitos m\xednimos para trabalho em altura.",slide_count:10,duration_seconds:600,template_config:{primary_color:"#EF4444",secondary_color:"#DC2626",font_family:"Inter",topics:["Requisitos M\xednimos","Responsabilidades","Capacita\xe7\xe3o","Planejamento","An\xe1lise de Risco","Sistemas de Prote\xe7\xe3o","EPI","Emerg\xeancia","PT","Documenta\xe7\xe3o"]}}];function i(e){let o=e.toUpperCase();return n.find(e=>e.nr_number.toUpperCase()===o)}let s="https://ofhzrdiadxigrvmrhaiz.supabase.co",l=process.env.SUPABASE_SERVICE_ROLE_KEY;s&&l||a.kg.warn("NRTemplatesService","Credenciais do Supabase ausentes. Usando cat\xe1logo offline (mock) para NRs.");let c=s&&l?(0,r.eI)(s,l):null;function m(e){return{id:`mock-${e.nr_number}`,nr_number:e.nr_number,title:e.title,description:e.description,slide_count:e.slide_count,duration_seconds:e.duration_seconds,template_config:{themeColor:e.template_config.primary_color,fontFamily:e.template_config.font_family,transitionType:"fade",avatarEnabled:!1,avatarPosition:"bottom-right",audioEnabled:!1,subtitlesEnabled:!0,warningLevel:"medium",exampleImages:[]},created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}async function d(){if(!c){let e=n.map(m);return a.kg.info("NRTemplatesService","Retornando templates NR via mock (Supabase ausente).",{count:e.length}),e}try{let{data:e,error:o}=await c.from("nr_templates").select("*").order("nr_number",{ascending:!0});if(o){if("PGRST205"===o.code){let e=n.map(m);return a.kg.warn("NRTemplatesService","Tabela nr_templates ausente. Usando cat\xe1logo mock.",{code:o.code}),e}throw a.kg.error("NRTemplatesService","Falha ao listar templates de NRs.",o,{error:o}),o}return a.kg.info("NRTemplatesService","Templates de NRs listados com sucesso.",{count:e.length}),e}catch(o){a.kg.error("NRTemplatesService","Erro ao listar templates de NRs.",o);let e=n.map(m);return a.kg.warn("NRTemplatesService","Erro ao consultar Supabase. Usando cat\xe1logo mock.",{err:String(o)}),e}}async function u(e){if(!c){let o=i(e);return o?m(o):null}try{let{data:o,error:t}=await c.from("nr_templates").select("*").eq("nr_number",e).single();if(t){if("PGRST116"===t.code){a.kg.warn("NRTemplatesService","Template de NR n\xe3o encontrado.",{nrNumber:e});let o=i(e);return o?m(o):null}if("PGRST205"===t.code){let o=i(e);return o?m(o):null}throw a.kg.error("NRTemplatesService","Falha ao buscar template de NR.",t,{nrNumber:e}),t}return a.kg.info("NRTemplatesService","Template de NR encontrado.",{nrNumber:e}),o}catch(t){a.kg.error("NRTemplatesService","Erro ao buscar template de NR.",t,{nrNumber:e});let o=i(e);return o?m(o):null}}async function p(e){if(!c)throw Error("Supabase n\xe3o est\xe1 configurado.");try{let{data:o,error:t}=await c.from("nr_templates").insert(e).select().single();if(t)throw a.kg.error("NRTemplatesService","Falha ao criar template de NR.",t,{template:e}),t;return a.kg.info("NRTemplatesService","Template de NR criado com sucesso.",{nrNumber:o.nr_number}),o}catch(e){throw a.kg.error("NRTemplatesService","Erro ao criar template de NR.",e),e}}async function g(e,o){if(!c)throw Error("Supabase n\xe3o est\xe1 configurado.");try{let{data:t,error:r}=await c.from("nr_templates").update(o).eq("id",e).select().single();if(r)throw a.kg.error("NRTemplatesService","Falha ao atualizar template de NR.",r,{id:e,updates:o}),r;return a.kg.info("NRTemplatesService","Template de NR atualizado com sucesso.",{id:e,nrNumber:t.nr_number}),t}catch(o){throw a.kg.error("NRTemplatesService","Erro ao atualizar template de NR.",o,{id:e}),o}}async function f(e){if(!c)throw Error("Supabase n\xe3o est\xe1 configurado.");try{let{error:o}=await c.from("nr_templates").delete().eq("id",e);if(o)throw a.kg.error("NRTemplatesService","Falha ao deletar template de NR.",o,{id:e}),o;a.kg.info("NRTemplatesService","Template de NR deletado com sucesso.",{id:e})}catch(o){throw a.kg.error("NRTemplatesService","Erro ao deletar template de NR.",o,{id:e}),o}}async function R(e){if(!c)throw Error("Supabase n\xe3o est\xe1 configurado.");try{let{data:o,error:t}=await c.from("nr_templates").select("*").or(`title.ilike.%${e}%,description.ilike.%${e}%`).order("nr_number",{ascending:!0});if(t)throw a.kg.error("NRTemplatesService","Falha ao buscar templates de NRs.",t,{query:e}),t;return a.kg.info("NRTemplatesService","Busca de templates conclu\xedda.",{query:e,count:o.length}),o}catch(o){throw a.kg.error("NRTemplatesService","Erro ao buscar templates de NRs.",o,{query:e}),o}}}};