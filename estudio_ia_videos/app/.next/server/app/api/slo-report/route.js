"use strict";(()=>{var e={};e.id=6356,e.ids=[6356],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},22401:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>R,routeModule:()=>f,serverHooks:()=>S,staticGenerationAsyncStorage:()=>w});var a={};r.r(a),r.d(a,{GET:()=>v,dynamic:()=>h});var s=r(49303),i=r(88716),n=r(60670),o=r(87070),l=r(50042),c=r(36087);let u={availability:{target:.99,window:"30d",description:"Sistema deve estar dispon\xedvel 99% do tempo em janela de 30 dias"},apiLatency:{p95:{target:300,critical:500,description:"P95 de lat\xeancia das APIs deve ser menor que 300ms"},p99:{target:500,critical:1e3,description:"P99 de lat\xeancia das APIs deve ser menor que 500ms"}},errorRate:{target:.01,critical:.05,description:"Taxa de erro deve ser menor que 1%"},videoRenderSuccessRate:{target:.95,critical:.9,description:"Taxa de sucesso de renderiza\xe7\xe3o deve ser maior que 95%"}};class p{record(e,t){this.measurements.has(e)||this.measurements.set(e,[]);let r=this.measurements.get(e);r.push(t),r.length>1e3&&r.shift(),l.q.observeSummary(`slo_${e}`,t)}calculatePercentile(e,t){if(0===e.length)return 0;let r=[...e].sort((e,t)=>e-t),a=Math.ceil(t/100*r.length)-1;return r[a]}calculateRate(e,t){return 0===e.length?0:e.filter(e=>e===t).length/e.length}checkAll(){let e=[],t=this.measurements.get("availability")||[];if(t.length>0){let r=this.calculateRate(t,1);e.push(this.evaluateSLO("availability",r,u.availability.target,u.availability.target-.01,u.availability.description))}let r=this.measurements.get("api_latency")||[];if(r.length>0){let t=this.calculatePercentile(r,95);e.push(this.evaluateSLO("api_latency_p95",t,u.apiLatency.p95.target,u.apiLatency.p95.critical,u.apiLatency.p95.description))}let a=this.measurements.get("error_rate")||[];if(a.length>0){let t=this.calculateRate(a,1);e.push(this.evaluateSLO("error_rate",t,u.errorRate.target,u.errorRate.critical,u.errorRate.description,!0))}let s=this.measurements.get("video_render_success")||[];if(s.length>0){let t=this.calculateRate(s,1);e.push(this.evaluateSLO("video_render_success_rate",t,u.videoRenderSuccessRate.target,u.videoRenderSuccessRate.critical,u.videoRenderSuccessRate.description))}return this.lastCheck=new Date,e}evaluateSLO(e,t,r,a,s,i=!1){let n,o;if(n=i?t<=r?"passing":t<=a?"warning":"failing":t>=r?"passing":t>=a?"warning":"failing","availability"===e){let e=(1-r)*100;o=Math.max(0,(e-(1-t)*100)/e*100)}return l.q.setGauge("slo_status","passing"===n?1:0,{slo:e}),"failing"===n?c.k.error(`SLO violation: ${e}`,{current:t,target:r,critical:a}):"warning"===n&&c.k.warn(`SLO warning: ${e}`,{current:t,target:r,critical:a}),{name:e,status:n,current:t,target:r,critical:a,description:s,errorBudgetRemaining:o}}generateReport(){let e=this.checkAll(),t=["# SLO Report",`Generated at: ${new Date().toISOString()}`,"","## Summary",`Total SLOs: ${e.length}`,`Passing: ${e.filter(e=>"passing"===e.status).length}`,`Warning: ${e.filter(e=>"warning"===e.status).length}`,`Failing: ${e.filter(e=>"failing"===e.status).length}`,"","## Details"];for(let r of e){let e="passing"===r.status?"✅":"warning"===r.status?"⚠️":"❌";t.push(""),t.push(`### ${e} ${r.name}`),t.push(`**Status:** ${r.status}`),t.push(`**Current:** ${r.current.toFixed(2)}`),t.push(`**Target:** ${r.target.toFixed(2)}`),void 0!==r.critical&&t.push(`**Critical:** ${r.critical.toFixed(2)}`),void 0!==r.errorBudgetRemaining&&t.push(`**Error Budget Remaining:** ${r.errorBudgetRemaining.toFixed(1)}%`),t.push(`**Description:** ${r.description}`)}return t.join("\n")}constructor(){this.measurements=new Map,this.lastCheck=new Date}}let d=new p;var g=r(29237);let h="force-dynamic",m=(0,g.H2)({interval:6e4,limit:20});async function v(e){let{success:t,headers:r}=await m(e);if(!t)return new o.NextResponse("Too Many Requests",{status:429,headers:Object.fromEntries(r)});try{let t=e.nextUrl.searchParams.get("format")||"json";if("markdown"===t){let e=d.generateReport();return new o.NextResponse(e,{status:200,headers:{"Content-Type":"text/markdown","Cache-Control":"no-cache, no-store, must-revalidate",...Object.fromEntries(r)}})}{let e=d.checkAll(),t={timestamp:new Date().toISOString(),total:e.length,passing:e.filter(e=>"passing"===e.status).length,warning:e.filter(e=>"warning"===e.status).length,failing:e.filter(e=>"failing"===e.status).length,results:e};return o.NextResponse.json(t,{status:200,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",...Object.fromEntries(r)}})}}catch(e){return console.error("Erro ao gerar relat\xf3rio SLO:",e),o.NextResponse.json({error:"Internal Server Error",message:e instanceof Error?e.message:"Unknown error"},{status:500,headers:Object.fromEntries(r)})}}let f=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/slo-report/route",pathname:"/api/slo-report",filename:"route",bundlePath:"app/api/slo-report/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\slo-report\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:R,staticGenerationAsyncStorage:w,serverHooks:S}=f,x="/api/slo-report/route";function y(){return(0,n.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:w})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972,4024],()=>r(22401));module.exports=a})();