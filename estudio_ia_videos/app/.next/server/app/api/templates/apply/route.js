(()=>{var e={};e.id=9588,e.ids=[9588],e.modules={92885:e=>{"use strict";e.exports=require("@supabase/supabase-js")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},16305:()=>{},24568:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>E,requestAsyncStorage:()=>h,routeModule:()=>y,serverHooks:()=>T,staticGenerationAsyncStorage:()=>b});var s={};r.r(s),r.d(s,{GET:()=>g,POST:()=>f,dynamic:()=>m});var a=r(49303),o=r(88716),n=r(60670),i=r(87070),l=r(26231),p=r(91232);class c{constructor(){this.templates=new Map,this.loadDefaultTemplates()}applyTemplate(e,t){let r=this.templates.get(t);return r?(console.log(`[TemplateEngine] Aplicando template: ${r.name}`),e.map((e,t)=>{let s=0===t;return{...e,elements:e.elements.map(e=>"text"===e.type?this.applyTextStyle(e,r.config,s):e),style:{backgroundColor:r.config.colors.background,padding:r.config.layout.padding}}})):(console.warn(`[TemplateEngine] Template n\xe3o encontrado: ${t}`),e)}applyTextStyle(e,t,r){let s=e.style||{};return{...e,style:{...s,fontFamily:r?t.fonts.heading:t.fonts.body,fontSize:r?t.fonts.size.title:t.fonts.size.body,color:t.colors.text,textAlign:t.layout.alignment}}}listTemplates(e){let t=Array.from(this.templates.values());return e?t.filter(t=>t.category===e):t}loadDefaultTemplates(){this.templates.set("corporate-modern",{id:"corporate-modern",name:"Corporativo Moderno",category:"corporate",thumbnail:"/templates/corporate-modern.jpg",config:{colors:{primary:"#2563eb",secondary:"#1e40af",accent:"#3b82f6",background:"#ffffff",text:"#1f2937"},fonts:{heading:"Inter, sans-serif",body:"Inter, sans-serif",size:{title:64,subtitle:36,body:24}},layout:{padding:80,spacing:40,alignment:"left"},animations:{slideTransition:"fade",elementAnimation:"slide-in",duration:.5}}}),this.templates.set("education-friendly",{id:"education-friendly",name:"Educacional Amig\xe1vel",category:"education",thumbnail:"/templates/education-friendly.jpg",config:{colors:{primary:"#8b5cf6",secondary:"#7c3aed",accent:"#a78bfa",background:"#faf5ff",text:"#4c1d95"},fonts:{heading:"Poppins, sans-serif",body:"Open Sans, sans-serif",size:{title:72,subtitle:42,body:28}},layout:{padding:100,spacing:50,alignment:"center"},animations:{slideTransition:"slide",elementAnimation:"bounce",duration:.7}}}),this.templates.set("marketing-vibrant",{id:"marketing-vibrant",name:"Marketing Vibrante",category:"marketing",thumbnail:"/templates/marketing-vibrant.jpg",config:{colors:{primary:"#f97316",secondary:"#ea580c",accent:"#fb923c",background:"#fff7ed",text:"#7c2d12"},fonts:{heading:"Montserrat, sans-serif",body:"Roboto, sans-serif",size:{title:80,subtitle:48,body:32}},layout:{padding:60,spacing:30,alignment:"center"},animations:{slideTransition:"zoom",elementAnimation:"fade-up",duration:.6}}}),console.log(`[TemplateEngine] ${this.templates.size} templates carregados`)}}let u=new c;var d=r(85662);let m="force-dynamic";async function f(e){try{let t=await (0,l.default)(p.L);if(!t?.user?.id)return i.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{projectId:s,templateId:a}=await e.json();if(!s||!a)return i.NextResponse.json({error:"projectId e templateId s\xe3o obrigat\xf3rios"},{status:400});console.log(`[Template API] Aplicando template ${a} ao projeto ${s}`);let o=null;try{let{data:e}=await d.pR.from("projects").select("*").eq("id",s).single();o=e}catch{let{fallbackStorage:e}=await r.e(2152).then(r.bind(r,42152));o=e.getProject(s)}if(!o)return i.NextResponse.json({error:"Projeto n\xe3o encontrado"},{status:404});let n=o.timeline_data?.slides||[],c=u.applyTemplate(n,a),m={...o.timeline_data,slides:c,template:a};try{await d.pR.from("projects").update({timeline_data:m}).eq("id",s)}catch{let{fallbackStorage:e}=await r.e(2152).then(r.bind(r,42152));e.updateProject(s,{timeline_data:m})}return i.NextResponse.json({success:!0,slides:c,template:a})}catch(e){return console.error("[Template API] Erro:",e),i.NextResponse.json({error:"Erro ao aplicar template"},{status:500})}}async function g(e){try{let{searchParams:t}=e.nextUrl,r=t.get("category")||void 0,s=u.listTemplates(r);return i.NextResponse.json({success:!0,templates:s,total:s.length})}catch(e){return i.NextResponse.json({error:"Erro ao listar templates"},{status:500})}}let y=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/templates/apply/route",pathname:"/api/templates/apply",filename:"route",bundlePath:"app/api/templates/apply/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\templates\\apply\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:b,serverHooks:T}=y,v="/api/templates/apply/route";function E(){return(0,n.patchFetch)({serverHooks:T,staticGenerationAsyncStorage:b})}},91232:(e,t,r)=>{"use strict";r.d(t,{L:()=>f});var s=r(74194),a=r(92885),o=r(98691),n=r(80772),i=r(64198),l=r(8204);let p=process.env.NEXT_PUBLIC_SUPABASE_URL||"",c=process.env.SUPABASE_SERVICE_ROLE_KEY||"",u=!!(p&&c)&&p.includes("supabase.co"),d=u?(0,a.createClient)(p,c,{auth:{persistSession:!1,autoRefreshToken:!1}}):null,m=[(0,n.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email",placeholder:"seu@email.com"},password:{label:"Senha",type:"password"}},async authorize(e){let t=String(e?.email||"").trim().toLowerCase(),r=String(e?.password||"");if(!t||!r)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!u||!d)throw console.warn("⚠️ Supabase n\xe3o configurado. Configure as vari\xe1veis de ambiente ou use credenciais de teste."),Error("Servi\xe7o de autentica\xe7\xe3o indispon\xedvel");try{let{data:e,error:s}=await d.from("users").select("id, email, name, role, tier, password_hash, avatar_url, metadata").eq("email",t).single();if(s||!e||!await (0,o.qu)(r,e.password_hash))throw Error("Credenciais inv\xe1lidas");let a=e.metadata&&"object"==typeof e.metadata?e.metadata:{};return{id:e.id,email:e.email,name:e.name,role:e.role||"user",subscriptionTier:e.tier||"free",tier:e.tier||"free",preferences:a,image:e.avatar_url}}catch(e){throw console.error("Erro na autentica\xe7\xe3o:",e),Error("Credenciais inv\xe1lidas")}}})];process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&m.push((0,l.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})),process.env.SMTP_HOST&&process.env.SMTP_USER&&process.env.SMTP_PASS&&m.push((0,i.Z)({server:{host:process.env.SMTP_HOST,port:parseInt(process.env.SMTP_PORT||"587",10),auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}},from:process.env.SMTP_FROM||process.env.SMTP_USER}));let f={...u?{adapter:(0,s.S3)({url:p,secret:c})}:{},providers:m,callbacks:{async jwt({token:e,user:t}){if(t)e.id=t.id,e.email=t.email,e.role=t.role||"user",e.subscriptionTier=t.subscriptionTier||t.tier||"free",e.preferences=t.preferences||{};else if(e.sub&&u&&d&&(!e.role||!e.subscriptionTier))try{let{data:t}=await d.from("users").select("role, tier, metadata").eq("id",e.sub).single();t&&(e.role=t.role||"user",e.subscriptionTier=t.tier||"free",e.preferences=t.metadata||{})}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio no JWT:",e)}return e},session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id||t.sub,e.user.role=t.role||"user",e.user.subscriptionTier=t.subscriptionTier||"free",e.user.preferences=t.preferences||{}),e)},pages:{signIn:"/login",error:"/auth/error",verifyRequest:"/auth/verify-request",newUser:"/register"},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET||"test-secret",debug:!1}},85662:(e,t,r)=>{"use strict";r.d(t,{pR:()=>p});var s=r(92885);let a=process.env.NEXT_PUBLIC_SUPABASE_URL||"",o=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",n=process.env.SUPABASE_SERVICE_ROLE_KEY||"",i=null;a&&o?(0,s.createClient)(a,o,{auth:{persistSession:!0,autoRefreshToken:!0,storage:void 0,storageKey:"supabase.auth.token"}}):(0,s.createClient)("https://placeholder.supabase.co","placeholder-key",{auth:{persistSession:!1,autoRefreshToken:!1}});let l=null,p=l=a&&n?(0,s.createClient)(a,n,{auth:{persistSession:!1,autoRefreshToken:!1}}):(0,s.createClient)("https://placeholder.supabase.co","placeholder-service-key",{auth:{persistSession:!1,autoRefreshToken:!1}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,6231,5326],()=>r(24568));module.exports=s})();