(()=>{var e={};e.id=5082,e.ids=[5082],e.modules={92885:e=>{"use strict";e.exports=require("@supabase/supabase-js")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},16305:()=>{},67379:(e,r,s)=>{"use strict";s.r(r),s.d(r,{originalPathname:()=>x,patchFetch:()=>_,requestAsyncStorage:()=>T,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>S});var t={};s.r(t),s.d(t,{GET:()=>E,POST:()=>g,PUT:()=>v,dynamic:()=>h,runtime:()=>d});var o=s(49303),i=s(88716),a=s(60670),n=s(87070),u=s(26231),c=s(91232);class l{constructor(){this.provider=null,this.initializeProvider()}async initializeProvider(){if(process.env.ELEVENLABS_API_KEY){let{ElevenLabsProvider:e}=await s.e(6983).then(s.bind(s,96983));this.provider=new e(process.env.ELEVENLABS_API_KEY),console.log("[TTS] ElevenLabs provider inicializado")}else if(process.env.AZURE_SPEECH_KEY&&process.env.AZURE_SPEECH_REGION){let{AzureProvider:e}=await Promise.all([s.e(5135),s.e(6395)]).then(s.bind(s,1923));this.provider=new e(process.env.AZURE_SPEECH_KEY,process.env.AZURE_SPEECH_REGION),console.log("[TTS] Azure provider inicializado")}else{console.warn("[TTS] Nenhum provider configurado, usando mock");let{MockProvider:e}=await s.e(3303).then(s.bind(s,43303));this.provider=new e}}async generateSpeech(e){if(this.provider||await this.initializeProvider(),!this.provider)return{success:!1,error:"Nenhum provider TTS configurado"};try{let r=await this.provider.generateSpeech(e);return console.log(`[TTS] \xc1udio gerado: ${r.duration}s`),r}catch(e){return console.error("[TTS] Erro ao gerar \xe1udio:",e),{success:!1,error:e instanceof Error?e.message:"Erro desconhecido"}}}async listVoices(){if(this.provider||await this.initializeProvider(),!this.provider)return[];try{return await this.provider.listVoices()}catch(e){return console.error("[TTS] Erro ao listar vozes:",e),[]}}async generateMultiple(e){let r=await Promise.all(e.map(e=>this.generateSpeech(e))),s=r.filter(e=>e.success).length;return console.log(`[TTS] ${s}/${e.length} \xe1udios gerados com sucesso`),r}}let p=new l,d="nodejs",h="force-dynamic";async function g(e){try{let r=await (0,u.default)(c.L);if(!r?.user?.id)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{text:s,voice:t,language:o,speed:i,pitch:a}=await e.json();if(!s||0===s.trim().length)return n.NextResponse.json({error:"Texto \xe9 obrigat\xf3rio"},{status:400});console.log(`[TTS API] Gerando \xe1udio para: "${s.substring(0,50)}..."`);let l=await p.generateSpeech({text:s,voice:t||"pt-BR-default",language:o||"pt-BR",speed:i||1,pitch:a||1});if(!l.success)return n.NextResponse.json({error:l.error||"Falha ao gerar \xe1udio"},{status:500});return n.NextResponse.json({success:!0,audioUrl:l.audioUrl,duration:l.duration,provider:"TTS Service"})}catch(e){return console.error("[TTS API] Erro:",e),n.NextResponse.json({error:"Erro ao gerar \xe1udio",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function v(e){try{let r=await (0,u.default)(c.L);if(!r?.user?.id)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{slides:s}=await e.json();if(!Array.isArray(s)||0===s.length)return n.NextResponse.json({error:"Array de slides \xe9 obrigat\xf3rio"},{status:400});console.log(`[TTS API] Gerando \xe1udio para ${s.length} slides em batch`);let t=await p.generateMultiple(s.map(e=>({text:e.text||e.content||e.notes||"",voice:e.voice,language:e.language||"pt-BR"}))),o=t.filter(e=>e.success).length;return n.NextResponse.json({success:!0,total:s.length,generated:o,failed:s.length-o,results:t.map((e,r)=>({slideIndex:r,success:e.success,audioUrl:e.audioUrl,duration:e.duration,error:e.error}))})}catch(e){return console.error("[TTS API] Erro em batch:",e),n.NextResponse.json({error:"Erro ao gerar \xe1udios em batch"},{status:500})}}async function E(e){try{let e=await p.listVoices();return n.NextResponse.json({success:!0,voices:e,total:e.length})}catch(e){return n.NextResponse.json({error:"Erro ao listar vozes"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/tts/generate/route",pathname:"/api/tts/generate",filename:"route",bundlePath:"app/api/tts/generate/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\tts\\generate\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:T,staticGenerationAsyncStorage:S,serverHooks:f}=m,x="/api/tts/generate/route";function _(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:S})}},91232:(e,r,s)=>{"use strict";s.d(r,{L:()=>g});var t=s(74194),o=s(92885),i=s(98691),a=s(80772),n=s(64198),u=s(8204);let c=process.env.NEXT_PUBLIC_SUPABASE_URL||"",l=process.env.SUPABASE_SERVICE_ROLE_KEY||"",p=!!(c&&l)&&c.includes("supabase.co"),d=p?(0,o.createClient)(c,l,{auth:{persistSession:!1,autoRefreshToken:!1}}):null,h=[(0,a.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email",placeholder:"seu@email.com"},password:{label:"Senha",type:"password"}},async authorize(e){let r=String(e?.email||"").trim().toLowerCase(),s=String(e?.password||"");if(!r||!s)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!p||!d)throw console.warn("⚠️ Supabase n\xe3o configurado. Configure as vari\xe1veis de ambiente ou use credenciais de teste."),Error("Servi\xe7o de autentica\xe7\xe3o indispon\xedvel");try{let{data:e,error:t}=await d.from("users").select("id, email, name, role, tier, password_hash, avatar_url, metadata").eq("email",r).single();if(t||!e||!await (0,i.qu)(s,e.password_hash))throw Error("Credenciais inv\xe1lidas");let o=e.metadata&&"object"==typeof e.metadata?e.metadata:{};return{id:e.id,email:e.email,name:e.name,role:e.role||"user",subscriptionTier:e.tier||"free",tier:e.tier||"free",preferences:o,image:e.avatar_url}}catch(e){throw console.error("Erro na autentica\xe7\xe3o:",e),Error("Credenciais inv\xe1lidas")}}})];process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&h.push((0,u.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})),process.env.SMTP_HOST&&process.env.SMTP_USER&&process.env.SMTP_PASS&&h.push((0,n.Z)({server:{host:process.env.SMTP_HOST,port:parseInt(process.env.SMTP_PORT||"587",10),auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}},from:process.env.SMTP_FROM||process.env.SMTP_USER}));let g={...p?{adapter:(0,t.S3)({url:c,secret:l})}:{},providers:h,callbacks:{async jwt({token:e,user:r}){if(r)e.id=r.id,e.email=r.email,e.role=r.role||"user",e.subscriptionTier=r.subscriptionTier||r.tier||"free",e.preferences=r.preferences||{};else if(e.sub&&p&&d&&(!e.role||!e.subscriptionTier))try{let{data:r}=await d.from("users").select("role, tier, metadata").eq("id",e.sub).single();r&&(e.role=r.role||"user",e.subscriptionTier=r.tier||"free",e.preferences=r.metadata||{})}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio no JWT:",e)}return e},session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id||r.sub,e.user.role=r.role||"user",e.user.subscriptionTier=r.subscriptionTier||"free",e.user.preferences=r.preferences||{}),e)},pages:{signIn:"/login",error:"/auth/error",verifyRequest:"/auth/verify-request",newUser:"/register"},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET||"test-secret",debug:!1}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[9276,5972,6231,5326],()=>s(67379));module.exports=t})();