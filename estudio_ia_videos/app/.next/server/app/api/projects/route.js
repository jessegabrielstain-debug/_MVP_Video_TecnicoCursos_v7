(()=>{var e={};e.id=4871,e.ids=[4871],e.modules={92885:e=>{"use strict";e.exports=require("@supabase/supabase-js")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},16305:()=>{},74952:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>T,requestAsyncStorage:()=>h,routeModule:()=>S,serverHooks:()=>R,staticGenerationAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{GET:()=>x,POST:()=>v,dynamic:()=>E});var o=t(49303),a=t(88716),i=t(60670),n=t(87070),p=t(26231),c=t(91232),u=t(92885),l=t(91585);l.Ry({file:l.Pp(File).refine(e=>e.size<=314572800,{message:"Arquivo muito grande. M\xe1ximo: 300MB"}).refine(e=>e.name.endsWith(".pptx")||"application/vnd.openxmlformats-officedocument.presentationml.presentation"===e.type,{message:"Apenas arquivos .pptx s\xe3o permitidos"})});let d=l.Ry({title:l.Z_().min(3,"T\xedtulo deve ter pelo menos 3 caracteres").max(100),description:l.Z_().max(500).optional(),templateId:l.Z_().uuid().optional(),fileUrl:l.Z_().url()});l.Ry({id:l.Z_().uuid(),title:l.Z_().min(3).max(100).optional(),description:l.Z_().max(500).optional(),status:l.Km(["draft","processing","completed","error"]).optional()}),l.Ry({resolution:l.Km(["720p","1080p","4k"]),fps:l.Rx().int().min(24).max(60),format:l.Km(["mp4","webm"]),quality:l.Km(["low","medium","high","ultra"])}),l.Ry({voiceId:l.Z_(),speed:l.Rx().min(.5).max(2),pitch:l.Rx().min(-10).max(10),volume:l.Rx().min(0).max(100)}),l.Ry({projectId:l.Z_().uuid(),rating:l.Rx().int().min(1).max(5),comment:l.Z_().max(1e3).optional(),category:l.Km(["quality","speed","ease","support","other"])}),l.Ry({tier:l.Km(["free","pro","enterprise"]),billingCycle:l.Km(["monthly","yearly"]),paymentMethod:l.Z_()});let m=process.env.NEXT_PUBLIC_SUPABASE_URL||"",_=process.env.SUPABASE_SERVICE_ROLE_KEY||"",f=(0,u.createClient)(m,_),E="force-dynamic";async function v(e){try{let r=await (0,p.default)(c.L);if(!r||!r.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let t=await e.json(),s=d.parse(t),{data:o,error:a}=await f.from("projects").insert({user_id:r.user.id,title:s.title,description:s.description,file_url:s.fileUrl,template_id:s.templateId,status:"draft",created_at:new Date().toISOString()}).select().single();if(a)return console.error("Erro ao criar projeto:",a),n.NextResponse.json({error:"Erro ao criar projeto"},{status:500});return n.NextResponse.json({success:!0,data:o})}catch(e){return console.error("Erro na API de projetos:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function x(e){try{let e=await (0,p.default)(c.L);if(!e||!e.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{data:r,error:t}=await f.from("projects").select("*").eq("user_id",e.user.id).order("created_at",{ascending:!1});if(t)return console.error("Erro ao listar projetos:",t),n.NextResponse.json({error:"Erro ao listar projetos"},{status:500});return n.NextResponse.json({success:!0,data:r||[]})}catch(e){return console.error("Erro na API de projetos:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let S=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\projects\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:R}=S,g="/api/projects/route";function T(){return(0,i.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:y})}},91232:(e,r,t)=>{"use strict";t.d(r,{L:()=>_});var s=t(74194),o=t(92885),a=t(98691),i=t(80772),n=t(64198),p=t(8204);let c=process.env.NEXT_PUBLIC_SUPABASE_URL||"",u=process.env.SUPABASE_SERVICE_ROLE_KEY||"",l=!!(c&&u)&&c.includes("supabase.co"),d=l?(0,o.createClient)(c,u,{auth:{persistSession:!1,autoRefreshToken:!1}}):null,m=[(0,i.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email",placeholder:"seu@email.com"},password:{label:"Senha",type:"password"}},async authorize(e){let r=String(e?.email||"").trim().toLowerCase(),t=String(e?.password||"");if(!r||!t)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!l||!d)throw console.warn("⚠️ Supabase n\xe3o configurado. Configure as vari\xe1veis de ambiente ou use credenciais de teste."),Error("Servi\xe7o de autentica\xe7\xe3o indispon\xedvel");try{let{data:e,error:s}=await d.from("users").select("id, email, name, role, tier, password_hash, avatar_url, metadata").eq("email",r).single();if(s||!e||!await (0,a.qu)(t,e.password_hash))throw Error("Credenciais inv\xe1lidas");let o=e.metadata&&"object"==typeof e.metadata?e.metadata:{};return{id:e.id,email:e.email,name:e.name,role:e.role||"user",subscriptionTier:e.tier||"free",tier:e.tier||"free",preferences:o,image:e.avatar_url}}catch(e){throw console.error("Erro na autentica\xe7\xe3o:",e),Error("Credenciais inv\xe1lidas")}}})];process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&m.push((0,p.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})),process.env.SMTP_HOST&&process.env.SMTP_USER&&process.env.SMTP_PASS&&m.push((0,n.Z)({server:{host:process.env.SMTP_HOST,port:parseInt(process.env.SMTP_PORT||"587",10),auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}},from:process.env.SMTP_FROM||process.env.SMTP_USER}));let _={...l?{adapter:(0,s.S3)({url:c,secret:u})}:{},providers:m,callbacks:{async jwt({token:e,user:r}){if(r)e.id=r.id,e.email=r.email,e.role=r.role||"user",e.subscriptionTier=r.subscriptionTier||r.tier||"free",e.preferences=r.preferences||{};else if(e.sub&&l&&d&&(!e.role||!e.subscriptionTier))try{let{data:r}=await d.from("users").select("role, tier, metadata").eq("id",e.sub).single();r&&(e.role=r.role||"user",e.subscriptionTier=r.tier||"free",e.preferences=r.metadata||{})}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio no JWT:",e)}return e},session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id||r.sub,e.user.role=r.role||"user",e.user.subscriptionTier=r.subscriptionTier||"free",e.user.preferences=r.preferences||{}),e)},pages:{signIn:"/login",error:"/auth/error",verifyRequest:"/auth/verify-request",newUser:"/register"},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET||"test-secret",debug:!1}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,6231,5326,1585],()=>t(74952));module.exports=s})();