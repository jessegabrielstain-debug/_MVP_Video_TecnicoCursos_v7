"use strict";(()=>{var e={};e.id=3697,e.ids=[3697],e.modules={92885:e=>{e.exports=require("@supabase/supabase-js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6921:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>_,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>j,staticGenerationAsyncStorage:()=>v});var o={};r.r(o),r.d(o,{POST:()=>c,dynamic:()=>u});var s=r(49303),a=r(88716),i=r(60670),n=r(87070),p=r(85662);let u="force-dynamic";async function c(e,{params:t}){try{let r=t.projectId;if(!r)return n.NextResponse.json({error:"Project ID \xe9 obrigat\xf3rio"},{status:400});let{timeline_data:o,duration:s,projectName:a,reason:i="auto"}=await e.json(),{data:u,error:c}=await p.pR.from("projects").select("id, title").eq("id",r).single();if(c||!u)return n.NextResponse.json({error:"Projeto n\xe3o encontrado"},{status:404});let d={updated_at:new Date().toISOString(),timeline_data:o||{}};void 0!==s&&(d.duration=s),a&&a!==u.title&&(d.title=a);let{data:l,error:v}=await p.pR.from("projects").update(d).eq("id",r).select("id, title, duration, updated_at").single();if(v)throw Error(v.message);return console.log(`âœ… [Autosave] Projeto ${r} salvo (${i})`),n.NextResponse.json({success:!0,project:l,savedAt:new Date().toISOString(),reason:i})}catch(t){console.error("[Autosave] Erro ao salvar projeto:",t);let e=t instanceof Error?t.message:"Erro desconhecido ao salvar projeto";return n.NextResponse.json({error:"Falha ao salvar projeto",details:e},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/projects/[projectId]/autosave/route",pathname:"/api/projects/[projectId]/autosave",filename:"route",bundlePath:"app/api/projects/[projectId]/autosave/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\projects\\[projectId]\\autosave\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:v,serverHooks:j}=d,h="/api/projects/[projectId]/autosave/route";function _(){return(0,i.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:v})}},85662:(e,t,r)=>{r.d(t,{pR:()=>u});var o=r(92885);let s=process.env.NEXT_PUBLIC_SUPABASE_URL||"",a=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",i=process.env.SUPABASE_SERVICE_ROLE_KEY||"",n=null;s&&a?(0,o.createClient)(s,a,{auth:{persistSession:!0,autoRefreshToken:!0,storage:void 0,storageKey:"supabase.auth.token"}}):(0,o.createClient)("https://placeholder.supabase.co","placeholder-key",{auth:{persistSession:!1,autoRefreshToken:!1}});let p=null,u=p=s&&i?(0,o.createClient)(s,i,{auth:{persistSession:!1,autoRefreshToken:!1}}):(0,o.createClient)("https://placeholder.supabase.co","placeholder-service-key",{auth:{persistSession:!1,autoRefreshToken:!1}})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[9276,5972],()=>r(6921));module.exports=o})();