(()=>{var e={};e.id=5998,e.ids=[5998],e.modules={92885:e=>{"use strict";e.exports=require("@supabase/supabase-js")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},16305:()=>{},65897:(e,r,s)=>{"use strict";s.r(r),s.d(r,{originalPathname:()=>P,patchFetch:()=>N,requestAsyncStorage:()=>x,routeModule:()=>g,serverHooks:()=>T,staticGenerationAsyncStorage:()=>R});var t={};s.r(t),s.d(t,{DELETE:()=>v,GET:()=>S,POST:()=>_,dynamic:()=>h});var o=s(49303),a=s(88716),i=s(60670),n=s(87070),u=s(26231),c=s(91232),l=s(92885);let p=process.env.NEXT_PUBLIC_SUPABASE_URL||"",d=process.env.SUPABASE_SERVICE_ROLE_KEY||"",f=(0,l.createClient)(p,d);async function E(e,r){try{if(!e.name.endsWith(".pptx"))return{success:!1,error:"Apenas arquivos .pptx s\xe3o permitidos"};if(e.size>314572800)return{success:!1,error:"Arquivo muito grande. M\xe1ximo: 300MB"};let s=Date.now(),t=`${r}/${s}-${e.name}`,{data:o,error:a}=await f.storage.from("uploads").upload(t,e,{cacheControl:"3600",upsert:!1});if(a)return console.error("Erro no upload:",a),{success:!1,error:"Erro ao fazer upload do arquivo"};let{data:i}=f.storage.from("uploads").getPublicUrl(t);return{success:!0,fileUrl:i.publicUrl,fileName:e.name,fileSize:e.size}}catch(e){return console.error("Erro no upload:",e),{success:!1,error:"Erro inesperado ao fazer upload"}}}var m=s(85662);let h="force-dynamic";async function _(e){try{let r=await (0,u.default)(c.L);if(!r||!r.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let s=(await e.formData()).get("file");if(!s)return n.NextResponse.json({error:"Nenhum arquivo enviado"},{status:400});let t=await E(s,r.user.id);if(!t.success)return n.NextResponse.json({error:t.error},{status:400});return n.NextResponse.json({success:!0,data:{fileUrl:t.fileUrl,fileName:t.fileName,fileSize:t.fileSize}})}catch(e){return console.error("Erro na API de upload:",e),n.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function S(e){try{let r=await (0,u.default)(c.L);if(!r||!r.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let s=e.nextUrl.searchParams,t=parseInt(s.get("limit")||"50"),o=parseInt(s.get("offset")||"0"),a=s.get("status"),i=m.pR.from("projects").select("id, title, file_url, thumbnail_url, status, duration, created_at, updated_at",{count:"exact"}).eq("user_id",r.user.id).order("created_at",{ascending:!1}).range(o,o+t-1);a&&(i=i.eq("status",a));let{data:l,error:p,count:d}=await i;if(p)throw console.error("Erro do Supabase ao listar uploads:",p),Error(p.message);return n.NextResponse.json({success:!0,uploads:l||[],pagination:{total:d||0,limit:t,offset:o,hasMore:!!d&&o+t<d}})}catch(e){return console.error("Erro ao listar uploads:",e),n.NextResponse.json({error:"Erro interno do servidor",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}async function v(e){try{let r=await (0,u.default)(c.L);if(!r||!r.user)return n.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{searchParams:s}=e.nextUrl,t=s.get("id");if(!t)return n.NextResponse.json({error:"ID do upload n\xe3o fornecido"},{status:400});let{data:o,error:a}=await m.pR.from("projects").select("id, user_id").eq("id",t).single();if(a||!o)return n.NextResponse.json({error:"Upload n\xe3o encontrado"},{status:404});if(o.user_id!==r.user.id)return n.NextResponse.json({error:"Acesso negado"},{status:403});let{error:i}=await m.pR.from("projects").delete().eq("id",t);if(i)throw Error(i.message);return n.NextResponse.json({success:!0,message:"Upload exclu\xeddo com sucesso"})}catch(e){return console.error("Erro ao excluir upload:",e),n.NextResponse.json({error:"Erro ao excluir upload",details:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},resolvedPagePath:"C:\\xampp\\htdocs\\_MVP_Video_TecnicoCursos_v7\\estudio_ia_videos\\app\\app\\api\\upload\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:x,staticGenerationAsyncStorage:R,serverHooks:T}=g,P="/api/upload/route";function N(){return(0,i.patchFetch)({serverHooks:T,staticGenerationAsyncStorage:R})}},91232:(e,r,s)=>{"use strict";s.d(r,{L:()=>E});var t=s(74194),o=s(92885),a=s(98691),i=s(80772),n=s(64198),u=s(8204);let c=process.env.NEXT_PUBLIC_SUPABASE_URL||"",l=process.env.SUPABASE_SERVICE_ROLE_KEY||"",p=!!(c&&l)&&c.includes("supabase.co"),d=p?(0,o.createClient)(c,l,{auth:{persistSession:!1,autoRefreshToken:!1}}):null,f=[(0,i.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email",placeholder:"seu@email.com"},password:{label:"Senha",type:"password"}},async authorize(e){let r=String(e?.email||"").trim().toLowerCase(),s=String(e?.password||"");if(!r||!s)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!p||!d)throw console.warn("⚠️ Supabase n\xe3o configurado. Configure as vari\xe1veis de ambiente ou use credenciais de teste."),Error("Servi\xe7o de autentica\xe7\xe3o indispon\xedvel");try{let{data:e,error:t}=await d.from("users").select("id, email, name, role, tier, password_hash, avatar_url, metadata").eq("email",r).single();if(t||!e||!await (0,a.qu)(s,e.password_hash))throw Error("Credenciais inv\xe1lidas");let o=e.metadata&&"object"==typeof e.metadata?e.metadata:{};return{id:e.id,email:e.email,name:e.name,role:e.role||"user",subscriptionTier:e.tier||"free",tier:e.tier||"free",preferences:o,image:e.avatar_url}}catch(e){throw console.error("Erro na autentica\xe7\xe3o:",e),Error("Credenciais inv\xe1lidas")}}})];process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&f.push((0,u.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})),process.env.SMTP_HOST&&process.env.SMTP_USER&&process.env.SMTP_PASS&&f.push((0,n.Z)({server:{host:process.env.SMTP_HOST,port:parseInt(process.env.SMTP_PORT||"587",10),auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}},from:process.env.SMTP_FROM||process.env.SMTP_USER}));let E={...p?{adapter:(0,t.S3)({url:c,secret:l})}:{},providers:f,callbacks:{async jwt({token:e,user:r}){if(r)e.id=r.id,e.email=r.email,e.role=r.role||"user",e.subscriptionTier=r.subscriptionTier||r.tier||"free",e.preferences=r.preferences||{};else if(e.sub&&p&&d&&(!e.role||!e.subscriptionTier))try{let{data:r}=await d.from("users").select("role, tier, metadata").eq("id",e.sub).single();r&&(e.role=r.role||"user",e.subscriptionTier=r.tier||"free",e.preferences=r.metadata||{})}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio no JWT:",e)}return e},session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id||r.sub,e.user.role=r.role||"user",e.user.subscriptionTier=r.subscriptionTier||"free",e.user.preferences=r.preferences||{}),e)},pages:{signIn:"/login",error:"/auth/error",verifyRequest:"/auth/verify-request",newUser:"/register"},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET||"test-secret",debug:!1}},85662:(e,r,s)=>{"use strict";s.d(r,{pR:()=>c});var t=s(92885);let o=process.env.NEXT_PUBLIC_SUPABASE_URL||"",a=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",i=process.env.SUPABASE_SERVICE_ROLE_KEY||"",n=null;o&&a?(0,t.createClient)(o,a,{auth:{persistSession:!0,autoRefreshToken:!0,storage:void 0,storageKey:"supabase.auth.token"}}):(0,t.createClient)("https://placeholder.supabase.co","placeholder-key",{auth:{persistSession:!1,autoRefreshToken:!1}});let u=null,c=u=o&&i?(0,t.createClient)(o,i,{auth:{persistSession:!1,autoRefreshToken:!1}}):(0,t.createClient)("https://placeholder.supabase.co","placeholder-service-key",{auth:{persistSession:!1,autoRefreshToken:!1}})}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[9276,5972,6231,5326],()=>s(65897));module.exports=t})();