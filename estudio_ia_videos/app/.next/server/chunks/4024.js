"use strict";exports.id=4024,exports.ids=[4024],exports.modules={29237:(t,e,s)=>{s.d(e,{H2:()=>n}),s(87070);var i=s(81168),r=s.n(i);class h{constructor(t={}){let e=t.interval??6e4,s=t.uniqueTokenPerInterval??500,h=i.LRUCache??r()??i;this.tokenCache=new h({max:s,ttl:e})}async check(t,e){let s=this.getToken(t),i=Date.now(),r=i-6e4,h=(this.tokenCache.get(s)||[]).filter(t=>t>r);return h.length<e?(h.push(i),this.tokenCache.set(s,h),{success:!0,result:{limit:e,remaining:e-h.length,reset:r+6e4}}):{success:!1,result:{limit:e,remaining:0,reset:(h.length?Math.min(...h):i)+6e4}}}getToken(t){let e=e=>{let s=t.headers;if("function"==typeof s?.get)return s.get(e);let i=Object.keys(s||{}).find(t=>t.toLowerCase()===e.toLowerCase());return i?s[i]:null},s=t.ip??e("x-forwarded-for")??"unknown",i=e("user-agent")??"unknown";return`${s}:${i}`}}function n(t){let e=new h({interval:t.interval});return async s=>{let{success:i,result:r}=await e.check({headers:s.headers},t.limit),h=new Headers({"X-RateLimit-Limit":r.limit.toString(),"X-RateLimit-Remaining":r.remaining.toString(),"X-RateLimit-Reset":new Date(r.reset).toISOString()});return i||h.set("Retry-After",Math.ceil((r.reset-Date.now())/1e3).toString()),{success:i,headers:h}}}},50042:(t,e,s)=>{s.d(e,{q:()=>h});var i=s(36087);class r{incrementCounter(t,e=1,s){let r=this.getKey(t,s),h=this.counters.get(r)||0;this.counters.set(r,h+e),i.k.debug(`Counter ${r} incremented to ${h+e}`)}setGauge(t,e,s){let r=this.getKey(t,s);this.gauges.set(r,e),i.k.debug(`Gauge ${r} set to ${e}`)}observeHistogram(t,e,s=[.1,.5,1,2,5,10],r){let h=this.getKey(t,r);this.histograms.has(h)||this.histograms.set(h,{buckets:s,values:new Map});let n=this.histograms.get(h);for(let t of n.buckets)if(e<=t){let e=n.values.get(t)||0;n.values.set(t,e+1)}i.k.debug(`Histogram ${h} observed value ${e}`)}observeSummary(t,e,s){let r=this.getKey(t,s);this.summaries.has(r)||this.summaries.set(r,[]);let h=this.summaries.get(r);h.push(e),h.length>1e3&&h.shift(),i.k.debug(`Summary ${r} observed value ${e}`)}getSummaryPercentiles(t,e=[.5,.9,.95,.99],s){let i=this.getKey(t,s),r=this.summaries.get(i)||[];if(0===r.length)return{};let h=[...r].sort((t,e)=>t-e),n={};for(let t of e){let e=Math.floor(h.length*t);n[`p${100*t}`]=h[e]}return n}exportPrometheus(){let t=[];for(let[e,s]of this.counters)t.push(`# TYPE ${e} counter`),t.push(`${e} ${s}`);for(let[e,s]of this.gauges)t.push(`# TYPE ${e} gauge`),t.push(`${e} ${s}`);for(let[e,s]of this.histograms){t.push(`# TYPE ${e} histogram`);let i=0,r=0;for(let[h,n]of s.values)t.push(`${e}_bucket{le="${h}"} ${n}`),i+=h*n,r+=n;t.push(`${e}_bucket{le="+Inf"} ${r}`),t.push(`${e}_sum ${i}`),t.push(`${e}_count ${r}`)}for(let[e,s]of this.summaries)if(s.length>0){for(let[s,i]of(t.push(`# TYPE ${e} summary`),Object.entries(this.getSummaryPercentiles(e.split("{")[0])))){let r=Number(s.replace(/^p/,""))/100;t.push(`${e}{quantile="${r}"} ${i}`)}let i=s.reduce((t,e)=>t+e,0);t.push(`${e}_sum ${i}`),t.push(`${e}_count ${s.length}`)}return t.join("\n")}getKey(t,e){if(!e||0===Object.keys(e).length)return t;let s=Object.entries(e).sort(([t],[e])=>t.localeCompare(e)).map(([t,e])=>`${t}="${e}"`).join(",");return`${t}{${s}}`}reset(){this.counters.clear(),this.gauges.clear(),this.histograms.clear(),this.summaries.clear()}constructor(){this.counters=new Map,this.gauges=new Map,this.histograms=new Map,this.summaries=new Map}}let h=new r,n={updateMemoryUsage:()=>{if("undefined"!=typeof process&&process.memoryUsage){let t=process.memoryUsage();h.setGauge("nodejs_memory_heap_used_bytes",t.heapUsed),h.setGauge("nodejs_memory_heap_total_bytes",t.heapTotal),h.setGauge("nodejs_memory_rss_bytes",t.rss),h.setGauge("nodejs_memory_external_bytes",t.external)}}};"undefined"!=typeof process&&setInterval(()=>{n.updateMemoryUsage()},3e4)},36087:(t,e,s)=>{s.d(e,{k:()=>r});class i{get isDevelopment(){return!1}formatMessage(t,e,s){return{level:t,message:e,timestamp:new Date().toISOString(),data:s}}log(t,e,s){let i=this.formatMessage(t,e,s);this.isDevelopment?console.log(`${{info:"\x1b[36m",warn:"\x1b[33m",error:"\x1b[31m",debug:"\x1b[35m"}[t]}[${t.toUpperCase()}]\x1b[0m ${i.timestamp} - ${e}`,s||""):console.log(JSON.stringify(i))}info(t,e){this.log("info",t,e)}warn(t,e){this.log("warn",t,e)}error(t,e){this.log("error",t,e)}debug(t,e){this.isDevelopment&&this.log("debug",t,e)}createContext(t){return{info:(e,s)=>this.info(`[${t}] ${e}`,s),warn:(e,s)=>this.warn(`[${t}] ${e}`,s),error:(e,s)=>this.error(`[${t}] ${e}`,s),debug:(e,s)=>this.debug(`[${t}] ${e}`,s)}}}let r=new i},81168:(t,e,s)=>{let i=s(10949),r=Symbol("max"),h=Symbol("length"),n=Symbol("lengthCalculator"),l=Symbol("allowStale"),a=Symbol("maxAge"),o=Symbol("dispose"),u=Symbol("noDisposeOnSet"),g=Symbol("lruList"),p=Symbol("cache"),f=Symbol("updateAgeOnGet"),m=()=>1;class v{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw TypeError("max must be a non-negative number");this[r]=t.max||1/0;let e=t.length||m;if(this[n]="function"!=typeof e?m:e,this[l]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw TypeError("maxAge must be a number");this[a]=t.maxAge||0,this[o]=t.dispose,this[u]=t.noDisposeOnSet||!1,this[f]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw TypeError("max must be a non-negative number");this[r]=t||1/0,y(this)}get max(){return this[r]}set allowStale(t){this[l]=!!t}get allowStale(){return this[l]}set maxAge(t){if("number"!=typeof t)throw TypeError("maxAge must be a non-negative number");this[a]=t,y(this)}get maxAge(){return this[a]}set lengthCalculator(t){"function"!=typeof t&&(t=m),t!==this[n]&&(this[n]=t,this[h]=0,this[g].forEach(t=>{t.length=this[n](t.value,t.key),this[h]+=t.length})),y(this)}get lengthCalculator(){return this[n]}get length(){return this[h]}get itemCount(){return this[g].length}rforEach(t,e){e=e||this;for(let s=this[g].tail;null!==s;){let i=s.prev;b(this,t,s,e),s=i}}forEach(t,e){e=e||this;for(let s=this[g].head;null!==s;){let i=s.next;b(this,t,s,e),s=i}}keys(){return this[g].toArray().map(t=>t.key)}values(){return this[g].toArray().map(t=>t.value)}reset(){this[o]&&this[g]&&this[g].length&&this[g].forEach(t=>this[o](t.key,t.value)),this[p]=new Map,this[g]=new i,this[h]=0}dump(){return this[g].map(t=>!d(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[g]}set(t,e,s){if((s=s||this[a])&&"number"!=typeof s)throw TypeError("maxAge must be a number");let i=s?Date.now():0,l=this[n](e,t);if(this[p].has(t)){if(l>this[r])return x(this,this[p].get(t)),!1;let n=this[p].get(t).value;return this[o]&&!this[u]&&this[o](t,n.value),n.now=i,n.maxAge=s,n.value=e,this[h]+=l-n.length,n.length=l,this.get(t),y(this),!0}let f=new w(t,e,l,i,s);return f.length>this[r]?(this[o]&&this[o](t,e),!1):(this[h]+=f.length,this[g].unshift(f),this[p].set(t,this[g].head),y(this),!0)}has(t){return!!this[p].has(t)&&!d(this,this[p].get(t).value)}get(t){return c(this,t,!0)}peek(t){return c(this,t,!1)}pop(){let t=this[g].tail;return t?(x(this,t),t.value):null}del(t){x(this,this[p].get(t))}load(t){this.reset();let e=Date.now();for(let s=t.length-1;s>=0;s--){let i=t[s],r=i.e||0;if(0===r)this.set(i.k,i.v);else{let t=r-e;t>0&&this.set(i.k,i.v,t)}}}prune(){this[p].forEach((t,e)=>c(this,e,!1))}}let c=(t,e,s)=>{let i=t[p].get(e);if(i){let e=i.value;if(d(t,e)){if(x(t,i),!t[l])return}else s&&(t[f]&&(i.value.now=Date.now()),t[g].unshiftNode(i));return e.value}},d=(t,e)=>{if(!e||!e.maxAge&&!t[a])return!1;let s=Date.now()-e.now;return e.maxAge?s>e.maxAge:t[a]&&s>t[a]},y=t=>{if(t[h]>t[r])for(let e=t[g].tail;t[h]>t[r]&&null!==e;){let s=e.prev;x(t,e),e=s}},x=(t,e)=>{if(e){let s=e.value;t[o]&&t[o](s.key,s.value),t[h]-=s.length,t[p].delete(s.key),t[g].removeNode(e)}};class w{constructor(t,e,s,i,r){this.key=t,this.value=e,this.length=s,this.now=i,this.maxAge=r||0}}let b=(t,e,s,i)=>{let r=s.value;d(t,r)&&(x(t,s),t[l]||(r=void 0)),r&&e.call(i,r.value,r.key,t)};t.exports=v},83988:t=>{t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},10949:(t,e,s)=>{function i(t){var e=this;if(e instanceof i||(e=new i),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var s=0,r=arguments.length;s<r;s++)e.push(arguments[s]);return e}function r(t,e,s,i){if(!(this instanceof r))return new r(t,e,s,i);this.list=i,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,s?(s.prev=this,this.next=s):this.next=null}t.exports=i,i.Node=r,i.create=i,i.prototype.removeNode=function(t){if(t.list!==this)throw Error("removing node which does not belong to this list");var e=t.next,s=t.prev;return e&&(e.prev=s),s&&(s.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=s),t.list.length--,t.next=null,t.prev=null,t.list=null,e},i.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},i.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},i.prototype.push=function(){for(var t,e=0,s=arguments.length;e<s;e++)t=arguments[e],this.tail=new r(t,this.tail,null,this),this.head||(this.head=this.tail),this.length++;return this.length},i.prototype.unshift=function(){for(var t,e=0,s=arguments.length;e<s;e++)t=arguments[e],this.head=new r(t,null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},i.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},i.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},i.prototype.forEach=function(t,e){e=e||this;for(var s=this.head,i=0;null!==s;i++)t.call(e,s.value,i,this),s=s.next},i.prototype.forEachReverse=function(t,e){e=e||this;for(var s=this.tail,i=this.length-1;null!==s;i--)t.call(e,s.value,i,this),s=s.prev},i.prototype.get=function(t){for(var e=0,s=this.head;null!==s&&e<t;e++)s=s.next;if(e===t&&null!==s)return s.value},i.prototype.getReverse=function(t){for(var e=0,s=this.tail;null!==s&&e<t;e++)s=s.prev;if(e===t&&null!==s)return s.value},i.prototype.map=function(t,e){e=e||this;for(var s=new i,r=this.head;null!==r;)s.push(t.call(e,r.value,this)),r=r.next;return s},i.prototype.mapReverse=function(t,e){e=e||this;for(var s=new i,r=this.tail;null!==r;)s.push(t.call(e,r.value,this)),r=r.prev;return s},i.prototype.reduce=function(t,e){var s,i=this.head;if(arguments.length>1)s=e;else if(this.head)i=this.head.next,s=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var r=0;null!==i;r++)s=t(s,i.value,r),i=i.next;return s},i.prototype.reduceReverse=function(t,e){var s,i=this.tail;if(arguments.length>1)s=e;else if(this.tail)i=this.tail.prev,s=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;null!==i;r--)s=t(s,i.value,r),i=i.prev;return s},i.prototype.toArray=function(){for(var t=Array(this.length),e=0,s=this.head;null!==s;e++)t[e]=s.value,s=s.next;return t},i.prototype.toArrayReverse=function(){for(var t=Array(this.length),e=0,s=this.tail;null!==s;e++)t[e]=s.value,s=s.prev;return t},i.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var s=new i;if(e<t||e<0)return s;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=0,h=this.head;null!==h&&r<t;r++)h=h.next;for(;null!==h&&r<e;r++,h=h.next)s.push(h.value);return s},i.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var s=new i;if(e<t||e<0)return s;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=this.length,h=this.tail;null!==h&&r>e;r--)h=h.prev;for(;null!==h&&r>t;r--,h=h.prev)s.push(h.value);return s},i.prototype.splice=function(t,e){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var s=0,i=this.head;null!==i&&s<t;s++)i=i.next;for(var h=[],s=0;i&&s<e;s++)h.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var s=2;s<arguments.length;s++)i=function(t,e,s){var i=e===t.head?new r(s,null,e,t):new r(s,e,e.next,t);return null===i.next&&(t.tail=i),null===i.prev&&(t.head=i),t.length++,i}(this,i,arguments[s]);return h},i.prototype.reverse=function(){for(var t=this.head,e=this.tail,s=t;null!==s;s=s.prev){var i=s.prev;s.prev=s.next,s.next=i}return this.head=e,this.tail=t,this};try{s(83988)(i)}catch(t){}}};