"use strict";exports.id=5508,exports.ids=[5508],exports.modules={85508:(t,e,r)=>{r.d(e,{PPTXShapeParser:()=>o});var a=r(18159);class o{static async extractShapesFromSlide(t,e){try{let r=`ppt/slides/slide${e}.xml`,o=await t.file(r)?.async("text");if(!o)return{success:!1,shapes:[],error:`Slide ${e} n\xe3o encontrado`};let s=await (0,a.parseStringPromise)(o),l=[],n=s["p:sld"]?.[0]?.["p:cSld"]?.[0]?.["p:spTree"]?.[0];if(!n)return{success:!0,shapes:[]};let c=n["p:sp"]||[];for(let r=0;r<c.length;r++){let a=await this.parseShape(c[r],r,t,e);a&&l.push(a)}let i=n["p:grpSp"]||[];for(let r=0;r<i.length;r++){let a=await this.parseGroup(i[r],r+c.length,t,e);a&&l.push(a)}let p=n["p:cxnSp"]||[];for(let t=0;t<p.length;t++){let e=await this.parseConnector(p[t],t+c.length+i.length);e&&l.push(e)}return l.sort((t,e)=>t.zIndex-e.zIndex),console.log(`üìê Extra\xeddas ${l.length} formas do slide ${e}`),{success:!0,shapes:l}}catch(t){return console.error(`Erro ao extrair formas do slide ${e}:`,t),{success:!1,shapes:[],error:t instanceof Error?t.message:"Erro desconhecido"}}}static async parseShape(t,e,r,a){try{let r=t["p:nvSpPr"]?.[0],a=r?.["p:cNvPr"]?.[0],o=t["p:spPr"]?.[0],s=a?.$?.id||`shape-${e}`,l=a?.$?.name||`Shape ${e}`,n=this.extractGeometry(o),c=this.extractTransform(o),i=this.extractStyle(o,t),p=t["p:txBody"]?.[0],h=p?this.extractTextFromBody(p):void 0,d=a?.$?.locked==="1",u=a?.$?.hidden==="1";return{id:s,type:"shape",name:l,geometry:n,transform:c,style:i,textContent:h,locked:d,hidden:u,zIndex:e}}catch(t){return console.error("Erro ao parsear shape:",t),null}}static async parseGroup(t,e,r,a){try{let o=t["p:nvGrpSpPr"]?.[0],s=o?.["p:cNvPr"]?.[0],l=t["p:grpSpPr"]?.[0],n=s?.$?.id||`group-${e}`,c=s?.$?.name||`Group ${e}`,i=this.extractTransform(l),p=[],h=t["p:sp"]||[];for(let t=0;t<h.length;t++){let e=await this.parseShape(h[t],t,r,a);e&&p.push(e)}return{id:n,type:"group",name:c,geometry:{type:"preset",preset:"rect"},transform:i,style:this.getDefaultStyle(),children:p,zIndex:e}}catch(t){return console.error("Erro ao parsear grupo:",t),null}}static async parseConnector(t,e){try{let r=t["p:nvCxnSpPr"]?.[0],a=r?.["p:cNvPr"]?.[0],o=t["p:spPr"]?.[0],s=a?.$?.id||`connector-${e}`,l=a?.$?.name||`Connector ${e}`,n=this.extractGeometry(o),c=this.extractTransform(o),i=this.extractStyle(o,t);return{id:s,type:"connector",name:l,geometry:n,transform:c,style:i,zIndex:e}}catch(t){return console.error("Erro ao parsear conector:",t),null}}static extractGeometry(t){let e=t?.["a:prstGeom"]?.[0];if(e){let t=e.$?.prst||"rect";return{type:"preset",preset:this.normalizePresetName(t)}}let r=t?.["a:custGeom"]?.[0];if(r){let t=r["a:pathLst"]?.[0],e=t?.["a:path"]?.[0];if(e)return{type:"custom",path:this.convertToSVGPath(e)}}return{type:"preset",preset:"rect"}}static extractTransform(t){let e=t?.["a:xfrm"]?.[0];if(!e)return{x:0,y:0,width:100,height:100,rotation:0,flipH:!1,flipV:!1};let r=e["a:off"]?.[0]?.$,a=e["a:ext"]?.[0]?.$,o=e.$?.rot,s=e.$?.flipH==="1",l=e.$?.flipV==="1",n=t=>Math.round(parseInt(t)/914400*96);return{x:r?n(r.x):0,y:r?n(r.y):0,width:a?n(a.cx):100,height:a?n(a.cy):100,rotation:o?parseInt(o)/6e4:0,flipH:s,flipV:l}}static extractStyle(t,e){return{fill:this.extractFill(t),stroke:this.extractStroke(t),effects:this.extractEffects(t),opacity:1}}static extractFill(t){let e=t?.["a:solidFill"]?.[0];if(e)return{type:"solid",color:this.extractColor(e),opacity:1};let r=t?.["a:gradFill"]?.[0];return r?{type:"gradient",gradient:this.extractGradient(r)}:t?.["a:noFill"]?{type:"none"}:{type:"solid",color:"#CCCCCC",opacity:1}}static extractStroke(t){let e=t?.["a:ln"]?.[0];if(!e)return{width:0,color:"#000000",style:"none"};let r=e.$?.w?parseInt(e.$.w)/12700:1,a=e["a:solidFill"]?.[0],o=a?this.extractColor(a):"#000000",s=e["a:prstDash"]?.[0]?.$?.val,l="solid";return"dash"===s?l="dashed":"dot"===s&&(l="dotted"),{width:r,color:o,style:l,opacity:1}}static extractEffects(t){let e=[],r=t?.["a:effectLst"]?.[0];if(!r)return e;let a=r["a:outerShdw"]?.[0];if(a){let t={type:"outer",color:this.extractColor(a)||"#000000",blur:parseInt(a.$?.blurRad||"0")/12700,offsetX:parseInt(a.$?.dist||"0")/12700,offsetY:parseInt(a.$?.dist||"0")/12700,opacity:.5};e.push({type:"shadow",shadow:t})}let o=r["a:glow"]?.[0];return o&&e.push({type:"glow",glowColor:this.extractColor(o)||"#FFFFFF",glowSize:parseInt(o.$?.rad||"0")/12700}),e}static extractColor(t){let e=t["a:srgbClr"]?.[0];if(e)return`#${e.$?.val||"CCCCCC"}`;let r=t["a:schemeClr"]?.[0];if(r){let t=r.$?.val;return this.resolveSchemeColor(t)}return"#CCCCCC"}static extractGradient(t){let e=t["a:gsLst"]?.[0],r=(e?.["a:gs"]||[]).map(t=>({position:parseInt(t.$?.pos||"0")/1e3,color:this.extractColor(t)})),a=t["a:lin"]?.[0];return{type:"linear",angle:a?parseInt(a.$?.ang||"0")/6e4:0,stops:r}}static convertToSVGPath(t){let e=t["a:moveTo"]?.[0],r=t["a:lnTo"]||[],a="M ";if(e){let t=e["a:pt"]?.[0]?.$;t&&(a+=`${t.x},${t.y} `)}return r.forEach(t=>{let e=t["a:pt"]?.[0]?.$;e&&(a+=`L ${e.x},${e.y} `)}),a.trim()}static extractTextFromBody(t){let e=t["a:p"]||[],r=[];return e.forEach(t=>{(t["a:r"]||[]).forEach(t=>{let e=t["a:t"]?.[0];e&&r.push(e)})}),r.join(" ")}static normalizePresetName(t){return({rect:"rectangle",ellipse:"ellipse",roundRect:"rounded-rectangle",triangle:"triangle",rtTriangle:"right-triangle",parallelogram:"parallelogram",trapezoid:"trapezoid",diamond:"diamond",pentagon:"pentagon",hexagon:"hexagon",octagon:"octagon",star5:"star-5",star6:"star-6",plus:"plus",arrow:"arrow"})[t]||t}static resolveSchemeColor(t){return({tx1:"#000000",bg1:"#FFFFFF",accent1:"#4472C4",accent2:"#ED7D31",accent3:"#A5A5A5",accent4:"#FFC000",accent5:"#5B9BD5",accent6:"#70AD47"})[t]||"#CCCCCC"}static getDefaultStyle(){return{fill:{type:"solid",color:"#CCCCCC",opacity:1},stroke:{width:1,color:"#000000",style:"solid",opacity:1},effects:[],opacity:1}}}}};