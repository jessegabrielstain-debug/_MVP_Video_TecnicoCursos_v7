"use strict";exports.id=2822,exports.ids=[2822],exports.modules={32822:(e,r,t)=>{t.d(r,{PPTXVideoParser:()=>s});var o=t(18159);class s{static async extractVideosFromSlide(e,r){try{let t=`ppt/slides/slide${r}.xml`,s=await e.file(t)?.async("text");if(!s)return{success:!1,videos:[],error:`Slide ${r} n\xe3o encontrado`};let i=await (0,o.parseStringPromise)(s),a=[];for(let t of this.extractVideoReferences(i,r)){let o=await this.extractVideoData(e,t,r);o&&a.push(o)}return{success:!0,videos:a}}catch(e){return console.error(`Erro ao extrair v\xeddeos do slide ${r}:`,e),{success:!1,videos:[],error:e instanceof Error?e.message:"Erro desconhecido"}}}static async extractAllVideos(e){try{let r=[],t=Object.keys(e.files).filter(e=>e.startsWith("ppt/media/")&&this.isVideoFile(e));for(let o of(console.log(`ðŸ“¹ Encontrados ${t.length} arquivos de v\xeddeo`),t)){let t=e.file(o);if(!t)continue;await t.async("blob");let s=await t.async("uint8array"),i=await t.async("base64"),a=o.split("/").pop()||"video",n=this.detectVideoFormat(a,s),l={id:this.generateVideoId(o),filename:a,format:n,src:`data:video/${n};base64,${i}`,size:s.length,width:1920,height:1080};r.push(l)}return{success:!0,videos:r}}catch(e){return console.error("Erro ao extrair todos os v\xeddeos:",e),{success:!1,videos:[],error:e instanceof Error?e.message:"Erro desconhecido"}}}static extractVideoReferences(e,r){let t=[];try{let r=e["p:sld"]?.[0]?.["p:cSld"]?.[0]?.["p:spTree"]?.[0];if(!r)return t;for(let e of r["p:pic"]||[]){let r=e["p:blipFill"]?.[0];if(!r)continue;let o=r["a:blip"]?.[0];if(!o)continue;let s=o.$?.["r:embed"];s&&t.push(s)}}catch(e){console.error("Erro ao extrair refer\xeancias de v\xeddeo:",e)}return t}static async extractVideoData(e,r,t){try{let s=`ppt/slides/_rels/slide${t}.xml.rels`,i=await e.file(s)?.async("text");if(!i)return null;let a=await (0,o.parseStringPromise)(i),n=(a.Relationships?.Relationship||[]).find(e=>e.$?.Id===r);if(!n)return null;let l=n.$?.Target;if(!l)return null;let c=`ppt/${l.replace("../","")}`,d=e.file(c);if(!d)return null;let m=await d.async("uint8array"),p=await d.async("base64"),u=c.split("/").pop()||"video",f=this.detectVideoFormat(u,m);return{id:this.generateVideoId(c),filename:u,format:f,src:`data:video/${f};base64,${p}`,size:m.length,width:1920,height:1080}}catch(e){return console.error("Erro ao extrair dados do v\xeddeo:",e),null}}static detectVideoFormat(e,r){let t=e.split(".").pop()?.toLowerCase(),o={mp4:"mp4",webm:"webm",avi:"avi",mov:"mov",wmv:"wmv",mkv:"mkv",m4v:"mp4"};if(t&&o[t])return o[t];if(r.length<12)return"mp4";let s=Array.from(r.slice(0,12));return 102===s[4]&&116===s[5]&&121===s[6]&&112===s[7]?"mp4":26===s[0]&&69===s[1]&&223===s[2]&&163===s[3]?"webm":82===s[0]&&73===s[1]&&70===s[2]&&70===s[3]?"avi":"mp4"}static isVideoFile(e){return[".mp4",".webm",".avi",".mov",".wmv",".mkv",".m4v",".flv",".mpg",".mpeg"].some(r=>e.toLowerCase().endsWith(r))}static generateVideoId(e){return`video-${e.replace(/[^a-zA-Z0-9]/g,"-")}-${Date.now()}`}static async convertToWebFormat(e){return"mp4"===e.format||"webm"===e.format?(console.log(`âœ… V\xeddeo j\xe1 em formato web: ${e.format}`),e):(console.log(`ðŸ”„ V\xeddeo em formato ${e.format} - convers\xe3o necess\xe1ria`),console.warn(`ðŸ’¡ NOTA: Convers\xe3o de ${e.format} para MP4 requer FFmpeg. Marcando para convers\xe3o server-side.`),{...e,format:"mp4",customProperties:{...e.customProperties,needsConversion:!0,originalFormat:e.format,conversionNote:"Aguardando implementa\xe7\xe3o FFmpeg server-side"}})}}}};